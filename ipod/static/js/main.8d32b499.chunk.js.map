{"version":3,"sources":["components/previews/index.tsx","components/icons/SadMacIcon.tsx","utils/constants/Screen.ts","utils/constants/Unit.ts","components/ErrorScreen/index.tsx","utils/conversion.ts","hooks/audio/useAudioPlayer.tsx","hooks/audio/useVolumeHandler.ts","hooks/musicKit/useMusicKit.tsx","hooks/musicKit/useMKEventListener.ts","hooks/musicKit/useMKDataFetcher.ts","hooks/utils/useEventListener.ts","hooks/navigation/useMenuHideWindow.ts","components/views/AboutView/index.tsx","animation/index.tsx","utils/index.ts","components/views/CoverFlowView/BacksideContent.tsx","components/views/CoverFlowView/AlbumCover.tsx","components/views/CoverFlowView/CoverFlow.tsx","components/views/CoverFlowView/index.tsx","components/previews/GamesPreview.tsx","components/previews/MusicPreview.tsx","components/previews/NowPlayingPreview.tsx","components/previews/ServicePreview.tsx","components/previews/SettingsPreview.tsx","components/previews/ThemePreview.tsx","components/views/HomeView/index.tsx","components/views/MusicView/index.tsx","components/views/ArtistsView/index.tsx","components/views/ArtistView/index.tsx","components/views/AlbumsView/index.tsx","components/views/AlbumView/index.tsx","components/views/NowPlayingView/index.tsx","components/views/PlaylistsView/index.tsx","components/views/PlaylistView/index.tsx","components/views/GamesView/index.tsx","components/views/BrickGameView/Game.js","components/views/index.ts","components/views/BrickGameView/index.tsx","components/views/SettingsView/index.tsx","components/ScrollWheel/index.tsx","hooks/navigation/useScrollHandler.tsx","providers/WindowProvider.tsx","hooks/navigation/useWindowContext.ts","utils/spotify.ts","hooks/spotify/useSpotifySDK.tsx","hooks/spotify/useSpotifyDataFetcher.ts","hooks/utils/useSettings.tsx","hooks/utils/useDataFetcher.ts","hooks/utils/useEffectOnce.ts","hooks/utils/useInterval.ts","hooks/utils/useTimeout.ts","components/SelectableList/SelectableListItem.tsx","components/SelectableList/index.tsx","components/AuthPrompt/index.tsx","hooks/battery/useBattery.ts","components/BatteryIndicator/index.tsx","components/Controls/ProgressBar.tsx","components/Controls/Scrubber.tsx","components/LoadingIndicator.tsx","components/Controls/TrackProgress.tsx","components/Controls/VolumeBar.tsx","components/Controls/index.tsx","components/Header/index.tsx","components/KenBurns/index.tsx","components/LoadingScreen/index.tsx","components/NowPlaying/index.tsx","components/ScrollWheel/Styled/index.ts","components/ScrollWheel/icons/MenuIcon.tsx","components/ScrollWheel/icons/RewindIcon.tsx","components/ScrollWheel/icons/PlayPauseIcon.tsx","components/ScrollWheel/icons/FastForwardIcon.tsx","utils/constants/Theme.ts","utils/themes.ts","components/ScrollWheel/Knob.tsx","utils/events.ts","components/WindowManager/components/ActionSheet.tsx","components/WindowManager/ActionSheetWindowManager/index.tsx","components/WindowManager/CoverFlowWindowManager/index.tsx","components/WindowManager/components/Popup.tsx","components/WindowManager/components/Window.tsx","components/WindowManager/FullScreenWindowManager/index.tsx","components/WindowManager/PopupWindowManager/index.tsx","components/WindowManager/SplitScreenWindowManager/PreviewPanel.tsx","components/WindowManager/SplitScreenWindowManager/index.tsx","components/WindowManager/index.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["PREVIEW","SadMacIcon","width","height","viewBox","fill","xmlns","d","stroke","strokeWidth","fillRule","clipRule","x","y","filter","id","filterUnits","colorInterpolationFilters","floodOpacity","result","in","type","values","stdDeviation","mode","in2","Screen","XS","MediaQuery","Size","Min","Max","ContainerMaxWidth","SM","MD","LG","XL","Unit","XXXL","XXL","XXS","RootContainer","styled","div","Text","p","strings","ErrorScreen","message","showImage","getAppleArtwork","size","url","replace","convertAppleSong","data","name","attributes","href","artwork","albumName","artistName","duration","durationInMillis","trackNumber","convertApplePlaylist","curatorName","description","standard","songs","relationships","tracks","map","convertSpotifyPlaylistSimplified","owner","display_name","uri","images","decode","convertSpotifyPlaylistFull","items","item","album","artists","join","duration_ms","track_number","convertSpotifySongFull","track","convertAppleAlbum","artworkSize","convertSpotifyAlbumSimplified","artist","convertSpotifyAlbumFull","convertSpotifySongSimplified","convertAppleArtist","albums","convertSpotifyArtistFull","convertAppleMediaItem","mediaItem","artworkURL","playbackDuration","title","convertSpotifyMediaItem","state","track_window","current_track","defaultPlatbackInfoState","isPlaying","isPaused","isLoading","currentTime","timeRemaining","percent","AudioPlayerContext","createContext","AudioPlayerProvider","children","useSettings","service","isSpotifyAuthorized","isAppleAuthorized","useSpotifySDK","spotifyPlayer","accessToken","deviceId","music","useMusicKit","useState","volume","setVolume","nowPlayingItem","setNowPlayingItem","playbackInfo","setPlaybackInfo","playAppleMusic","useCallback","queueOptions","a","Error","playlistSongs","playlist","queue","Object","fromEntries","entries","song","startPosition","undefined","setQueue","play","playSpotify","uris","prevState","fetch","method","body","JSON","stringify","offset","position","headers","Authorization","pause","togglePlayPause","togglePlay","skipNext","skipToNextItem","nextTrack","skipPrevious","skipToPreviousItem","previousTrack","updateNowPlayingItem","ConversionUtils","getCurrentState","handleApplePlaybackStateChange","MusicKit","PlaybackStates","playing","paused","loading","waiting","stalled","handleSpotifyPlaybackStateChange","disallows","resuming","updatePlaybackInfo","currentPlaybackTime","currentPlaybackTimeRemaining","currentPlaybackProgress","currentPlaybackDuration","maxTime","Math","round","seekToTime","time","player","seek","handleChangeVolume","newVolume","localStorage","setItem","VOLUME_KEY","useEventListener","useMKEventListener","useEffect","addListener","savedVolume","parseFloat","getItem","removeListener","Provider","value","useAudioPlayer","useContext","useVolumeHandler","active","setActive","enabled","setIsEnabled","timeoutIdRef","useRef","useEffectOnce","current","clearTimeout","setEnabled","val","setActiveState","setTimeout","increaseVolume","min","decreaseVolume","max","DEVELOPER_TOKEN","MusicKitContext","musicKit","window","setIsAppleAuthorized","setService","isConfigured","hasDevToken","useMemo","getInstance","signIn","isAuthorized","authorize","signOut","unauthorize","MusicKitProvider","setHasDevToken","setIsConfigured","setStreamingService","handleConfigure","configure","developerToken","app","build","e","userToken","event","callback","errors","length","addEventListener","removeEventListener","useMKDataFetcher","fetchAppleMusicApi","endpoint","inLibrary","params","baseUrl","paramsString","queryString","api","response","fetchAlbums","limit","fetchAlbum","fetchArtists","fetchArtistAlbums","fetchPlaylists","fetchPlaylist","playlistId","include","eventName","handler","element","savedHandler","eventListener","useMenuHideWindow","useWindowContext","windowStack","hideWindow","handleClick","Container","Image","img","TitleContainer","Title","h3","Description","ListContainer","AboutView","ViewOptions","about","options","label","useScrollHandler","scrollIndex","alt","src","aria-label","role","activeIndex","slideRightAnimation","variants","closed","open","transition","closing","initial","animate","exit","slideUpAnimation","popInAnimation","scale","opacity","fade","fadeScale","previewSlideRight","noAnimation","getArtwork","formatTime","seconds","guide","s","floor","m","h","gm","gh","isNaN","Infinity","getMediaOptions","onSelect","playNext","playLater","InfoContainer","Subtext","BacksideContent","albumId","setPlayingAlbum","useDataFetcher","index","coverFlow","attrs","props","style","background","backgroundSize","abs","isHidden","isActive","css","midpoint","isSelected","Artwork","Backside","motion","AlbumCover","playingAlbum","isVisible","getOffsetPx","Utils","AnimatePresence","AlbumsContainer","NowPlayingContainer","CoverFlow","setActiveIndex","setMidpoint","containerRef","selectedAlbum","setSelectedAlbum","selectAlbum","handleMenuClick","forwardScroll","backwardScroll","updateMidpoint","getBoundingClientRect","ref","hideArtwork","onHide","CoverFlowView","backgroundColor","GamesPreview","MusicPreview","hasError","artworkUrls","urls","NowPlayingPreview","spotify","apple","none","selected","ServicePreview","imgUrl","text","SettingsPreview","ThemePreview","Previews","MUSIC","GAMES","SETTINGS","NOW_PLAYING","SERVICE","THEME","HomeView","signInWithApple","signInWithSpotify","showWindow","viewId","component","preview","games","settings","getConditionalOption","signinPopup","listOptions","nowPlaying","home","handleIdleState","activeView","WINDOW_TYPE","FULL","NowPlayingView","MusicView","arr","playlists","isPlayable","push","ArtistsView","emptyMessage","ArtistView","sublabel","imageUrl","longPressOptions","AlbumsView","AlbumView","showNowPlayingView","PlaylistsView","PlaylistView","GamesView","brickGame","BrickGameView","init","this","canvas","document","querySelector","context","getContext","handleCenterClick","inStasis","initialized","moveRight","moveLeft","setupBricks","draw","drawBricks","ball","update","console","log","enterStasis","clearContext","requestAnimationFrame","clearRect","die","lives","reset","bricks","forEach","brick","i","Brick","health","timeout","score","physics","speed","fillStyle","fillRect","resetPosition","direction","centerX","centerY","beginPath","arc","PI","lineWidth","strokeStyle","checkCollisionWithPlayer","checkCollisionWithBricks","splice","prototype","Canvas","BrickGame","Game","SettingsView","deviceTheme","setDeviceTheme","signOutApple","signOutSpotify","serviceTypeActionSheet","deviceThemeActionSheet","signOutPopup","WHEEL_QUADRANT","SPLIT","COVER_FLOW","mediaActionSheet","ACTION_SHEET","spotifyNotSupportedPopup","POPUP","getInitIndex","selectedOption","selectedOptionIndex","findIndex","option","setPreview","setIndex","handleCheckForPreview","handleForwardScroll","handleBackwardScroll","handleShowView","windowType","handleShowPopup","popupId","handleShowActionSheet","handleCenterLongClick","WindowContext","headerTitle","WindowProvider","Views","windowState","setWindowState","prevWindowState","newWindowStack","slice","resetWindows","isWindowActive","setHeaderTitle","ACCESS_TOKEN_KEY","REFRESH_TOKEN_KEY","TOKEN_TIMESTAMP_KEY","getTokens","getExistingTokens","storedAccessToken","storedRefreshToken","_getNewTokens","_shouldRefreshTokens","_getRefreshedTokens","refreshToken","API_URL","credentials","json","access_token","_saveTokens","error","URL","urlParams","searchParams","code","get","delete","history","replaceState","toString","isNew","lastRefreshTimestamp","parseInt","now","Date","minuteDiff","SpotifySDKContext","setIsSpotifyAuthorized","isMounted","location","origin","includes","disconnect","removeItem","SpotifySDKProvider","token","setToken","setDeviceId","spotifyPlayerRef","setIsMounted","handleMount","SpotifyUtils","Spotify","Player","getOAuthToken","cb","device_id","connect","onSpotifyWebPlaybackSDKReady","fetchSpotifyApi","onError","res","useSpotifyDataFetcher","fetchArtist","userId","SELECTED_SERVICE_KEY","DEVICE_COLOR_KEY","SettingsContext","setState","SettingsProvider","memo","settingsState","setSettingsState","spotifyDataFetcher","appleDataFetcher","setIsLoading","setHasError","setData","effect","useInterval","delay","savedCallback","setInterval","clearInterval","useTimeout","cancel","timeoutId","LabelContainer","Label","Sublabel","Icon","SelectableListItem","condition","SelectableList","scrollIntoView","block","StyledImg","defaultMessage","AuthPrompt","icon","setIcon","noop","useBattery","chargePercent","setChargePercent","isCharging","setIsCharging","detachListeners","navigator","getBattery","batteryManager","onLevelChange","level","onChargingChange","charging","attachListeners","ChargeLevelContainer","ChargeLevel","BatteryCap","IconContainer","StatusIcon","BoltIcon","PlugIcon","BatteryIndicator","className","clampedChargePercent","shouldShowPlugIcon","shouldShowBoltIcon","ProgressContainer","Gloss","Progress","transparent","Diamond","ProgressBar","isScrubber","textAlign","Scrubber","isScrubbing","scrubberTime","setScrubberTime","scrubberPercent","scrubberTimeRemaining","setIsActive","handleSeek","useDebouncedCallback","newTime","scrubForward","scrubBackward","refresh","force","Svg","svg","LoadingIndicator","version","strokeLinecap","x1","y1","x2","y2","attributeName","attributeType","keyTimes","dur","begin","repeatCount","calcMode","TrackProgress","VolumeBar","MainContainer","ScrubberContainer","Controls","setIsScrubbing","hidden","StyledBatteryIndicator","Header","zIndex","startedAnimation","KenBurns","stack","setStack","transitioning","setTransitioning","cycleImage","newStack","path","LoadingScreen","MetadataContainer","ArtworkContainer","ControlsContainer","NowPlaying","handlePlaybackChange","completed","WheelButton","margin","top","bottom","left","right","MenuIcon","color","RewindIcon","transform","PlayPauseIcon","FastForwardIcon","Silver","knob","outline","button","centerButton","boxShadow","Black","U2","getTheme","Theme","CanvasContainer","CenterButton","ANGLE_ARC","ANGLE_OFFSET","START_ANGLE","END_ANGLE","Knob","onChange","onChangeEnd","onWheelClick","onClick","onLongPress","onMenuLongPress","step","thickness","bgColor","fgColor","canvasClassName","canvasRef","centerButtonRef","handleLongPress","preventDefault","target","setAttribute","getTime","handleWheelLongPress","rect","detail","clientX","clientY","rectWidth","findClickQuadrant","handleMenuLongPress","eventToValue","bounds","atan2","v","coerceToStep","handleMouseDown","handleMouseMove","handleMouseUpNoMove","handleTouchStart","handleTouchMove","handleTouchEndNoMove","handleMouseUp","touchEvent","touchIndex","targetTouches","handleTouchEnd","rectSize","mouseEvent","quadrant","touch","changedTouches","pageX","pageY","drawCanvas","ctx","devicePixelRatio","screen","deviceXDPI","logicalXDPI","webkitBackingStorePixelRatio","getCanvasScale","xy","radius","lineCap","startAngle","endAngle","acw","getArcToValue","isTouchEnabled","maxTouchPoints","msMaxTouchPoints","buttonColor","createIpodEvent","Event","centerClickEvent","centerLongClickEvent","forwardScrollEvent","backwardScrollEvent","wheelClickEvent","menuClickEvent","menuLongPressEvent","backClickEvent","forwardClickEvent","playPauseClickEvent","idleEvent","ScrollWheel","count","setCount","dispatchEvent","handleCenterLongPress","handleClockwiseScroll","handleCounterClockwiseScroll","handleResetIdleCheck","handleWheelClick","TOP","BOTTOM","LEFT","RIGHT","handleKeyPress","key","handleScroll","currentCount","ContentTransitionContainer","OptionText","OptionContainer","highlighted","ActionSheet","windowOptions","find","data-window-id","ActionSheetWindowManager","data-stack-type","CoverFlowWindowManager","WindowComponent","TitleText","DescriptionText","OptionsContainer","Popup","showHeader","Window","firstInStack","FullScreenWindowManager","PopupWindowManager","PreviewPanel","PreviewComponent","LeftPanel","SplitScreenWindowManager","menuHidden","allHidden","Mask","WindowManager","hasAppleDevToken","splitViewWindows","fullViewWindows","coverFlowWindow","actionSheetWindows","popupWindows","isReady","GlobalStyles","createGlobalStyle","Shell","ScreenContainer","Ipod","App","Boolean","hostname","match","ReactDOM","render","getElementById","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.8d32b499.chunk.js","sourcesContent":["import GamesPreview from './GamesPreview';\nimport MusicPreview from './MusicPreview';\nimport NowPlayingPreview from './NowPlayingPreview';\nimport ServicePreview from './ServicePreview';\nimport SettingsPreview from './SettingsPreview';\nimport ThemePreview from './ThemePreview';\n\nexport enum PREVIEW {\n  MUSIC = 'music',\n  GAMES = 'games',\n  SETTINGS = 'settings',\n  NOW_PLAYING = 'nowPlaying',\n  SERVICE = 'service',\n  THEME = 'theme',\n}\n\nexport const Previews = {\n  [PREVIEW.MUSIC]: () => <MusicPreview />,\n  [PREVIEW.GAMES]: () => <GamesPreview />,\n  [PREVIEW.SETTINGS]: () => <SettingsPreview />,\n  [PREVIEW.NOW_PLAYING]: () => <NowPlayingPreview />,\n  [PREVIEW.SERVICE]: () => <ServicePreview />,\n  [PREVIEW.THEME]: () => <ThemePreview />,\n};\n","const SadMacIcon = () => {\n  return (\n    <svg\n      width=\"95\"\n      height=\"124\"\n      viewBox=\"0 0 95 124\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path d=\"M4 2L92 2\" stroke=\"black\" strokeWidth=\"4\" />\n      <path d=\"M16 14L80 14\" stroke=\"black\" strokeWidth=\"4\" />\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M16 4H4V12V64V104H16H80H91V64V12V4H80H16ZM80 12H16V64H80V12Z\"\n        fill=\"#C4C4C4\"\n      />\n      <rect x=\"16\" y=\"16\" width=\"64\" height=\"48\" fill=\"#CBCCFE\" />\n      <path d=\"M93 104L93 3.99999\" stroke=\"black\" strokeWidth=\"4\" />\n      <path d=\"M2 104L2 4\" stroke=\"black\" strokeWidth=\"4\" />\n      <path d=\"M14 64L14 16\" stroke=\"black\" strokeWidth=\"4\" />\n      <path d=\"M82 64L82 16\" stroke=\"white\" strokeWidth=\"4\" />\n      <path d=\"M30 32V24\" stroke=\"black\" strokeWidth=\"4\" />\n      <path d=\"M66 32V24\" stroke=\"black\" strokeWidth=\"4\" />\n      <path d=\"M50 44L50 24\" stroke=\"black\" strokeWidth=\"4\" />\n      <path d=\"M49 42H44\" stroke=\"black\" strokeWidth=\"4\" />\n      <path d=\"M60 54H36\" stroke=\"black\" strokeWidth=\"4\" />\n      <path d=\"M64 58H60\" stroke=\"black\" strokeWidth=\"4\" />\n      <path d=\"M36 58H32\" stroke=\"black\" strokeWidth=\"4\" />\n      <path d=\"M80 86H48\" stroke=\"black\" strokeWidth=\"4\" />\n      <g filter=\"url(#filter0_d)\">\n        <path d=\"M20 94H12\" stroke=\"#18AB1C\" strokeWidth=\"4\" />\n      </g>\n      <g filter=\"url(#filter1_d)\">\n        <path d=\"M20 98H12\" stroke=\"#BF4131\" strokeWidth=\"4\" />\n      </g>\n      <path d=\"M80 90H48\" stroke=\"white\" strokeWidth=\"4\" />\n      <rect x=\"4\" y=\"104\" width=\"88\" height=\"20\" fill=\"black\" />\n      <rect x=\"8\" y=\"108\" width=\"44\" height=\"4\" fill=\"#575757\" />\n      <rect x=\"44\" y=\"108\" width=\"44\" height=\"4\" fill=\"#222222\" />\n      <rect x=\"64\" y=\"112\" width=\"24\" height=\"4\" fill=\"#222222\" />\n      <rect x=\"76\" y=\"116\" width=\"12\" height=\"4\" fill=\"#222222\" />\n      <rect x=\"8\" y=\"112\" width=\"32\" height=\"4\" fill=\"#575757\" />\n      <rect x=\"8\" y=\"116\" width=\"44\" height=\"4\" fill=\"#575757\" />\n      <rect x=\"40\" y=\"112\" width=\"24\" height=\"4\" fill=\"#444444\" />\n      <path d=\"M16 66L80 66\" stroke=\"white\" strokeWidth=\"4\" />\n      <defs>\n        <filter\n          id=\"filter0_d\"\n          x=\"4\"\n          y=\"84\"\n          width=\"24\"\n          height=\"20\"\n          filterUnits=\"userSpaceOnUse\"\n          colorInterpolationFilters=\"sRGB\"\n        >\n          <feFlood floodOpacity=\"0\" result=\"BackgroundImageFix\" />\n          <feColorMatrix\n            in=\"SourceAlpha\"\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n          />\n          <feOffset />\n          <feGaussianBlur stdDeviation=\"4\" />\n          <feColorMatrix\n            type=\"matrix\"\n            values=\"0 0 0 0 0.690196 0 0 0 0 0.952941 0 0 0 0 0.658824 0 0 0 1 0\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in2=\"BackgroundImageFix\"\n            result=\"effect1_dropShadow\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in=\"SourceGraphic\"\n            in2=\"effect1_dropShadow\"\n            result=\"shape\"\n          />\n        </filter>\n        <filter\n          id=\"filter1_d\"\n          x=\"4\"\n          y=\"88\"\n          width=\"24\"\n          height=\"20\"\n          filterUnits=\"userSpaceOnUse\"\n          colorInterpolationFilters=\"sRGB\"\n        >\n          <feFlood floodOpacity=\"0\" result=\"BackgroundImageFix\" />\n          <feColorMatrix\n            in=\"SourceAlpha\"\n            type=\"matrix\"\n            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n          />\n          <feOffset />\n          <feGaussianBlur stdDeviation=\"4\" />\n          <feColorMatrix\n            type=\"matrix\"\n            values=\"0 0 0 0 0.964706 0 0 0 0 0.745098 0 0 0 0 0.72549 0 0 0 1 0\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in2=\"BackgroundImageFix\"\n            result=\"effect1_dropShadow\"\n          />\n          <feBlend\n            mode=\"normal\"\n            in=\"SourceGraphic\"\n            in2=\"effect1_dropShadow\"\n            result=\"shape\"\n          />\n        </filter>\n      </defs>\n    </svg>\n  );\n};\n\nexport default SadMacIcon;\n","const XS = {\n  MediaQuery: '@media (min-width: 0)',\n  Size: {\n    Min: 0,\n    Max: 575,\n  },\n  ContainerMaxWidth: '100%',\n};\n\nconst SM = {\n  MediaQuery: '@media (min-width: 576px)',\n  Size: {\n    Min: 576,\n    Max: 767,\n  },\n  ContainerMaxWidth: '540px',\n};\n\nconst MD = {\n  MediaQuery: '@media (min-width: 768px)',\n  Size: {\n    Min: 768,\n    Max: 991,\n  },\n  ContainerMaxWidth: '720px',\n};\n\nconst LG = {\n  MediaQuery: '@media (min-width: 992px)',\n  Size: {\n    Min: 992,\n    Max: 1199,\n  },\n  ContainerMaxWidth: '960px',\n};\n\nconst XL = {\n  MediaQuery: '@media (min-width: 1200px)',\n  Size: {\n    Min: 1200,\n    Max: null,\n  },\n  ContainerMaxWidth: '1140px',\n};\n\nconst Screen = {\n  XS,\n  SM,\n  MD,\n  LG,\n  XL,\n};\n\nexport default Screen;\n","const XXXL = '8rem'; // 128px\nconst XXL = '4rem'; // 64px\nconst XL = '2rem'; // 32px\nconst LG = '1.5rem'; // 24px\nconst MD = '1rem'; // 16px\nconst SM = '0.75rem'; // 12px\nconst XS = '0.5rem'; // 8px\nconst XXS = '0.25rem'; // 4px\n\nconst Unit = {\n  XXXL,\n  XXL,\n  XL,\n  LG,\n  MD,\n  SM,\n  XS,\n  XXS,\n};\n\nexport default Unit;\n","import { SadMacIcon } from 'components/icons';\nimport styled from 'styled-components';\nimport { Unit } from 'utils/constants';\n\nconst RootContainer = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  text-align: center;\n  height: 100%;\n`;\n\nconst Text = styled.p`\n  margin-top: ${Unit.MD};\n  font-size: 14px;\n  max-width: 180px;\n  color: rgb(100, 100, 100);\n`;\n\nconst strings = {\n  defaultMessage: 'Something went wrong',\n};\n\ninterface Props {\n  message?: string;\n  showImage?: React.ReactNode;\n}\n\nconst ErrorScreen = ({ message, showImage = true }: Props) => {\n  return (\n    <RootContainer>\n      <div>\n        {showImage && <SadMacIcon />}\n        <Text>{message ?? strings.defaultMessage}</Text>\n      </div>\n    </RootContainer>\n  );\n};\n\nexport default ErrorScreen;\n","import { decode } from 'he';\n\n// Artwork Conversion\n\n/** Accepts a url with '{w}' and '{h}' and replaces them with the specified size */\nexport const getAppleArtwork = (size: number | string, url?: string) => {\n  if (!url) {\n    return undefined;\n  }\n\n  return url.replace('{w}', `${size}`).replace('{h}', `${size}`);\n};\n\nexport const convertAppleSong = (data: AppleMusicApi.Song): IpodApi.Song => ({\n  id: data.id,\n  name: data.attributes?.name ?? 'Unknown name',\n  url: data.href ?? '',\n  artwork: { url: getAppleArtwork(100, data.attributes?.artwork?.url) ?? '' },\n  albumName: data.attributes?.albumName,\n  artistName: data.attributes?.artistName,\n  duration: data.attributes?.durationInMillis ?? 0,\n  trackNumber: data.attributes?.trackNumber ?? 0,\n});\n\nexport const convertSpotifySongSimplified = (\n  data: SpotifyApi.TrackObjectSimplified\n): IpodApi.Song => ({\n  id: data.id,\n  name: data.name,\n  url: data.uri,\n  artistName: data.artists.map(({ name }) => name).join(', '),\n  duration: data.duration_ms,\n  trackNumber: data.track_number,\n});\n\nexport const convertSpotifySongFull = (\n  data: SpotifyApi.TrackObjectFull\n): IpodApi.Song => ({\n  id: data.id,\n  name: data.name,\n  url: data.uri,\n  artwork: { url: data.album.images[0]?.url ?? '' },\n  albumName: data.album.name,\n  artistName: data.artists.map(({ name }) => name).join(', '),\n  duration: data.duration_ms,\n  trackNumber: data.track_number,\n});\n\n// Playlist Conversion\n\nexport const convertApplePlaylist = (\n  data: AppleMusicApi.Playlist\n): IpodApi.Playlist => ({\n  id: data.id,\n  name: data.attributes?.name ?? '–',\n  url: data.href ?? '',\n  curatorName: data.attributes?.curatorName ?? '',\n  artwork: {\n    url: getAppleArtwork(100, data.attributes?.artwork?.url) ?? '',\n  },\n  description: data.attributes?.description?.standard,\n  songs: data.relationships?.tracks?.data.map(convertAppleSong) ?? [],\n});\n\nexport const convertSpotifyPlaylistSimplified = (\n  data: SpotifyApi.PlaylistObjectSimplified\n): IpodApi.Playlist => ({\n  id: data.id,\n  name: data.name,\n  curatorName: data.owner.display_name ?? '',\n  url: data.uri,\n  artwork: { url: data.images[0]?.url ?? '' },\n  description: data.description ? decode(data.description) : '',\n  songs: [],\n});\n\nexport const convertSpotifyPlaylistFull = (\n  data: SpotifyApi.PlaylistObjectFull\n): IpodApi.Playlist => ({\n  id: data.uri,\n  name: data.name,\n  curatorName: data.owner.display_name ?? '',\n  url: data.uri,\n  artwork: { url: data.images[0]?.url ?? '' },\n  description: data.description ?? '',\n  songs: data.tracks.items.map((item) => convertSpotifySongFull(item.track)),\n});\n\nexport const convertAppleAlbum = (\n  data: AppleMusicApi.Album,\n  artworkSize?: number\n): IpodApi.Album => ({\n  id: data.id,\n  name: data.attributes?.name ?? '–',\n  artistName: data.attributes?.artistName,\n  url: data.href ?? '',\n  artwork: {\n    url:\n      getAppleArtwork(artworkSize ?? 100, data.attributes?.artwork?.url) ?? '',\n  },\n  songs: data.relationships?.tracks.data.map(convertAppleSong) ?? [],\n});\n\nexport const convertSpotifyAlbumSimplified = (\n  data: SpotifyApi.AlbumObjectSimplified\n): IpodApi.Album => ({\n  id: data.id,\n  name: data.name,\n  artistName: data.artists.map((artist) => artist.name).join(', '),\n  url: data.uri,\n  artwork: { url: data.images[0]?.url ?? '' },\n  songs: [],\n});\n\nexport const convertSpotifyAlbumFull = (\n  data: SpotifyApi.AlbumObjectFull\n): IpodApi.Album => ({\n  id: data.id,\n  name: data.name,\n  artistName: data.artists.map((artist) => artist.name).join(', '),\n  url: data.uri,\n  artwork: { url: data.images[0]?.url ?? '' },\n  songs: data.tracks.items.map((item) => convertSpotifySongSimplified(item)),\n});\n\nexport const convertAppleArtist = (\n  data: AppleMusicApi.Artist\n): IpodApi.Artist => ({\n  id: data.id,\n  name: data.attributes?.name ?? '–',\n  url: data.attributes?.url ?? '',\n  albums: data.relationships?.albums?.data.map(convertAppleAlbum) ?? [],\n});\n\nexport const convertSpotifyArtistSimplified = (\n  data: SpotifyApi.ArtistObjectSimplified\n): IpodApi.Artist => ({\n  id: data.id,\n  name: data.name,\n  url: data.uri,\n  artwork: undefined,\n});\n\nexport const convertSpotifyArtistFull = (\n  data: SpotifyApi.ArtistObjectFull\n): IpodApi.Artist => ({\n  id: data.id,\n  name: data.name,\n  url: data.uri,\n  artwork: {\n    url: data.images[0]?.url,\n  },\n});\n\nexport const convertAppleMediaItem = (\n  mediaItem: MusicKit.MediaItem\n): IpodApi.MediaItem => ({\n  albumName: mediaItem.albumName,\n  artistName: mediaItem.artistName,\n  artwork: {\n    url: getAppleArtwork(100, mediaItem.artworkURL) ?? '',\n  },\n  duration: mediaItem.playbackDuration,\n  id: mediaItem.id,\n  name: mediaItem.title,\n  trackNumber: mediaItem.trackNumber,\n  url: '',\n});\n\nexport const convertSpotifyMediaItem = (\n  state: Spotify.PlaybackState\n): IpodApi.MediaItem => {\n  const track = state.track_window.current_track;\n\n  return {\n    albumName: track.album.name,\n    artistName: track.artists.map(({ name }) => name).join(', '),\n    artwork: {\n      url: track.album.images[0]?.url ?? '',\n    },\n    duration: state.duration,\n    id: track.id ?? '',\n    name: track.name,\n    trackNumber: 0,\n    url: track.uri,\n  };\n};\n","import {\n  createContext,\n  useCallback,\n  useContext,\n  useEffect,\n  useState,\n} from 'react';\n\nimport { useEventListener, useMKEventListener } from 'hooks';\nimport * as ConversionUtils from 'utils/conversion';\nimport { IpodEvent } from 'utils/events';\n\nimport { useMusicKit, useSettings, useSpotifySDK, VOLUME_KEY } from '../';\n\nconst defaultPlatbackInfoState = {\n  isPlaying: false,\n  isPaused: false,\n  isLoading: false,\n  currentTime: 0,\n  timeRemaining: 0,\n  percent: 0,\n  duration: 0,\n};\n\ninterface AudioPlayerState {\n  playbackInfo: typeof defaultPlatbackInfoState;\n  nowPlayingItem?: IpodApi.MediaItem;\n  volume: number;\n  play: (queueOptions: IpodApi.QueueOptions) => Promise<void>;\n  pause: () => Promise<void>;\n  seekToTime: (time: number) => void;\n  setVolume: (volume: number) => void;\n  updateNowPlayingItem: () => void;\n  updatePlaybackInfo: () => void;\n}\n\nexport const AudioPlayerContext = createContext<AudioPlayerState>({} as any);\n\ntype AudioPlayerHook = AudioPlayerState;\n\nexport const useAudioPlayer = (): AudioPlayerHook => {\n  const state = useContext(AudioPlayerContext);\n\n  return {\n    ...state,\n  };\n};\n\ninterface Props {\n  children: React.ReactNode;\n}\n\nexport const AudioPlayerProvider = ({ children }: Props) => {\n  const { service, isSpotifyAuthorized, isAppleAuthorized } = useSettings();\n  const { spotifyPlayer, accessToken, deviceId } = useSpotifySDK();\n  const { music } = useMusicKit();\n  const [volume, setVolume] = useState(0.5);\n  const [nowPlayingItem, setNowPlayingItem] = useState<IpodApi.MediaItem>();\n  const [playbackInfo, setPlaybackInfo] = useState(defaultPlatbackInfoState);\n\n  const playAppleMusic = useCallback(\n    async (queueOptions: IpodApi.QueueOptions) => {\n      if (!isAppleAuthorized) {\n        throw new Error('Unable to play: Not authorized');\n      }\n\n      /**\n       * MusicKit JS V3 doesn't seem to support passing in a single playlist id to the queue.\n       * A workaround is to just grab the song ids instead.\n       * */\n      const playlistSongs = queueOptions.playlist?.songs?.map(({ id }) => id);\n\n      /**\n       * MusicKit JS V3 expects only a single media type with no empty keys.\n       * We're filtering out any keys that are undefined.\n       *\n       * @example { album: 'a.12345', startPosition: 0 }\n       */\n      const queue = Object.fromEntries(\n        Object.entries({\n          album: queueOptions.album?.id,\n          songs: playlistSongs ?? queueOptions.songs?.map((song) => song.url),\n          song: queueOptions.song?.id,\n          startPosition: queueOptions.startPosition,\n        }).filter(([_, value]) => value !== undefined)\n      );\n\n      await music.setQueue({ ...queue });\n\n      await music.play();\n    },\n    [isAppleAuthorized, music]\n  );\n\n  const playSpotify = useCallback(\n    async (queueOptions: IpodApi.QueueOptions) => {\n      if (!isSpotifyAuthorized) {\n        throw new Error('Unable to play: Not authorized');\n      }\n\n      // Spotify only accepts a list of song URIs, so we'll look through each media type provided for songs.\n      const uris = [\n        ...(queueOptions.album?.songs?.map((song) => song.url) ?? []),\n        ...(queueOptions.playlist?.songs?.map((song) => song.url) ?? []),\n        ...(queueOptions.songs?.map((song) => song.url) ?? []),\n        queueOptions.song?.url,\n      ].filter((item) => !!item);\n\n      setPlaybackInfo((prevState) => ({\n        ...prevState,\n        isLoading: true,\n      }));\n\n      await fetch(\n        `https://api.spotify.com/v1/me/player/play?device_id=${deviceId}`,\n        {\n          method: 'PUT',\n          body: JSON.stringify({\n            uris,\n            offset: { position: queueOptions.startPosition },\n          }),\n          headers: {\n            'Content-Type': 'application/json',\n            Authorization: `Bearer ${accessToken}`,\n          },\n        }\n      );\n\n      setPlaybackInfo((prevState) => ({\n        ...prevState,\n        isLoading: false,\n      }));\n    },\n    [accessToken, deviceId, isSpotifyAuthorized]\n  );\n\n  const play = useCallback(\n    async (queueOptions: IpodApi.QueueOptions) => {\n      switch (service) {\n        case 'apple':\n          return playAppleMusic(queueOptions);\n        case 'spotify':\n          return playSpotify(queueOptions);\n        default:\n          throw new Error('Unable to play: service not specified');\n      }\n    },\n    [playAppleMusic, playSpotify, service]\n  );\n\n  const pause = useCallback(async () => {\n    switch (service) {\n      case 'apple':\n        return spotifyPlayer.pause();\n      case 'spotify':\n        return music.pause();\n      default:\n        throw new Error('Unable to play: service not specified');\n    }\n  }, [music, service, spotifyPlayer]);\n\n  const togglePlayPause = useCallback(async () => {\n    if (!nowPlayingItem) {\n      return;\n    }\n\n    switch (service) {\n      case 'apple':\n        // TODO: Update types for MusicKit V3\n        if ((music as any).isPlaying) {\n          music.pause();\n          // TODO: Update types for MusicKit V3\n        } else if (!(music as any).isPlaying) {\n          music.play();\n        }\n        break;\n      case 'spotify':\n        spotifyPlayer.togglePlay();\n        break;\n      default:\n        throw new Error('Unable to play: service not specified');\n    }\n  }, [music, nowPlayingItem, service, spotifyPlayer]);\n\n  const skipNext = useCallback(async () => {\n    if (!nowPlayingItem) {\n      return;\n    }\n\n    setPlaybackInfo((prevState) => ({\n      ...prevState,\n      isLoading: true,\n    }));\n\n    switch (service) {\n      case 'apple':\n        // TODO: Update types for MusicKit V3\n        if ((music as any).nowPlayingItem) {\n          await music.skipToNextItem();\n        }\n        break;\n      case 'spotify':\n        await spotifyPlayer.nextTrack();\n        break;\n      default:\n        throw new Error('Unable to play: service not specified');\n    }\n\n    setPlaybackInfo((prevState) => ({\n      ...prevState,\n      isLoading: false,\n    }));\n  }, [music, nowPlayingItem, service, spotifyPlayer]);\n\n  const skipPrevious = useCallback(async () => {\n    if (!nowPlayingItem) {\n      return;\n    }\n\n    setPlaybackInfo((prevState) => ({\n      ...prevState,\n      isLoading: true,\n    }));\n\n    switch (service) {\n      case 'apple':\n        // TODO: Update types for MusicKit V3\n        if ((music as any).nowPlayingItem) {\n          await music.skipToPreviousItem();\n        }\n        break;\n      case 'spotify':\n        await spotifyPlayer.previousTrack();\n        break;\n      default:\n        throw new Error('Unable to play: service not specified');\n    }\n\n    setPlaybackInfo((prevState) => ({\n      ...prevState,\n      isLoading: false,\n    }));\n  }, [music, nowPlayingItem, service, spotifyPlayer]);\n\n  const updateNowPlayingItem = useCallback(async () => {\n    let mediaItem: IpodApi.MediaItem | undefined;\n\n    // TODO: Update types for MusicKit V3\n    if (service === 'apple' && (music as any).nowPlayingItem) {\n      // TODO: Update types for MusicKit V3\n      mediaItem = ConversionUtils.convertAppleMediaItem(\n        (music as any).nowPlayingItem\n      );\n    } else if (service === 'spotify') {\n      const state = await spotifyPlayer.getCurrentState();\n\n      if (state) {\n        mediaItem = ConversionUtils.convertSpotifyMediaItem(state);\n      }\n    }\n\n    setNowPlayingItem(mediaItem);\n  }, [music, service, spotifyPlayer]);\n\n  const handleApplePlaybackStateChange = useCallback(\n    ({ state }: { state: MusicKit.PlaybackStates }) => {\n      let isLoading = false;\n      let isPlaying = false;\n      let isPaused = false;\n\n      switch (state) {\n        case MusicKit.PlaybackStates.playing:\n          isPlaying = true;\n          break;\n        case MusicKit.PlaybackStates.paused:\n          isPaused = true;\n          break;\n        case MusicKit.PlaybackStates.loading:\n        case MusicKit.PlaybackStates.waiting:\n        case MusicKit.PlaybackStates.stalled:\n          isLoading = true;\n          break;\n      }\n\n      setPlaybackInfo((prevState) => ({\n        ...prevState,\n        isPlaying,\n        isPaused,\n        isLoading,\n      }));\n\n      updateNowPlayingItem();\n    },\n    [updateNowPlayingItem]\n  );\n\n  const handleSpotifyPlaybackStateChange = useCallback(\n    (state: Spotify.PlaybackState) => {\n      if (state.disallows.resuming) {\n        setPlaybackInfo((prevState) => ({\n          ...prevState,\n          isPlaying: true,\n          isPaused: false,\n          isLoading: false,\n        }));\n      } else if (state.paused) {\n        setPlaybackInfo((prevState) => ({\n          ...prevState,\n          isPlaying: false,\n          isPaused: true,\n          isLoading: false,\n        }));\n      }\n\n      updateNowPlayingItem();\n    },\n    [updateNowPlayingItem]\n  );\n\n  const updatePlaybackInfo = useCallback(async () => {\n    if (service === 'apple') {\n      setPlaybackInfo((prevState) => ({\n        ...prevState,\n        // TODO: Update types for MusicKit V3\n        currentTime: (music as any).currentPlaybackTime,\n        timeRemaining: (music as any).currentPlaybackTimeRemaining,\n        percent: (music as any).currentPlaybackProgress * 100,\n        duration: (music as any).currentPlaybackDuration,\n      }));\n    } else if (service === 'spotify') {\n      const { position, duration } =\n        (await spotifyPlayer.getCurrentState()) ?? {};\n      const currentTime = (position ?? 0) / 1000;\n      const maxTime = (duration ?? 0) / 1000;\n      const timeRemaining = maxTime - currentTime;\n      const percent = Math.round((currentTime / maxTime) * 100);\n\n      setPlaybackInfo((prevState) => ({\n        ...prevState,\n        currentTime,\n        timeRemaining,\n        percent,\n        duration: maxTime,\n      }));\n    }\n  }, [music, service, spotifyPlayer]);\n\n  const seekToTime = useCallback(\n    async (time: number) => {\n      if (service === 'apple') {\n        // TODO: Update types for MusicKit V3\n        await (music as any).player.seekToTime(time);\n      } else if (service === 'spotify') {\n        // Seek to time (in ms)\n        await spotifyPlayer.seek(time * 1000);\n      }\n\n      updatePlaybackInfo();\n    },\n    [music, service, spotifyPlayer, updatePlaybackInfo]\n  );\n\n  const handleChangeVolume = useCallback(\n    (newVolume: number) => {\n      if (isSpotifyAuthorized) {\n        spotifyPlayer.setVolume(newVolume);\n      }\n\n      if (isAppleAuthorized) {\n        // TODO: Update types for MusicKit V3\n        (music as any).volume = newVolume;\n      }\n\n      localStorage.setItem(VOLUME_KEY, `${newVolume}`);\n\n      setVolume(newVolume);\n    },\n    [isAppleAuthorized, isSpotifyAuthorized, music, spotifyPlayer]\n  );\n\n  useEventListener<IpodEvent>('playpauseclick', () => {\n    togglePlayPause();\n  });\n\n  useEventListener<IpodEvent>('forwardclick', () => {\n    skipNext();\n  });\n\n  useEventListener<IpodEvent>('backwardclick', () => {\n    skipPrevious();\n  });\n\n  // Apple playback event listeners\n  useMKEventListener('playbackStateDidChange', handleApplePlaybackStateChange);\n  useMKEventListener('queuePositionDidChange', updateNowPlayingItem);\n\n  useEffect(() => {\n    if (isSpotifyAuthorized) {\n      spotifyPlayer.addListener(\n        'player_state_changed',\n        handleSpotifyPlaybackStateChange\n      );\n\n      const savedVolume = parseFloat(localStorage.getItem(VOLUME_KEY) ?? '0.5');\n\n      handleChangeVolume(savedVolume);\n\n      return () =>\n        spotifyPlayer.removeListener(\n          'player_state_changed',\n          handleSpotifyPlaybackStateChange\n        );\n    }\n  }, [\n    handleChangeVolume,\n    handleSpotifyPlaybackStateChange,\n    isSpotifyAuthorized,\n    spotifyPlayer,\n  ]);\n\n  useEffect(() => {\n    if (isAppleAuthorized) {\n      const savedVolume = parseFloat(localStorage.getItem(VOLUME_KEY) ?? '0.5');\n      handleChangeVolume(savedVolume);\n    }\n  }, [handleChangeVolume, isAppleAuthorized]);\n\n  return (\n    <AudioPlayerContext.Provider\n      value={{\n        playbackInfo,\n        nowPlayingItem,\n        volume,\n        play,\n        pause,\n        seekToTime,\n        setVolume: handleChangeVolume,\n        updateNowPlayingItem,\n        updatePlaybackInfo,\n      }}\n    >\n      {children}\n    </AudioPlayerContext.Provider>\n  );\n};\n\nexport default useAudioPlayer;\n","import { useCallback, useRef, useState } from 'react';\nimport { IpodEvent } from 'utils/events';\n\nimport { useAudioPlayer, useEffectOnce, useEventListener } from '../';\n\ninterface VolumeHandlerHook {\n  volume: number;\n  active: boolean;\n  setEnabled: (val: boolean) => void;\n}\n\nconst useVolumeHandler = (): VolumeHandlerHook => {\n  const { volume, setVolume } = useAudioPlayer();\n  const [active, setActive] = useState(false);\n  const [enabled, setIsEnabled] = useState(true);\n  const timeoutIdRef = useRef<any>();\n\n  useEffectOnce(() => {\n    /** clear the timeout to prevent memory leaks. */\n    return () => {\n      if (timeoutIdRef.current) {\n        clearTimeout(timeoutIdRef.current);\n      }\n    };\n  });\n\n  /** This is used to disable and reset the \"active\" timeout. */\n  const setEnabled = useCallback((val: boolean) => {\n    if (!val && timeoutIdRef.current) {\n      setActive(false);\n      setIsEnabled(false);\n      clearTimeout(timeoutIdRef.current);\n    } else {\n      setActive(false);\n      setIsEnabled(true);\n      clearTimeout(timeoutIdRef.current);\n    }\n  }, []);\n\n  /** The volume bar is \"active\" for 3 seconds after the last volume update. */\n  const setActiveState = useCallback(() => {\n    if (!enabled) return;\n\n    setActive(true);\n    if (timeoutIdRef.current) {\n      clearTimeout(timeoutIdRef.current);\n    }\n    timeoutIdRef.current = setTimeout(() => {\n      setActive(false);\n    }, 3000);\n  }, [enabled]);\n\n  const increaseVolume = useCallback(() => {\n    setActiveState();\n    if (volume === 1 || !enabled) return;\n\n    const newVolume = Math.min(volume + 0.04, 1);\n\n    setVolume(newVolume);\n  }, [setActiveState, volume, enabled, setVolume]);\n\n  const decreaseVolume = useCallback(() => {\n    setActiveState();\n    if (!enabled) return;\n\n    const newVolume = Math.max(volume - 0.04, 0.01);\n\n    setVolume(newVolume);\n  }, [setActiveState, volume, enabled, setVolume]);\n\n  useEventListener<IpodEvent>('forwardscroll', increaseVolume);\n  useEventListener<IpodEvent>('backwardscroll', decreaseVolume);\n  /** Don't mistake a scroll for a click. */\n  useEventListener<IpodEvent>('wheelclick', () => setActive(false));\n\n  return {\n    setEnabled,\n    volume,\n    active,\n  };\n};\n\nexport default useVolumeHandler;\n","import React, {\n  createContext,\n  memo,\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useState,\n} from 'react';\n\nimport { ErrorScreen } from 'components';\nimport { useEventListener, useMKEventListener, useSettings } from 'hooks';\n\n/**\n * This will be used to connect to the Apple Music API.\n * @see https://developer.apple.com/documentation/applemusicapi/getting_keys_and_creating_tokens\n */\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst DEVELOPER_TOKEN: string | undefined =\n  'eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IlJHWFFEWThYM0MifQ.eyJpYXQiOjE2MTY4ODQ1MDksImV4cCI6MTYzMjQzNjUwOSwiaXNzIjoiRzZIM0NLV005QyJ9.z7NS-8962oumCEaYOUMJfzonO2Y2tAWb_vAF_wwOkDqU8BoWTo6xDg5uG8ZvFeFpMqRoMbBaB_Mr4sxpvJzjPg';\n\nexport interface MusicKitState {\n  musicKit: typeof MusicKit;\n  isConfigured: boolean;\n  hasDevToken: boolean;\n}\n\nexport const MusicKitContext = createContext<MusicKitState>({} as any);\n\nexport type MusicKitHook = MusicKitState & {\n  music: MusicKit.MusicKitInstance;\n  signIn: () => Promise<void>;\n  signOut: () => void;\n};\n\nexport const useMusicKit = (): MusicKitHook => {\n  const musicKit = window.MusicKit;\n  const { setIsAppleAuthorized, isSpotifyAuthorized, setService } =\n    useSettings();\n  const { isConfigured, hasDevToken } = useContext(MusicKitContext);\n  const music = useMemo(() => {\n    if (!isConfigured || !hasDevToken) {\n      return {} as MusicKit.MusicKitInstance;\n    }\n\n    return window.MusicKit.getInstance();\n  }, [hasDevToken, isConfigured]);\n\n  const signIn = useCallback(async () => {\n    if (!music.isAuthorized) {\n      await music.authorize();\n    }\n\n    setService('apple');\n  }, [music, setService]);\n\n  const signOut = useCallback(() => {\n    music.unauthorize();\n    setIsAppleAuthorized(false);\n\n    // Change to Spotify if available.\n    setService(isSpotifyAuthorized ? 'spotify' : undefined);\n  }, [isSpotifyAuthorized, music, setIsAppleAuthorized, setService]);\n\n  return {\n    isConfigured,\n    hasDevToken,\n    musicKit,\n    music,\n    signIn,\n    signOut,\n  };\n};\n\ninterface Props {\n  children: React.ReactNode;\n}\n\nexport const MusicKitProvider = ({ children }: Props) => {\n  const musicKit = window.MusicKit;\n  const [hasDevToken, setHasDevToken] = useState(false);\n  const [isConfigured, setIsConfigured] = useState(false);\n  const { setIsAppleAuthorized, setService: setStreamingService } =\n    useSettings();\n\n  const handleConfigure = useCallback(async () => {\n    try {\n      const music = await musicKit.configure({\n        developerToken:\n          DEVELOPER_TOKEN ??\n          new URLSearchParams(window.location.search).get('token') ??\n          undefined,\n        app: {\n          name: 'iPod.js',\n          build: '1.0',\n        },\n      });\n\n      if (music) {\n        setHasDevToken(true);\n      }\n\n      if (music.isAuthorized) {\n        setIsAppleAuthorized(true);\n      }\n    } catch (e) {\n      setHasDevToken(false);\n    }\n  }, [musicKit, setIsAppleAuthorized]);\n\n  useEffect(() => {\n    if (!isConfigured) {\n      handleConfigure();\n    }\n  }, [handleConfigure, isConfigured]);\n\n  useMKEventListener('userTokenDidChange', (e) => {\n    if (e.userToken) {\n      setIsAppleAuthorized(true);\n      setStreamingService('apple');\n    } else {\n      setIsAppleAuthorized(false);\n      setStreamingService(undefined);\n    }\n  });\n\n  useEventListener('musickitconfigured', () => {\n    setIsConfigured(true);\n  });\n\n  return (\n    <MusicKitContext.Provider value={{ musicKit, isConfigured, hasDevToken }}>\n      {isConfigured ? (\n        children\n      ) : (\n        <ErrorScreen message={'Missing Apple developer token'} />\n      )}\n    </MusicKitContext.Provider>\n  );\n};\n\nexport default memo(MusicKitProvider);\n","import { useEffect } from 'react';\n\n/**\n * MusicKit has its own event listener logic that is attached to the `music` instance.\n * This hook allows us to use it anywhere via a hook, similar to useEventListener.\n */\nconst useMKEventListener = (\n  event: keyof typeof MusicKit.Events,\n  callback: (...args: any) => void\n) => {\n  useEffect(() => {\n    const musicKit = window.MusicKit;\n\n    if (musicKit.errors.length) {\n      return;\n    }\n\n    const music = musicKit.getInstance();\n\n    if (!music) {\n      return;\n    }\n\n    music.addEventListener(event, callback);\n\n    return () => {\n      music.removeEventListener(event, callback);\n    };\n  }, [callback, event]);\n};\n\nexport default useMKEventListener;\n","import { useCallback } from 'react';\n\nimport { useMusicKit } from 'hooks';\nimport queryString from 'query-string';\nimport * as ConversionUtils from 'utils/conversion';\n\ntype FetchAppleMusicApiArgs = {\n  endpoint: string;\n  params?: Record<string, string | number>;\n  inLibrary?: boolean;\n};\n\n/** Connects to the Apple Music API to return data to the UI. */\nconst useMKDataFetcher = () => {\n  const { music } = useMusicKit();\n\n  const fetchAppleMusicApi = useCallback(\n    async <TApiResponseType extends object>({\n      endpoint,\n      inLibrary = false,\n      params = {},\n    }: FetchAppleMusicApiArgs) => {\n      const baseUrl = inLibrary\n        ? `/v1/me/library/${endpoint}`\n        : `/v1/catalog/{{storefrontId}}/${endpoint}`;\n      const paramsString = queryString.stringify(params);\n\n      const url = `${baseUrl}?${paramsString}`;\n\n      try {\n        // TODO: Update types for MusicKit V3\n        const response = await (music.api as any).music(url);\n\n        return response.data as TApiResponseType;\n      } catch (error) {\n        // TODO: Show a popup instead.\n        throw new Error(error);\n      }\n    },\n    [music.api]\n  );\n\n  const fetchAlbums = useCallback(async () => {\n    const response = await fetchAppleMusicApi<AppleMusicApi.AlbumResponse>({\n      endpoint: `/albums`,\n      inLibrary: true,\n      params: {\n        limit: 100,\n      },\n    });\n\n    if (response) {\n      return response.data.map((item: AppleMusicApi.Album) =>\n        ConversionUtils.convertAppleAlbum(item, 300)\n      );\n    }\n  }, [fetchAppleMusicApi]);\n\n  const fetchAlbum = useCallback(\n    async (id: string, inLibrary = false) => {\n      const response = await fetchAppleMusicApi<AppleMusicApi.AlbumResponse>({\n        endpoint: `albums/${id}`,\n        inLibrary,\n      });\n\n      if (response) {\n        return ConversionUtils.convertAppleAlbum(response.data[0]);\n      }\n    },\n    [fetchAppleMusicApi]\n  );\n\n  const fetchArtists = useCallback(async () => {\n    const response = await fetchAppleMusicApi<AppleMusicApi.ArtistResponse>({\n      endpoint: `/artists`,\n      inLibrary: true,\n    });\n\n    return response.data.map(ConversionUtils.convertAppleArtist);\n  }, [fetchAppleMusicApi]);\n\n  const fetchArtistAlbums = useCallback(\n    async (id: string, inLibrary = false) => {\n      const response = await fetchAppleMusicApi<AppleMusicApi.AlbumResponse>({\n        endpoint: `/artists/${id}/albums`,\n        inLibrary,\n      });\n\n      return response.data.map((item: AppleMusicApi.Album) =>\n        ConversionUtils.convertAppleAlbum(item)\n      );\n    },\n    [fetchAppleMusicApi]\n  );\n\n  const fetchPlaylists = useCallback(async () => {\n    const response = await fetchAppleMusicApi<AppleMusicApi.PlaylistResponse>({\n      endpoint: '/playlists',\n      params: {\n        limit: 100,\n      },\n      inLibrary: true,\n    });\n\n    return response.data.map(ConversionUtils.convertApplePlaylist);\n  }, [fetchAppleMusicApi]);\n\n  const fetchPlaylist = useCallback(\n    async (playlistId: string, inLibrary = false) => {\n      const response = await fetchAppleMusicApi<AppleMusicApi.PlaylistResponse>(\n        {\n          endpoint: `/playlists/${playlistId}`,\n          params: {\n            include: 'tracks',\n          },\n          inLibrary,\n        }\n      );\n\n      return ConversionUtils.convertApplePlaylist(response.data[0]);\n    },\n    [fetchAppleMusicApi]\n  );\n\n  return {\n    fetchAlbums,\n    fetchAlbum,\n    fetchArtists,\n    fetchArtistAlbums,\n    fetchPlaylists,\n    fetchPlaylist,\n  };\n};\n\nexport default useMKDataFetcher;\n","import { useRef, useEffect } from 'react';\n\n// Hook\nconst useEventListener = <TEvent extends string>(\n  eventName: TEvent,\n  handler: (...args: any) => void,\n  element = window\n) => {\n  // Create a ref that stores handler\n  const savedHandler = useRef<any>();\n\n  // Update ref.current value if handler changes.\n  // This allows our effect below to always get latest handler ...\n  // ... without us needing to pass it in effect deps array ...\n  // ... and potentially cause effect to re-run every render.\n  useEffect(() => {\n    savedHandler.current = handler;\n  }, [eventName, handler]);\n\n  useEffect(\n    () => {\n      // Make sure element supports addEventListener\n      // On\n      const isSupported = element && element.addEventListener;\n      if (!isSupported) return;\n\n      // Create event listener that calls handler function stored in ref\n      const eventListener = (event: any) =>\n        savedHandler && savedHandler.current && savedHandler.current(event);\n\n      // Add event listener\n      element.addEventListener(eventName, eventListener);\n\n      // Remove event listener on cleanup\n      return () => {\n        element.removeEventListener(eventName, eventListener);\n      };\n    },\n    [eventName, element] // Re-run if eventName or element changes\n  );\n};\n\nexport default useEventListener;\n","import { useCallback } from 'react';\n\nimport { useWindowContext } from 'hooks';\n\nimport useEventListener from '../utils/useEventListener';\nimport { IpodEvent } from 'utils/events';\n\n/**\n * A quick way to use the menu button as a back button.\n * Provide an ID that matches the ID of the window you want to close.\n */\nconst useMenuHideWindow = (id: string) => {\n  const { windowStack, hideWindow } = useWindowContext();\n\n  const handleClick = useCallback(() => {\n    if (windowStack[windowStack.length - 1].id === id) {\n      hideWindow();\n    }\n  }, [hideWindow, id, windowStack]);\n\n  useEventListener<IpodEvent>('menuclick', handleClick);\n};\n\nexport default useMenuHideWindow;\n","import { SelectableList, SelectableListOption } from 'components';\nimport { ViewOptions } from 'components/views';\nimport { useMenuHideWindow, useScrollHandler } from 'hooks';\nimport styled from 'styled-components';\nimport { Unit } from 'utils/constants';\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\n\nconst Image = styled.img`\n  height: ${Unit.XL};\n  width: auto;\n  margin: ${Unit.XS};\n`;\n\nconst TitleContainer = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: ${Unit.MD} ${Unit.MD} 0;\n`;\n\nconst Title = styled.h3`\n  margin: 0;\n  font-size: 16px;\n  font-weight: 900;\n`;\n\nconst Description = styled.h3`\n  margin: 0 0 ${Unit.MD};\n  font-size: 14px;\n  font-weight: normal;\n  text-align: center;\n`;\n\nconst ListContainer = styled.div`\n  flex: 1;\n`;\n\nconst AboutView = () => {\n  useMenuHideWindow(ViewOptions.about.id);\n  const options: SelectableListOption[] = [\n    {\n      type: 'Link',\n      label: 'GitHub Repo',\n      url: 'https://github.com/tvillarete/ipod-classic-js',\n    },\n    {\n      type: 'Link',\n      label: 'My Website',\n      url: 'http://tannerv.com',\n    },\n    {\n      type: 'Link',\n      label: 'LinkedIn',\n      url: 'https://linkedin.com/in/tvillarete',\n    },\n  ];\n\n  const [scrollIndex] = useScrollHandler(ViewOptions.about.id, options);\n\n  return (\n    <Container>\n      <ListContainer>\n        <TitleContainer>\n          <Image alt=\"iPod\" src=\"ipod_logo.svg\" />\n          <Title>iPod.js</Title>\n        </TitleContainer>\n        <Description>\n          Made with{' '}\n          <span aria-label=\"heart\" role=\"img\">\n            ❤️\n          </span>{' '}\n          by Tanner Villarete\n        </Description>\n        <SelectableList options={options} activeIndex={scrollIndex} />\n      </ListContainer>\n    </Container>\n  );\n};\n\nexport default AboutView;\n","export const slideRightAnimation = {\n  variants: {\n    closed: { x: '100%' },\n    open: {\n      x: 0,\n      transition: { duration: 0.3, type: 'tween' },\n    },\n    closing: {\n      x: '100%',\n      transition: { duration: 0.3, type: 'tween' },\n    },\n  },\n  initial: 'closed',\n  animate: 'open',\n  exit: 'closing',\n};\n\nexport const slideLeftAnimation = {\n  variants: {\n    closed: { x: '-110%' },\n    open: {\n      x: 0,\n      transition: { duration: 0.3, type: 'tween' },\n    },\n    closing: {\n      x: '-110%',\n      transition: { duration: 0.3, type: 'tween' },\n    },\n  },\n  initial: 'closed',\n  animate: 'open',\n  exit: 'closing',\n};\n\nexport const slideUpAnimation = {\n  variants: {\n    closed: { y: '110%' },\n    open: {\n      y: 0,\n      transition: { duration: 0.3, type: 'tween' },\n    },\n    closing: {\n      y: '110%',\n      transition: { duration: 0.3, type: 'tween' },\n    },\n  },\n  initial: 'closed',\n  animate: 'open',\n  exit: 'closing',\n};\n\nexport const popInAnimation = {\n  variants: {\n    closed: { scale: 0.6, opacity: 0 },\n    open: {\n      scale: 1,\n      opacity: 1,\n      transition: { duration: 0.3, type: 'spring' },\n    },\n    closing: {\n      scale: 0.6,\n      opacity: 0,\n      transition: { duration: 0.3, type: 'spring' },\n    },\n  },\n  initial: 'closed',\n  animate: 'open',\n  exit: 'closing',\n};\n\nexport const fade = {\n  variants: {\n    closed: { opacity: 0 },\n    open: { opacity: 1 },\n    closing: {\n      opacity: 0,\n      transition: { duration: 0.3, type: 'tween' },\n    },\n  },\n  initial: 'closed',\n  animate: 'open',\n  exit: 'closing',\n};\n\nexport const fadeScale = {\n  variants: {\n    closed: { opacity: 0, scale: 0.3 },\n    open: {\n      opacity: 1,\n      scale: 1,\n      transition: { duration: 0.5, type: 'tween' },\n    },\n    closing: {\n      opacity: 0,\n      scale: 0.3,\n      transition: { duration: 0.3, type: 'tween' },\n    },\n  },\n  initial: 'closed',\n  animate: 'open',\n  exit: 'closing',\n};\n\nexport const previewSlideRight = {\n  variants: {\n    closed: { x: '130%', opacity: 0 },\n    open: {\n      x: 0,\n      opacity: 1,\n      transition: { duration: 0.4, type: 'tween' },\n    },\n    closing: {\n      x: '130%',\n      opacity: 0,\n      transition: { duration: 0.4, type: 'tween' },\n    },\n  },\n  initial: 'closed',\n  animate: 'open',\n  exit: 'closing',\n};\n\nexport const noAnimation = {\n  variants: {\n    closed: {},\n    open: {},\n    closing: {\n      opacity: 0,\n      transition: { duration: 0.3, type: 'tween' },\n    },\n  },\n  initial: 'closed',\n  animate: 'open',\n  exit: 'closing',\n};\n","import { SelectableListOption } from 'components';\n\n/** Accepts a url with '{w}' and '{h}' and replaces them with the specified size */\nexport const getArtwork = (size: number | string, url?: string) => {\n  if (!url) {\n    return undefined;\n  }\n\n  return url.replace('{w}', `${size}`).replace('{h}', `${size}`);\n};\n\nexport const formatTime = (seconds = 0, guide = seconds) => {\n  let s: number | string = Math.floor(seconds % 60);\n  let m: number | string = Math.floor((seconds / 60) % 60);\n  let h: number | string = Math.floor(seconds / 3600);\n  const gm = Math.floor((guide / 60) % 60);\n  const gh = Math.floor(guide / 3600);\n\n  if (isNaN(seconds) || seconds === Infinity) {\n    h = m = s = '-';\n  }\n\n  h = h > 0 || gh > 0 ? `${h}:` : '';\n  m = `${(h || gm >= 10) && m < 10 ? `0${m}` : m}:`;\n  s = s < 10 ? `0${s}` : s;\n\n  return h + m + s;\n};\n\nexport const setDocumentSongTitle = (song?: AppleMusicApi.Song) => {\n  document.title = song\n    ? `${song.attributes?.name ?? 'Music'} – iPod.js`\n    : 'iPod.js';\n};\n\n/** Returns a list of playback options to display in a popup for an album, song, or playlist. */\nexport const getMediaOptions = (\n  type: 'album' | 'song' | 'playlist',\n  id: string\n): SelectableListOption[] => {\n  const music = window.MusicKit.getInstance();\n\n  return [\n    {\n      type: 'Action',\n      label: 'Play Next',\n      onSelect: () =>\n        music.playNext({\n          [type]: id,\n        }),\n    },\n    {\n      type: 'Action',\n      label: 'Play Later',\n      onSelect: () =>\n        music.playLater({\n          [type]: id,\n        }),\n    },\n  ];\n};\n\nexport const isDev = () => window.location.origin.includes('localhost:3000');\n","import { useMemo } from 'react';\n\nimport {\n  LoadingScreen,\n  SelectableList,\n  SelectableListOption,\n} from 'components';\nimport { useDataFetcher, useEventListener, useScrollHandler } from 'hooks';\nimport styled from 'styled-components';\n\nimport ViewOptions from '../';\nimport { IpodEvent } from 'utils/events';\n\nconst Container = styled.div`\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n  top: -28%;\n  bottom: -50%;\n  left: -50%;\n  right: -50%;\n  border: 1px solid lightgray;\n  background: white;\n  transform: rotateY(180deg);\n`;\n\nconst InfoContainer = styled.div`\n  padding: 4px 8px;\n  background: linear-gradient(180deg, #6585ad 0%, #789ab3 100%);\n  border-bottom: 1px solid #6d87a3;\n`;\n\nconst Text = styled.h3`\n  font-size: 16px;\n  margin: 0;\n  color: white;\n`;\n\nconst Subtext = styled(Text)`\n  font-size: 14px;\n`;\n\nconst ListContainer = styled.div`\n  position: relative;\n  flex: 1;\n  overflow: auto;\n`;\n\ninterface Props {\n  albumId: IpodApi.Album['id'];\n  setPlayingAlbum: (val: boolean) => void;\n}\n\nconst BacksideContent = ({ albumId, setPlayingAlbum }: Props) => {\n  const { data: album, isLoading } = useDataFetcher<IpodApi.Album>({\n    name: 'album',\n    id: albumId,\n    inLibrary: true,\n  });\n\n  const options: SelectableListOption[] = useMemo(\n    () =>\n      album?.songs.map((song, index) => ({\n        type: 'Song',\n        label: song.name,\n        queueOptions: {\n          album,\n          startPosition: index,\n        },\n      })) ?? [],\n    [album]\n  );\n  const [scrollIndex] = useScrollHandler(ViewOptions.coverFlow.id, options);\n\n  useEventListener<IpodEvent>('centerclick', () => setPlayingAlbum(true));\n\n  return (\n    <Container>\n      {isLoading ? (\n        <LoadingScreen />\n      ) : (\n        <>\n          <InfoContainer>\n            <Text>{album?.name}</Text>\n            <Subtext>{album?.artistName}</Subtext>\n          </InfoContainer>\n          <ListContainer>\n            <SelectableList activeIndex={scrollIndex} options={options} />\n          </ListContainer>\n        </>\n      )}\n    </Container>\n  );\n};\n\nexport default BacksideContent;\n","import { fadeScale } from 'animation';\nimport { AnimatePresence, motion } from 'framer-motion';\nimport styled, { css } from 'styled-components';\nimport * as Utils from 'utils';\n\nimport BacksideContent from './BacksideContent';\nimport { Point } from './CoverFlow';\n\nconst getOffsetPx = (offset: number, midpoint: number) => {\n  if (offset === 0) return 0;\n  const val = midpoint - 46 + offset * 48;\n\n  return val + (offset < 0 ? -48 : 24);\n};\n\ninterface ContainerProps {\n  isActive: boolean;\n  isSelected: boolean;\n  isPlaying: boolean;\n  isHidden: boolean;\n  midpoint: Point;\n  offset: number;\n  index: number;\n  activeIndex: number;\n}\n\nconst Container = styled.div.attrs((props: ContainerProps) => ({\n  style: {\n    background: 'transparent',\n    backgroundSize: 'cover',\n  },\n}))<ContainerProps>`\n  z-index: ${(props) => 1 - Math.abs(props.index - props.activeIndex)};\n  position: absolute;\n  height: 8em;\n  width: 8em;\n  transition: transform 0.25s, opacity 0.35s, background 0.35s;\n  transform-style: preserve-3d;\n  -webkit-box-reflect: below 0px -webkit-gradient(linear, left top, left bottom, from(transparent), color-stop(70%, transparent), to(rgba(240, 240, 240, 0.2)));\n  opacity: ${(props) => props.isHidden && 0};\n\n  ${(props) =>\n    props.isActive &&\n    css`\n      transition: transform 0.3s, opacity 0.35s, background 0.35s;\n      transform: translate3d(${props.midpoint.x - 60}px, 4px, 20px)\n        ${props.isSelected && 'rotateY(-180deg) translateY(10%) scale(0.96)'};\n\n      ${props.isSelected &&\n      css`\n        transition: transform 0.5s, opacity 0.35s, background 0.35s;\n        -webkit-box-reflect: none;\n\n        ${Artwork} {\n          opacity: 0;\n        }\n      `};\n\n      ${props.isPlaying &&\n      css`\n        transform: translate(${props.midpoint.x - 135}px, -10px) rotateY(18deg);\n\n        ${Artwork} {\n          opacity: 1;\n        }\n      `};\n    `};\n\n  ${(props) =>\n    !props.isActive &&\n    css`\n      transform: translateX(${props.offset}px) scale(1.1) translateZ(-65px)\n        rotateY(${props.index < props.activeIndex ? '70deg' : '-70deg'});\n    `};\n`;\n\nconst Artwork = styled.img`\n  z-index: 0;\n  position: absolute;\n  height: 8em;\n  width: 8em;\n  transition: opacity 0.5s;\n`;\n\nconst Backside = styled(motion.div)`\n  position: relative;\n  height: 100%;\n  width: 100%;\n`;\n\ninterface Props {\n  index: number;\n  activeIndex: number;\n  midpoint: Point;\n  album: IpodApi.Album;\n  isSelected: boolean;\n  playingAlbum: boolean;\n  setPlayingAlbum: (val: boolean) => void;\n}\n\nconst AlbumCover = ({\n  album,\n  midpoint,\n  index,\n  activeIndex,\n  isSelected,\n  playingAlbum,\n  setPlayingAlbum,\n}: Props) => {\n  const isVisible = index > activeIndex - 15 && index < activeIndex + 15;\n  const isActive = index === activeIndex;\n  const offset = getOffsetPx(index - activeIndex, midpoint.x);\n  const isHidden = !isActive && playingAlbum;\n\n  return isVisible ? (\n    <Container\n      isActive={isActive}\n      isSelected={isSelected}\n      isHidden={isHidden}\n      midpoint={midpoint}\n      offset={offset}\n      index={index}\n      activeIndex={activeIndex}\n      isPlaying={isSelected && playingAlbum}\n    >\n      <Artwork src={Utils.getArtwork(300, album.artwork?.url)} />\n      <AnimatePresence>\n        {isSelected && !playingAlbum && (\n          <Backside {...fadeScale}>\n            <BacksideContent\n              albumId={album.id}\n              setPlayingAlbum={setPlayingAlbum}\n            />\n          </Backside>\n        )}\n      </AnimatePresence>\n    </Container>\n  ) : null;\n};\n\nexport default AlbumCover;\n","import { useCallback, useEffect, useRef, useState } from 'react';\n\nimport { fade } from 'animation';\nimport { NowPlaying } from 'components';\nimport { AnimatePresence, motion } from 'framer-motion';\nimport { useEventListener, useWindowContext } from 'hooks';\nimport styled from 'styled-components';\n\nimport AlbumCover from './AlbumCover';\nimport { IpodEvent } from 'utils/events';\n\nexport type Point = {\n  x: number;\n  y: number;\n};\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n`;\n\nconst AlbumsContainer = styled.div`\n  z-index: 2;\n  position: relative;\n  display: flex;\n  flex-wrap: nowrap;\n  flex: 1;\n  padding-top: 8%;\n  -webkit-overflow-scrolling: touch; /* [3] */\n  -ms-overflow-style: -ms-autohiding-scrollbar;\n  perspective: 500px;\n`;\n\nconst InfoContainer = styled(motion.div)`\n  z-index: 0;\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  height: 30%;\n`;\n\nconst NowPlayingContainer = styled(motion.div)`\n  z-index: 1;\n  position: absolute;\n  top: 20px;\n  bottom: 0;\n  left: 0;\n  right: 0;\n`;\n\nconst Text = styled.h3`\n  margin: 0;\n  font-size: 16px;\n  text-align: center;\n\n  :first-of-type {\n    margin-top: 24px;\n  }\n`;\n\ninterface Props {\n  albums: IpodApi.Album[];\n}\n\nconst CoverFlow = ({ albums }: Props) => {\n  const [activeIndex, setActiveIndex] = useState(0);\n  const [midpoint, setMidpoint] = useState<Point>({ x: 0, y: 0 });\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [selectedAlbum, setSelectedAlbum] = useState<IpodApi.Album>();\n  const [playingAlbum, setPlayingAlbum] = useState(false);\n  const { hideWindow } = useWindowContext();\n\n  const selectAlbum = useCallback(() => {\n    if (!selectedAlbum) {\n      const album = albums[activeIndex];\n      setSelectedAlbum(album);\n    }\n  }, [activeIndex, albums, selectedAlbum]);\n\n  const handleMenuClick = useCallback(() => {\n    if (selectedAlbum && playingAlbum) {\n      setPlayingAlbum(false);\n    } else if (selectedAlbum) {\n      setSelectedAlbum(undefined);\n    } else {\n      hideWindow();\n    }\n  }, [hideWindow, playingAlbum, selectedAlbum]);\n\n  const forwardScroll = useCallback(() => {\n    if (activeIndex < albums.length - 1 && !selectedAlbum && !playingAlbum) {\n      setActiveIndex(activeIndex + 1);\n    }\n  }, [activeIndex, albums.length, playingAlbum, selectedAlbum]);\n\n  const backwardScroll = useCallback(() => {\n    if (activeIndex > 0 && !selectedAlbum && !playingAlbum) {\n      setActiveIndex(activeIndex - 1);\n    }\n  }, [activeIndex, playingAlbum, selectedAlbum]);\n\n  const updateMidpoint = useCallback(() => {\n    if (containerRef.current) {\n      const { width, height } = containerRef.current.getBoundingClientRect();\n      setMidpoint({ x: width / 2, y: height / 2 });\n    }\n  }, []);\n\n  useEffect(updateMidpoint, [updateMidpoint]);\n\n  useEventListener<IpodEvent>('centerclick', selectAlbum);\n  useEventListener<IpodEvent>('menuclick', handleMenuClick);\n  useEventListener<IpodEvent>('forwardscroll', forwardScroll);\n  useEventListener<IpodEvent>('backwardscroll', backwardScroll);\n\n  return (\n    <Container>\n      <AlbumsContainer ref={containerRef}>\n        {albums.map((album, index) => (\n          <AlbumCover\n            key={`cf-artwork-${album.id}`}\n            index={index}\n            activeIndex={activeIndex}\n            midpoint={midpoint}\n            album={album}\n            playingAlbum={playingAlbum}\n            isSelected={!!selectedAlbum && album.id === selectedAlbum.id}\n            setPlayingAlbum={setPlayingAlbum}\n          />\n        ))}\n      </AlbumsContainer>\n\n      <AnimatePresence>\n        {albums.length && !playingAlbum && (\n          <InfoContainer {...fade}>\n            <Text>{albums[activeIndex]?.name}</Text>\n            {/* TODO: Add artistName */}\n            {/* <Text>{albums[activeIndex]?.artistName}</Text> */}\n          </InfoContainer>\n        )}\n        {playingAlbum && (\n          <NowPlayingContainer {...fade}>\n            <NowPlaying hideArtwork onHide={handleMenuClick} />\n          </NowPlayingContainer>\n        )}\n      </AnimatePresence>\n    </Container>\n  );\n};\n\nexport default CoverFlow;\n","import React, { useCallback } from 'react';\n\nimport { AuthPrompt, LoadingScreen } from 'components';\nimport {\n  useDataFetcher,\n  useEventListener,\n  useSettings,\n  useWindowContext,\n} from 'hooks';\nimport styled from 'styled-components';\n\nimport CoverFlow from './CoverFlow';\nimport { IpodEvent } from 'utils/events';\n\nconst Container = styled.div`\n  flex: 1;\n`;\n\nconst CoverFlowView = () => {\n  const { hideWindow } = useWindowContext();\n  const { isAuthorized } = useSettings();\n  const { data: albums, isLoading } = useDataFetcher<IpodApi.Album[]>({\n    name: 'albums',\n    artworkSize: 350,\n  });\n\n  const handleMenuClick = useCallback(() => {\n    if (!isAuthorized || isLoading) {\n      hideWindow();\n    }\n  }, [hideWindow, isAuthorized, isLoading]);\n\n  useEventListener<IpodEvent>('menuclick', handleMenuClick);\n\n  return (\n    <Container>\n      {isLoading ? (\n        <LoadingScreen backgroundColor=\"white\" />\n      ) : !isAuthorized ? (\n        <AuthPrompt message=\"Sign in to view Cover Flow\" />\n      ) : (\n        <CoverFlow albums={albums ?? []} />\n      )}\n    </Container>\n  );\n};\n\nexport default CoverFlowView;\n","import { motion } from 'framer-motion';\nimport styled from 'styled-components';\nimport { Unit } from 'utils/constants';\n\nconst Container = styled(motion.div)`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  color: white;\n  background: linear-gradient(180deg, #b1b5c0 0%, #686e7a 100%);\n`;\n\nconst Image = styled.img`\n  height: 6em;\n  width: 6em;\n  margin: ${Unit.XS};\n`;\n\nconst Text = styled.h3`\n  margin: 0;\n  font-size: 16px;\n  font-weight: 500;\n`;\n\nconst GamesPreview = () => {\n  return (\n    <Container>\n      <Image src=\"dice.svg\" />\n      <Text>Games</Text>\n    </Container>\n  );\n};\n\nexport default GamesPreview;\n","import { useMemo } from 'react';\n\nimport { previewSlideRight } from 'animation';\nimport { AuthPrompt, KenBurns, LoadingScreen } from 'components';\nimport { motion } from 'framer-motion';\nimport { useDataFetcher, useSettings } from 'hooks';\nimport styled from 'styled-components';\n\nconst Container = styled(motion.div)`\n  z-index: 1;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n`;\n\nconst MusicPreview = () => {\n  const { isSpotifyAuthorized, isAppleAuthorized } = useSettings();\n  const {\n    data: albums,\n    isLoading,\n    hasError,\n  } = useDataFetcher<IpodApi.Album[]>({\n    name: 'albums',\n    artworkSize: 400,\n  });\n\n  const artworkUrls = useMemo(() => {\n    if (albums && !hasError) {\n      return albums.map((album) => album.artwork?.url ?? '');\n    }\n\n    return [];\n  }, [albums, hasError]);\n\n  return (\n    <Container {...previewSlideRight}>\n      {isLoading ? (\n        <LoadingScreen backgroundColor=\"linear-gradient(180deg, #B1B5C0 0%, #686E7A 100%)\" />\n      ) : !isSpotifyAuthorized && !isAppleAuthorized ? (\n        <AuthPrompt message=\"Sign in to view your library\" />\n      ) : (\n        <KenBurns urls={artworkUrls} />\n      )}\n    </Container>\n  );\n};\n\nexport default MusicPreview;\n","import { motion } from 'framer-motion';\nimport { useAudioPlayer } from 'hooks';\nimport styled from 'styled-components';\nimport * as Utils from 'utils';\n\nconst Container = styled(motion.div)`\n  height: 100%;\n`;\n\nconst Artwork = styled.img`\n  height: 100%;\n  width: auto;\n`;\n\nconst NowPlayingPreview = () => {\n  const { nowPlayingItem } = useAudioPlayer();\n\n  return nowPlayingItem ? (\n    <Container>\n      <Artwork\n        src={Utils.getArtwork(300, nowPlayingItem.artwork?.url)}\n        alt=\"now playing artwork\"\n      />\n    </Container>\n  ) : null;\n};\n\nexport default NowPlayingPreview;\n","import { motion } from 'framer-motion';\nimport { useSettings } from 'hooks';\nimport styled from 'styled-components';\nimport { Unit } from 'utils/constants';\n\nconst Container = styled(motion.div)`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  color: white;\n  background: linear-gradient(180deg, #b1b5c0 0%, #686e7a 100%);\n`;\n\nconst Image = styled.img`\n  height: 6em;\n  width: 6em;\n  margin: ${Unit.XS};\n`;\n\nconst Text = styled.h3`\n  margin: 4px 0 0;\n  font-size: 16px;\n  font-weight: 600;\n`;\n\nconst Subtext = styled(Text)`\n  font-size: 14px;\n  font-weight: 400;\n`;\n\nconst strings = {\n  spotify: 'Spotify',\n  apple: 'Apple Music',\n  none: 'None',\n  selected: 'Selected service',\n};\n\nconst ServicePreview = () => {\n  const { service } = useSettings();\n\n  const imgUrl =\n    service === 'spotify' ? 'spotify_icon.svg' : 'apple_music_icon.svg';\n\n  const text = strings[service ?? 'none'];\n\n  return (\n    <Container>\n      <Image src={imgUrl} />\n      <Text>{text}</Text>\n      <Subtext>{strings.selected}</Subtext>\n    </Container>\n  );\n};\n\nexport default ServicePreview;\n","import { motion } from 'framer-motion';\nimport styled from 'styled-components';\nimport { Unit } from 'utils/constants';\n\nconst Container = styled(motion.div)`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  color: white;\n  background: linear-gradient(180deg, #b1b5c0 0%, #686e7a 100%);\n`;\n\nconst Image = styled.img`\n  height: 4em;\n  width: 4em;\n  margin: ${Unit.XS};\n`;\n\nconst Text = styled.h3`\n  margin: 0;\n  font-size: 16px;\n  font-weight: 500;\n`;\n\nconst Subtext = styled.h3`\n  margin: 0;\n  font-size: 14px;\n  font-weight: 500;\n`;\n\nconst SettingsPreview = () => {\n  return (\n    <Container>\n      <Image src=\"react_logo.svg\" />\n      <Text>iPod.js</Text>\n      <Subtext>by Tanner V</Subtext>\n    </Container>\n  );\n};\n\nexport default SettingsPreview;\n","import { motion } from 'framer-motion';\nimport styled from 'styled-components';\n\nconst Container = styled(motion.div)`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  color: white;\n`;\n\nconst Image = styled.img`\n  height: 100%;\n  width: 100%;\n`;\n\nconst ThemePreview = () => (\n  <Container>\n    <Image src=\"themes_preview.png\" />\n  </Container>\n);\n\nexport default ThemePreview;\n","import { useCallback, useMemo } from 'react';\n\nimport {\n  getConditionalOption,\n  SelectableList,\n  SelectableListOption,\n} from 'components';\nimport { PREVIEW } from 'components/previews';\nimport {\n  CoverFlowView,\n  GamesView,\n  MusicView,\n  NowPlayingView,\n  SettingsView,\n  ViewOptions,\n  WINDOW_TYPE,\n} from 'components/views';\nimport {\n  useAudioPlayer,\n  useEventListener,\n  useMusicKit,\n  useScrollHandler,\n  useSettings,\n  useSpotifySDK,\n  useWindowContext,\n} from 'hooks';\nimport { IpodEvent } from 'utils/events';\n\nconst strings = {\n  nowPlaying: 'Now Playing',\n};\n\nconst HomeView = () => {\n  const { isAuthorized } = useSettings();\n  const { signIn: signInWithApple } = useMusicKit();\n  const { nowPlayingItem } = useAudioPlayer();\n  const { signIn: signInWithSpotify } = useSpotifySDK();\n  const { showWindow, windowStack } = useWindowContext();\n\n  const options: SelectableListOption[] = useMemo(\n    () => [\n      {\n        type: 'View',\n        label: 'Cover Flow',\n        viewId: ViewOptions.coverFlow.id,\n        component: () => <CoverFlowView />,\n        preview: PREVIEW.MUSIC,\n      },\n      {\n        type: 'View',\n        label: 'Music',\n        viewId: ViewOptions.music.id,\n        component: () => <MusicView />,\n        preview: PREVIEW.MUSIC,\n      },\n      {\n        type: 'View',\n        label: 'Games',\n        viewId: ViewOptions.games.id,\n        component: () => <GamesView />,\n        preview: PREVIEW.GAMES,\n      },\n      {\n        type: 'View',\n        label: 'Settings',\n        viewId: ViewOptions.settings.id,\n        component: () => <SettingsView />,\n        preview: PREVIEW.SETTINGS,\n      },\n      ...getConditionalOption(!isAuthorized, {\n        type: 'ActionSheet',\n        id: ViewOptions.signinPopup.id,\n        label: 'Sign in',\n        listOptions: [\n          {\n            type: 'Action',\n            label: 'Apple Music',\n            onSelect: signInWithApple,\n          },\n          {\n            type: 'Action',\n            label: 'Spotify',\n            onSelect: signInWithSpotify,\n          },\n        ],\n        preview: PREVIEW.MUSIC,\n      }),\n      ...getConditionalOption(!!nowPlayingItem, {\n        type: 'View',\n        label: strings.nowPlaying,\n        viewId: ViewOptions.nowPlaying.id,\n        component: () => <NowPlayingView />,\n        preview: PREVIEW.NOW_PLAYING,\n      }),\n    ],\n    [isAuthorized, nowPlayingItem, signInWithApple, signInWithSpotify]\n  );\n\n  const [scrollIndex] = useScrollHandler(ViewOptions.home.id, options);\n\n  const handleIdleState = useCallback(() => {\n    const activeView = windowStack[windowStack.length - 1];\n\n    const shouldShowNowPlaying =\n      !!nowPlayingItem &&\n      activeView.id !== ViewOptions.nowPlaying.id &&\n      activeView.id !== ViewOptions.coverFlow.id;\n\n    // Only show the now playing view if we're playing a song and not already on that view.\n    if (shouldShowNowPlaying) {\n      showWindow({\n        id: ViewOptions.nowPlaying.id,\n        type: WINDOW_TYPE.FULL,\n        component: NowPlayingView,\n      });\n    }\n  }, [nowPlayingItem, showWindow, windowStack]);\n\n  useEventListener<IpodEvent>('idle', handleIdleState);\n\n  return <SelectableList options={options} activeIndex={scrollIndex} />;\n};\n\nexport default HomeView;\n","import React, { useMemo } from 'react';\n\nimport { SelectableList, SelectableListOption } from 'components';\nimport { PREVIEW } from 'components/previews';\nimport {\n  AlbumsView,\n  ArtistsView,\n  CoverFlowView,\n  NowPlayingView,\n  PlaylistsView,\n  ViewOptions,\n} from 'components/views';\nimport { useMenuHideWindow, useMusicKit, useScrollHandler } from 'hooks';\n\nconst MusicView = () => {\n  const { music } = useMusicKit();\n  useMenuHideWindow(ViewOptions.music.id);\n\n  const options: SelectableListOption[] = useMemo(() => {\n    const arr: SelectableListOption[] = [\n      {\n        type: 'View',\n        label: 'Cover Flow',\n        viewId: ViewOptions.coverFlow.id,\n        component: () => <CoverFlowView />,\n        preview: PREVIEW.MUSIC,\n      },\n      {\n        type: 'View',\n        label: 'Playlists',\n        viewId: ViewOptions.playlists.id,\n        component: () => <PlaylistsView />,\n        preview: PREVIEW.MUSIC,\n      },\n      {\n        type: 'View',\n        label: 'Artists',\n        viewId: ViewOptions.artists.id,\n        component: () => <ArtistsView />,\n        preview: PREVIEW.MUSIC,\n      },\n      {\n        type: 'View',\n        label: 'Albums',\n        viewId: ViewOptions.albums.id,\n        component: () => <AlbumsView />,\n        preview: PREVIEW.MUSIC,\n      },\n    ];\n\n    if (music.isAuthorized && music.player?.nowPlayingItem?.isPlayable) {\n      arr.push({\n        type: 'View',\n        label: 'Now playing',\n        viewId: ViewOptions.nowPlaying.id,\n        component: () => <NowPlayingView />,\n        preview: PREVIEW.NOW_PLAYING,\n      });\n    }\n\n    return arr;\n  }, [music.isAuthorized, music.player?.nowPlayingItem?.isPlayable]);\n\n  const [scrollIndex] = useScrollHandler(ViewOptions.music.id, options);\n\n  return <SelectableList options={options} activeIndex={scrollIndex} />;\n};\n\nexport default MusicView;\n","import { useMemo } from 'react';\n\nimport { AuthPrompt, SelectableList, SelectableListOption } from 'components';\nimport {\n  useDataFetcher,\n  useMenuHideWindow,\n  useScrollHandler,\n  useSettings,\n} from 'hooks';\n\nimport ViewOptions, { ArtistView } from '../';\n\nconst ArtistsView = () => {\n  useMenuHideWindow(ViewOptions.artists.id);\n  const { isAuthorized } = useSettings();\n  const { data: artists, isLoading } = useDataFetcher<IpodApi.Artist[]>({\n    name: 'artists',\n  });\n\n  const options: SelectableListOption[] = useMemo(\n    () =>\n      artists?.map((artist) => ({\n        type: 'View',\n        label: artist.name,\n        viewId: ViewOptions.artist.id,\n        component: () => <ArtistView id={artist.id} inLibrary={true} />,\n      })) ?? [],\n    [artists]\n  );\n\n  const [scrollIndex] = useScrollHandler(ViewOptions.artists.id, options);\n\n  return isAuthorized ? (\n    <SelectableList\n      loading={isLoading}\n      options={options}\n      activeIndex={scrollIndex}\n      emptyMessage=\"No saved artists\"\n    />\n  ) : (\n    <AuthPrompt message=\"Sign in to view your artists\" />\n  );\n};\n\nexport default ArtistsView;\n","import { useMemo } from 'react';\n\nimport { SelectableList, SelectableListOption } from 'components';\nimport { AlbumView, ViewOptions } from 'components/views';\nimport { useDataFetcher, useMenuHideWindow, useScrollHandler } from 'hooks';\nimport * as Utils from 'utils';\n\ninterface Props {\n  id: string;\n  /** Get artist from the user's library if true (otherwise search Apple Music). */\n  inLibrary?: boolean;\n}\n\nconst ArtistView = ({ id, inLibrary = false }: Props) => {\n  useMenuHideWindow(ViewOptions.artist.id);\n\n  const { data: albums, isLoading } = useDataFetcher<IpodApi.Album[]>({\n    name: 'artist',\n    id,\n    inLibrary,\n  });\n  const options: SelectableListOption[] = useMemo(\n    () =>\n      albums?.map((album) => ({\n        type: 'View',\n        label: album.name,\n        sublabel: album.artistName,\n        imageUrl: Utils.getArtwork(100, album.artwork?.url),\n        viewId: ViewOptions.album.id,\n        component: () => (\n          <AlbumView id={album.id ?? ''} inLibrary={inLibrary} />\n        ),\n        longPressOptions: Utils.getMediaOptions('album', album.id),\n      })) ?? [],\n    [albums, inLibrary]\n  );\n\n  const [scrollIndex] = useScrollHandler(ViewOptions.artist.id, options);\n\n  return (\n    <SelectableList\n      loading={isLoading}\n      options={options}\n      activeIndex={scrollIndex}\n      emptyMessage=\"No albums by this artist\"\n    />\n  );\n};\n\nexport default ArtistView;\n","import { useMemo } from 'react';\n\nimport { AuthPrompt, SelectableList, SelectableListOption } from 'components';\nimport {\n  useDataFetcher,\n  useMenuHideWindow,\n  useScrollHandler,\n  useSettings,\n} from 'hooks';\nimport * as Utils from 'utils';\n\nimport ViewOptions, { AlbumView } from '../';\n\nconst AlbumsView = () => {\n  const { isAuthorized } = useSettings();\n  useMenuHideWindow(ViewOptions.albums.id);\n\n  const { data: albums, isLoading } = useDataFetcher<IpodApi.Album[]>({\n    name: 'albums',\n  });\n\n  const options: SelectableListOption[] = useMemo(\n    () =>\n      albums?.map((album) => ({\n        type: 'View',\n        label: album.name,\n        sublabel: album.artistName,\n        imageUrl: Utils.getArtwork(50, album.artwork?.url),\n        viewId: ViewOptions.album.id,\n        component: () => <AlbumView id={album.id ?? ''} inLibrary />,\n      })) ?? [],\n    [albums]\n  );\n\n  const [scrollIndex] = useScrollHandler(ViewOptions.albums.id, options);\n\n  return isAuthorized ? (\n    <SelectableList\n      loading={isLoading}\n      options={options}\n      activeIndex={scrollIndex}\n      emptyMessage=\"No albums\"\n    />\n  ) : (\n    <AuthPrompt />\n  );\n};\n\nexport default AlbumsView;\n","import { useMemo } from 'react';\n\nimport { SelectableList, SelectableListOption } from 'components';\nimport { ViewOptions } from 'components/views';\nimport { useDataFetcher, useMenuHideWindow, useScrollHandler } from 'hooks';\nimport * as Utils from 'utils';\n\ninterface Props {\n  id: string;\n  /** Get album from the user's library if true (otherwise search Apple Music). */\n  inLibrary?: boolean;\n}\n\nconst AlbumView = ({ id, inLibrary = false }: Props) => {\n  useMenuHideWindow(ViewOptions.album.id);\n\n  const { data: album, isLoading } = useDataFetcher<IpodApi.Album>({\n    name: 'album',\n    id,\n    inLibrary,\n  });\n\n  const options: SelectableListOption[] = useMemo(\n    () =>\n      album?.songs.map((song, index) => ({\n        type: 'Song',\n        label: song.name,\n        queueOptions: {\n          album,\n          startPosition: index,\n        },\n        showNowPlayingView: true,\n        longPressOptions: Utils.getMediaOptions('song', song.id),\n      })) ?? [],\n    [album]\n  );\n\n  const [scrollIndex] = useScrollHandler(ViewOptions.album.id, options);\n\n  return (\n    <SelectableList\n      loading={isLoading}\n      options={options}\n      activeIndex={scrollIndex}\n      emptyMessage=\"No saved songs\"\n    />\n  );\n};\n\nexport default AlbumView;\n","import { NowPlaying } from 'components';\nimport ViewOptions from 'components/views';\nimport { useMenuHideWindow, useWindowContext } from 'hooks';\n\nconst NowPlayingView = () => {\n  useMenuHideWindow(ViewOptions.nowPlaying.id);\n  const { hideWindow } = useWindowContext();\n\n  return <NowPlaying onHide={hideWindow} />;\n};\n\nexport default NowPlayingView;\n","import { useMemo } from 'react';\n\nimport { AuthPrompt, SelectableList, SelectableListOption } from 'components';\nimport {\n  useDataFetcher,\n  useMenuHideWindow,\n  useScrollHandler,\n  useSettings,\n} from 'hooks';\nimport * as Utils from 'utils';\n\nimport ViewOptions, { PlaylistView } from '../';\n\nconst PlaylistsView = () => {\n  useMenuHideWindow(ViewOptions.playlists.id);\n  const { isAuthorized } = useSettings();\n  const { data, isLoading } = useDataFetcher<IpodApi.Playlist[]>({\n    name: 'playlists',\n  });\n\n  const options: SelectableListOption[] = useMemo(\n    () =>\n      data?.map((playlist) => ({\n        type: 'View',\n        label: playlist.name,\n        sublabel: playlist.description || `By ${playlist.curatorName}`,\n        imageUrl: playlist.artwork?.url,\n        viewId: ViewOptions.playlist.id,\n        component: () => <PlaylistView id={playlist.id} inLibrary />,\n        longPressOptions: Utils.getMediaOptions('playlist', playlist.id),\n      })) ?? [],\n    [data]\n  );\n\n  const [scrollIndex] = useScrollHandler(ViewOptions.playlists.id, options);\n\n  return isAuthorized ? (\n    <SelectableList\n      loading={isLoading}\n      options={options}\n      activeIndex={scrollIndex}\n      emptyMessage=\"No saved playlists\"\n    />\n  ) : (\n    <AuthPrompt message=\"Sign in to view your playlists\" />\n  );\n};\n\nexport default PlaylistsView;\n","import { useMemo } from 'react';\n\nimport { SelectableList, SelectableListOption } from 'components';\nimport { ViewOptions } from 'components/views';\nimport { useDataFetcher, useMenuHideWindow, useScrollHandler } from 'hooks';\nimport * as Utils from 'utils';\n\ninterface Props {\n  id: string;\n  /** Get playlist from the user's library if true (otherwise search Apple Music). */\n  inLibrary?: boolean;\n}\n\nconst PlaylistView = ({ id, inLibrary = false }: Props) => {\n  useMenuHideWindow(ViewOptions.playlist.id);\n  const { data: playlist, isLoading } = useDataFetcher<IpodApi.Playlist>({\n    name: 'playlist',\n    id,\n    inLibrary,\n  });\n\n  const options: SelectableListOption[] = useMemo(\n    () =>\n      playlist?.songs.map((song, index) => ({\n        type: 'Song',\n        label: song.name,\n        sublabel: song.artistName ?? 'Unknown artist',\n        imageUrl: song.artwork?.url,\n        queueOptions: {\n          playlist,\n          startPosition: index,\n        },\n        showNowPlayingView: true,\n        longPressOptions: Utils.getMediaOptions('song', song.id),\n      })) ?? [],\n    [playlist]\n  );\n\n  const [scrollIndex] = useScrollHandler(ViewOptions.playlist.id, options);\n\n  return (\n    <SelectableList\n      loading={isLoading}\n      options={options}\n      activeIndex={scrollIndex}\n      emptyMessage=\"No songs in this playlist\"\n    />\n  );\n};\n\nexport default PlaylistView;\n","import { SelectableList, SelectableListOption } from 'components';\nimport { PREVIEW } from 'components/previews';\nimport { BrickGameView, ViewOptions } from 'components/views';\nimport { useMenuHideWindow, useScrollHandler } from 'hooks';\n\nconst GamesView = () => {\n  useMenuHideWindow(ViewOptions.games.id);\n  const options: SelectableListOption[] = [\n    {\n      type: 'View',\n      label: 'Brick',\n      viewId: ViewOptions.brickGame.id,\n      component: () => <BrickGameView />,\n      preview: PREVIEW.GAMES,\n    },\n  ];\n\n  const [scrollIndex] = useScrollHandler(ViewOptions.games.id, options);\n\n  return <SelectableList options={options} activeIndex={scrollIndex} />;\n};\n\nexport default GamesView;\n","const app = {\n  init: function () {\n    this.canvas = document.querySelector('#brickBreakerCanvas');\n    this.context = this.canvas ? this.canvas.getContext('2d') : null;\n\n    if (!this.context) {\n      console.log('Error getting application context');\n      return; //TODO: notify user\n    }\n\n    window.addEventListener('centerclick', this.handleCenterClick);\n    this.inStasis = false;\n\n    if (!this.initialized) {\n      window.addEventListener('forwardscroll', () => player.moveRight(), true);\n      window.addEventListener('backwardscroll', () => player.moveLeft(), true);\n      window.addEventListener('menuclick', () => (this.inStasis = true));\n\n      this.waiting = true;\n      this.setupBricks();\n      player.draw();\n      this.drawBricks();\n      ball.update();\n      this.update();\n\n      this.initialized = true;\n    }\n\n    return;\n  },\n\n  handleCenterClick: function () {\n    if (app.waiting && !app.inStasis) {\n      app.waiting = false;\n    }\n  },\n\n  enterStasis: function () {},\n\n  update: function () {\n    app.clearContext();\n    player.draw();\n    app.drawBricks();\n\n    ball.update();\n\n    requestAnimationFrame(app.update);\n  },\n\n  clearContext: function () {\n    this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    return;\n  },\n\n  die: function () {\n    //TODO: better death!\n    player.position.x = 200;\n    player.lives -= 1;\n\n    if (player.lives < 1) this.reset();\n\n    ball.reset();\n    app.waiting = true;\n  },\n\n  drawBricks: function () {\n    this.bricks.forEach(function (brick) {\n      brick.draw();\n    });\n  },\n\n  //TODO: this will change per level\n  setupBricks: function () {\n    this.bricks = [];\n\n    var i = 0;\n    var brickTop = 50;\n\n    //Setup back row:\n    for (i = 0; i < 10; i++) {\n      const brick = new Brick();\n      brick.position.x = 100 + i * brick.size.width + i;\n      brick.position.y = brickTop;\n      brick.health = 1;\n      this.bricks.push(brick);\n    }\n\n    //Setup middle row:\n    for (i = 0; i < 8; i++) {\n      const brick = new Brick();\n      brick.position.x = 150 + i * brick.size.width + i;\n      brick.position.y = brickTop + brick.size.height + 1;\n      brick.health = 2;\n      this.bricks.push(brick);\n    }\n\n    //Setup front row:\n    for (i = 0; i < 6; i++) {\n      var brick = new Brick();\n      brick.position.x = 200 + i * brick.size.width + i;\n      brick.position.y = brickTop + 2 * brick.size.height + 1;\n      brick.health = 3;\n      this.bricks.push(brick);\n    }\n  },\n\n  reset: function () {\n    player.reset();\n    ball.reset();\n    this.setupBricks();\n  },\n\n  bricks: [],\n\n  canvas: null,\n  context: null,\n  timeout: 33,\n};\n\nvar player = {\n  // Defines initial position\n  position: {\n    x: 200,\n    y: 480,\n  },\n\n  score: 0,\n\n  lives: 3,\n\n  physics: {\n    speed: 10,\n  },\n\n  size: {\n    height: 20,\n    width: 150,\n  },\n\n  draw: function () {\n    app.context.fillStyle = 'black';\n    app.context.fillRect(\n      this.position.x,\n      this.position.y,\n      this.size.width,\n      this.size.height\n    );\n\n    // app.context.textAlign = \"center\";\n    // app.context.fillStyle = \"rgba(0, 0, 0, .2)\";\n\n    // app.context.font = \"18px sans-serif\";\n    // app.context.fillText(\"Lives\", 40, 20);\n    // app.context.fillText(\"Score\", 40, 120);\n\n    // app.context.font = \"48px sans-serif\";\n    // app.context.fillText(this.lives, 40, 75);\n    // app.context.fillText(this.score, 40, 175);\n  },\n\n  moveLeft: function () {\n    if (this.position.x > 0) this.position.x -= this.physics.speed * 1.5;\n  },\n\n  moveRight: function () {\n    if (this.position.x < app.canvas.width - this.size.width)\n      this.position.x += this.physics.speed * 1.5;\n  },\n\n  reset: function () {\n    this.lives = 3;\n    this.score = 0;\n    this.resetPosition();\n  },\n\n  resetPosition: function () {\n    this.position.x = 200;\n  },\n};\n\nvar ball = {\n  position: {\n    x: 0,\n    y: 250,\n  },\n\n  size: {\n    height: 10,\n    width: 10,\n  },\n\n  physics: {\n    speed: 5,\n  },\n\n  direction: {\n    x: 1, //Moving right\n    y: 1, //Moving down\n  },\n\n  draw: function () {\n    app.context.fillStyle = 'transparent';\n    const context = app.context;\n    const centerX = this.position.x;\n    const centerY = this.position.y;\n    const radius = 10;\n\n    context.beginPath();\n    context.arc(centerX, centerY, radius, 0, 2 * Math.PI, false);\n    context.fillStyle = 'black';\n    context.fill();\n    context.lineWidth = 5;\n    context.strokeStyle = 'black';\n    context.stroke();\n  },\n\n  reset: function () {\n    this.position.x = 0;\n    this.position.y = 250;\n    this.direction.x = 1;\n    this.direction.y = 1;\n  },\n\n  update: function () {\n    if (this.position.x <= 0)\n      //Left Bounds\n      this.direction.x = 1;\n    if (this.position.x >= app.canvas.width)\n      //Right Bounds\n      this.direction.x = -1;\n    if (this.position.y <= 0)\n      //Top Bounds\n      this.direction.y = 1;\n    if (this.position.y >= app.canvas.height)\n      //Bottom Bounds\n      app.die(); //TODO: die\n\n    if (!app.waiting && !app.inStasis) {\n      this.checkCollisionWithPlayer();\n      this.checkCollisionWithBricks();\n\n      this.position.x += this.physics.speed * this.direction.x;\n      this.position.y += this.physics.speed * this.direction.y;\n    }\n\n    this.draw();\n  },\n\n  checkCollisionWithPlayer: function () {\n    if (this.position.y + this.size.height < player.position.y) return;\n    if (this.position.y > player.position.y + player.size.height) return;\n    if (this.position.x > player.position.x + player.size.width) return;\n    if (this.position.x + this.size.width < player.position.x) return;\n\n    this.direction.y = -1; //Moving up now\n  },\n\n  checkCollisionWithBricks: function () {\n    var i = 0;\n    for (i = 0; i < app.bricks.length; i++) {\n      var brick = app.bricks[i];\n\n      if (this.position.y + this.size.height < brick.position.y) continue;\n      if (this.position.y > brick.position.y + brick.size.height) continue;\n      if (this.position.x > brick.position.x + brick.size.width) continue;\n      if (this.position.x + this.size.width < brick.position.x) continue;\n\n      /* If the loop makes it this far, we have a collision */\n      brick.health -= 1;\n\n      player.score += 20;\n\n      if (brick.health < 1) app.bricks.splice(i, 1);\n\n      //Update direction based on where we hit the brick\n\n      //Moving towards lower right\n      if (this.direction.x === 1 && this.direction.y === 1) {\n        if (this.position.y > brick.position.y) this.direction.x = -1;\n        else this.direction.y = -1;\n      }\n      //Moving towards lower left\n      else if (this.direction.x === -1 && this.direction.y === 1) {\n        if (this.position.y > brick.position.y) this.direction.x = 1;\n        else this.direction.y = -1;\n      }\n      //Moving towards upper right\n      else if (this.direction.x === 1 && this.direction.y === -1) {\n        if (this.position.y > brick.position.y) this.direction.x = -1;\n        else this.direction.y = -1;\n      }\n      //Moving towards upper-left\n      else if (this.direction.x === -1 && this.direction.y === -1) {\n        if (this.position.y > brick.position.y) this.direction.x = 1;\n        else this.direction.y = -1;\n      }\n    }\n  },\n};\n\nvar Brick = function () {\n  this.health = 3;\n\n  this.size = {\n    height: 20,\n    width: 60,\n  };\n\n  //Will be determined on setup\n  this.position = {\n    x: 0,\n    y: 0,\n  };\n};\n\nBrick.prototype.draw = function () {\n  // eslint-disable-next-line default-case\n  switch (this.health) {\n    case 3:\n      app.context.fillStyle = 'rgb(0, 240, 0)'; //Green\n      break;\n    case 2:\n      app.context.fillStyle = 'rgb(255,140,0'; //Orange?\n      break;\n    case 1:\n      app.context.fillStyle = 'rgb(200, 0, 0)'; //Red\n      break;\n  }\n\n  if (this.health > 0)\n    app.context.fillRect(\n      this.position.x,\n      this.position.y,\n      this.size.width - 5,\n      this.size.height - 5\n    );\n};\n\nexport default app;\n","export { default as AboutView } from './AboutView';\nexport { default as CoverFlowView } from './CoverFlowView';\nexport { default as HomeView } from './HomeView';\nexport { default as MusicView } from './MusicView';\nexport { default as ArtistsView } from './ArtistsView';\nexport { default as ArtistView } from './ArtistView';\nexport { default as AlbumsView } from './AlbumsView';\nexport { default as AlbumView } from './AlbumView';\nexport { default as NowPlayingView } from './NowPlayingView';\nexport { default as PlaylistsView } from './PlaylistsView';\nexport { default as PlaylistView } from './PlaylistView';\nexport { default as GamesView } from './GamesView';\nexport { default as BrickGameView } from './BrickGameView';\nexport { default as SettingsView } from './SettingsView';\n\nexport enum WINDOW_TYPE {\n  SPLIT = 'SPLIT',\n  FULL = 'FULL',\n  COVER_FLOW = 'COVER_FLOW',\n  ACTION_SHEET = 'ACTION_SHEET',\n  POPUP = 'POPUP',\n}\n\ntype ViewOption = {\n  id: string;\n  title: string;\n  type: WINDOW_TYPE;\n};\n\nexport const ViewOptions: Record<string, ViewOption> = {\n  // Split Screen Views\n  home: { id: 'home', title: 'iPod.js', type: WINDOW_TYPE.SPLIT },\n  music: { id: 'music', title: 'Music', type: WINDOW_TYPE.SPLIT },\n  games: { id: 'games', title: 'Games', type: WINDOW_TYPE.SPLIT },\n  settings: { id: 'settings', title: 'Settings', type: WINDOW_TYPE.SPLIT },\n\n  // Fullscreen Views\n  about: { id: 'about', title: 'About', type: WINDOW_TYPE.FULL },\n  artists: { id: 'artists', title: 'Artists', type: WINDOW_TYPE.FULL },\n  artist: { id: 'artist', title: 'Artist', type: WINDOW_TYPE.FULL },\n  albums: { id: 'albums', title: 'Albums', type: WINDOW_TYPE.FULL },\n  album: { id: 'album', title: 'Album', type: WINDOW_TYPE.FULL },\n  nowPlaying: {\n    id: 'nowPlaying',\n    title: 'Now Playing',\n    type: WINDOW_TYPE.FULL,\n  },\n  playlists: { id: 'playlists', title: 'Playlists', type: WINDOW_TYPE.FULL },\n  playlist: { id: 'playlist', title: 'Playlist', type: WINDOW_TYPE.FULL },\n  brickGame: { id: 'brickGame', title: 'Brick', type: WINDOW_TYPE.FULL },\n\n  // CoverFlow view\n  coverFlow: {\n    id: 'coverFlow',\n    title: 'Cover Flow',\n    type: WINDOW_TYPE.COVER_FLOW,\n  },\n\n  // Action sheets\n  mediaActionSheet: {\n    id: 'mediaActionSheet',\n    title: 'Media Options',\n    type: WINDOW_TYPE.ACTION_SHEET,\n  },\n  serviceTypeActionSheet: {\n    id: 'serviceTypeActionSheet',\n    title: 'Service',\n    type: WINDOW_TYPE.ACTION_SHEET,\n  },\n  deviceThemeActionSheet: {\n    id: 'deviceThemeActionSheet',\n    title: 'Device theme',\n    type: WINDOW_TYPE.ACTION_SHEET,\n  },\n  signinPopup: {\n    id: 'signinPopup',\n    title: 'Sign in',\n    type: WINDOW_TYPE.ACTION_SHEET,\n  },\n  signOutPopup: {\n    id: 'signOutPopup',\n    title: 'Sign out',\n    type: WINDOW_TYPE.ACTION_SHEET,\n  },\n\n  // Popups\n  spotifyNotSupportedPopup: {\n    id: 'spotifyNotSupportedPopup',\n    title: 'Unsupported browser',\n    type: WINDOW_TYPE.POPUP,\n  },\n};\n\nexport default ViewOptions;\n","import { useEffect } from 'react';\n\nimport { useMenuHideWindow } from 'hooks';\nimport styled from 'styled-components';\n\nimport ViewOptions from '../';\nimport Game from './Game';\n\nconst RootContainer = styled.div`\n  height: 100%;\n  background: rgb(2, 0, 36);\n  background: linear-gradient(\n    90deg,\n    rgba(2, 0, 36, 1) 0%,\n    rgba(107, 173, 255, 1) 0%,\n    rgba(0, 212, 255, 1) 100%\n  );\n`;\n\nconst Canvas = styled.canvas`\n  height: 100%;\n  width: 100%;\n`;\n\nconst BrickGame = () => {\n  useMenuHideWindow(ViewOptions.brickGame.id);\n  useEffect(() => {\n    Game.init();\n  }, []);\n\n  return (\n    <RootContainer>\n      <Canvas width=\"800\" height=\"500\" id=\"brickBreakerCanvas\">\n        <p>Your browser does not support this feature</p>\n      </Canvas>\n    </RootContainer>\n  );\n};\n\nexport default BrickGame;\n","import { useMemo } from 'react';\n\nimport {\n  getConditionalOption,\n  SelectableList,\n  SelectableListOption,\n} from 'components';\nimport { PREVIEW } from 'components/previews';\nimport ViewOptions, { AboutView } from 'components/views';\nimport {\n  useMenuHideWindow,\n  useMusicKit,\n  useScrollHandler,\n  useSettings,\n  useSpotifySDK,\n} from 'hooks';\n\nconst SettingsView = () => {\n  useMenuHideWindow(ViewOptions.settings.id);\n  const {\n    isAuthorized,\n    isAppleAuthorized,\n    isSpotifyAuthorized,\n    service,\n    deviceTheme,\n    setDeviceTheme,\n  } = useSettings();\n  const { signIn: signInWithApple, signOut: signOutApple } = useMusicKit();\n  const { signOut: signOutSpotify, signIn: signInWithSpotify } =\n    useSpotifySDK();\n\n  const options: SelectableListOption[] = useMemo(\n    () => [\n      {\n        type: 'View',\n        label: 'About',\n        viewId: ViewOptions.about.id,\n        component: () => <AboutView />,\n        preview: PREVIEW.SETTINGS,\n      },\n      /** Add an option to select between services signed into more than one. */\n      ...getConditionalOption(isAuthorized, {\n        type: 'ActionSheet',\n        id: ViewOptions.serviceTypeActionSheet.id,\n        label: 'Choose service',\n        listOptions: [\n          {\n            type: 'Action',\n            isSelected: service === 'apple',\n            label: `Apple Music ${service === 'apple' ? '(Current)' : ''}`,\n            onSelect: signInWithApple,\n          },\n          {\n            type: 'Action',\n            isSelected: service === 'spotify',\n            label: `Spotify ${service === 'spotify' ? '(Current)' : ''}`,\n            onSelect: signInWithSpotify,\n          },\n        ],\n        preview: PREVIEW.SERVICE,\n      }),\n      {\n        type: 'ActionSheet',\n        id: ViewOptions.deviceThemeActionSheet.id,\n        label: 'Device theme',\n        listOptions: [\n          {\n            type: 'Action',\n            isSelected: deviceTheme === 'silver',\n            label: `Silver ${deviceTheme === 'silver' ? '(Current)' : ''}`,\n            onSelect: () => setDeviceTheme('silver'),\n          },\n          {\n            type: 'Action',\n            isSelected: deviceTheme === 'black',\n            label: `Black ${deviceTheme === 'black' ? '(Current)' : ''}`,\n            onSelect: () => setDeviceTheme('black'),\n          },\n          {\n            type: 'Action',\n            isSelected: deviceTheme === 'u2',\n            label: `U2 Edition ${deviceTheme === 'u2' ? '(Current)' : ''}`,\n            onSelect: () => setDeviceTheme('u2'),\n          },\n        ],\n        preview: PREVIEW.THEME,\n      },\n      /** Show the sign in option if not signed into any service. */\n      ...getConditionalOption(!isAuthorized, {\n        type: 'ActionSheet',\n        id: ViewOptions.signinPopup.id,\n        label: 'Sign in',\n        listOptions: [\n          {\n            type: 'Action',\n            label: 'Apple Music',\n            onSelect: signInWithApple,\n          },\n          {\n            type: 'Action',\n            label: 'Spotify',\n            onSelect: signInWithSpotify,\n          },\n        ],\n        preview: PREVIEW.MUSIC,\n      }),\n      /** Show the signout option for any services that are authenticated. */\n      ...getConditionalOption(isAuthorized, {\n        type: 'ActionSheet',\n        id: ViewOptions.signOutPopup.id,\n        label: 'Sign out',\n        listOptions: [\n          ...getConditionalOption(isAppleAuthorized, {\n            type: 'Action',\n            label: 'Apple Music',\n            onSelect: signOutApple,\n          }),\n          ...getConditionalOption(isSpotifyAuthorized, {\n            type: 'Action',\n            label: 'Spotify',\n            onSelect: signOutSpotify,\n          }),\n        ],\n        preview: PREVIEW.SERVICE,\n      }),\n    ],\n    [\n      deviceTheme,\n      setDeviceTheme,\n      isAppleAuthorized,\n      isAuthorized,\n      isSpotifyAuthorized,\n      service,\n      signInWithApple,\n      signInWithSpotify,\n      signOutApple,\n      signOutSpotify,\n    ]\n  );\n\n  const [scrollIndex] = useScrollHandler(ViewOptions.settings.id, options);\n\n  return <SelectableList options={options} activeIndex={scrollIndex} />;\n};\n\nexport default SettingsView;\n","import { useCallback, useRef, useState } from 'react';\n\nimport { useEffectOnce, useEventListener, useSettings } from 'hooks';\n\nimport Knob from './Knob';\nimport { createIpodEvent } from 'utils/events';\nimport { getTheme } from '../../utils/themes';\n\nenum WHEEL_QUADRANT {\n  TOP = 1,\n  BOTTOM = 2,\n  LEFT = 3,\n  RIGHT = 4,\n}\n\ntype SupportedKeyCode =\n  | 'ArrowUp'\n  | 'ArrowDown'\n  | 'ArrowLeft'\n  | 'ArrowRight'\n  | 'Escape'\n  | 'Enter'\n  | ' '\n  | 'Spacebar';\n\nconst centerClickEvent = createIpodEvent('centerclick');\nconst centerLongClickEvent = createIpodEvent('centerlongclick');\nconst forwardScrollEvent = createIpodEvent('forwardscroll');\nconst backwardScrollEvent = createIpodEvent('backwardscroll');\nconst wheelClickEvent = createIpodEvent('wheelclick');\nconst menuClickEvent = createIpodEvent('menuclick');\nconst menuLongPressEvent = createIpodEvent('menulongpress');\nconst backClickEvent = createIpodEvent('backwardclick');\nconst forwardClickEvent = createIpodEvent('forwardclick');\nconst playPauseClickEvent = createIpodEvent('playpauseclick');\nconst idleEvent = createIpodEvent('idle');\n\nconst ScrollWheel = () => {\n  const { deviceTheme } = useSettings();\n  const [count, setCount] = useState(0);\n  const timeoutIdRef = useRef<any>();\n\n  const handleCenterClick = useCallback(\n    () => window.dispatchEvent(centerClickEvent),\n    []\n  );\n\n  const handleCenterLongPress = useCallback((e: any) => {\n    e.preventDefault();\n    window.dispatchEvent(centerLongClickEvent);\n  }, []);\n\n  const handleMenuLongPress = useCallback((e: any) => {\n    e.preventDefault();\n    window.dispatchEvent(menuLongPressEvent);\n  }, []);\n\n  const handleClockwiseScroll = useCallback(\n    () => window.dispatchEvent(forwardScrollEvent),\n    []\n  );\n\n  const handleCounterClockwiseScroll = useCallback(() => {\n    window.dispatchEvent(backwardScrollEvent);\n  }, []);\n\n  const handleResetIdleCheck = useCallback(() => {\n    clearTimeout(timeoutIdRef.current);\n\n    timeoutIdRef.current = setTimeout(() => {\n      window.dispatchEvent(idleEvent);\n    }, 10000);\n  }, []);\n\n  const handleWheelClick = useCallback(\n    (quadrant: number) => {\n      window.dispatchEvent(wheelClickEvent);\n\n      switch (quadrant) {\n        case WHEEL_QUADRANT.TOP:\n          window.dispatchEvent(menuClickEvent);\n          break;\n        case WHEEL_QUADRANT.BOTTOM:\n          window.dispatchEvent(playPauseClickEvent);\n          break;\n        case WHEEL_QUADRANT.LEFT:\n          window.dispatchEvent(backClickEvent);\n          break;\n        case WHEEL_QUADRANT.RIGHT:\n          window.dispatchEvent(forwardClickEvent);\n          break;\n      }\n\n      handleResetIdleCheck();\n    },\n    [handleResetIdleCheck]\n  );\n\n  /** Allows for keyboard navigation. */\n  const handleKeyPress = useCallback(\n    (event: React.KeyboardEvent<HTMLDivElement>) => {\n      switch (event.key as SupportedKeyCode) {\n        case 'ArrowUp':\n        case 'ArrowLeft':\n          handleCounterClockwiseScroll();\n          break;\n        case 'ArrowDown':\n        case 'ArrowRight':\n          handleClockwiseScroll();\n          break;\n        case 'Enter':\n          handleCenterClick();\n          break;\n        case ' ':\n        case 'Spacebar':\n          handleWheelClick(WHEEL_QUADRANT.BOTTOM);\n          break;\n        case 'Escape':\n          handleWheelClick(WHEEL_QUADRANT.TOP);\n          break;\n      }\n\n      handleResetIdleCheck();\n    },\n    [\n      handleResetIdleCheck,\n      handleCounterClockwiseScroll,\n      handleClockwiseScroll,\n      handleCenterClick,\n      handleWheelClick,\n    ]\n  );\n\n  /** Determine if clockwise/counter-clockwise based on the Knob onChange value. */\n  const handleScroll = useCallback(\n    (val: number) => {\n      setCount((currentCount) => {\n        if (val === 5 && currentCount === 100) {\n          handleClockwiseScroll();\n        } else if (val === 100 && currentCount === 5) {\n          handleCounterClockwiseScroll();\n        } else if (val > currentCount) {\n          handleClockwiseScroll();\n        } else if (val < currentCount) {\n          handleCounterClockwiseScroll();\n        }\n        return val;\n      });\n\n      handleResetIdleCheck();\n    },\n    [handleClockwiseScroll, handleCounterClockwiseScroll, handleResetIdleCheck]\n  );\n\n  useEventListener('keydown', handleKeyPress);\n\n  /**\n   * Start the countdown for detecting when the user is idle,\n   * in which case we'll show the Now Playing view if music is playing\n   */\n  useEffectOnce(handleResetIdleCheck);\n\n  return (\n    <Knob\n      value={count}\n      min={0}\n      max={100}\n      width={220}\n      height={220}\n      step={5}\n      fgColor=\"transparent\"\n      bgColor={getTheme(deviceTheme).knob.background}\n      thickness={0.6}\n      onClick={handleCenterClick}\n      onLongPress={handleCenterLongPress}\n      onMenuLongPress={handleMenuLongPress}\n      onWheelClick={handleWheelClick}\n      onChange={handleScroll}\n    />\n  );\n};\n\nexport default ScrollWheel;\n","import { useCallback, useEffect, useRef, useState } from 'react';\n\nimport {\n  ActionSheetOptionProps,\n  PopupOptionProps,\n  SelectableListOption,\n} from 'components';\nimport ViewOptions, { NowPlayingView, WINDOW_TYPE } from 'components/views';\nimport { useWindowContext } from 'hooks';\n\nimport { useAudioPlayer, useEffectOnce, useEventListener } from '../';\nimport { IpodEvent } from 'utils/events';\n\n/** Gets the initial index for the scroll position. If there is a selected option,\n * this will initialize our initial scroll position at the selectedOption  */\nconst getInitIndex = (\n  options: SelectableListOption[] = [],\n  selectedOption?: SelectableListOption\n): number => {\n  if (selectedOption) {\n    const selectedOptionIndex = options.findIndex(\n      (option) => option === selectedOption\n    );\n\n    if (selectedOptionIndex > -1) {\n      return selectedOptionIndex;\n    }\n  }\n\n  // Always default to 0 if there isn't a selectedOption\n  // or if the selectedOption wasn't found in the list of options.\n  return 0;\n};\n\n/** Accepts a list of options and will maintain a scroll index capped at the list's length. */\nconst useScrollHandler = (\n  /** This should match the view's viewId (to enable/disable events for hidden views). */\n  id: string,\n  /** A list of all scrollable items. Used to cap the scrolling to the last element. */\n  options: SelectableListOption[] = [],\n  selectedOption?: SelectableListOption\n): [number] => {\n  const { showWindow, windowStack, setPreview } = useWindowContext();\n  const { play } = useAudioPlayer();\n  const [index, setIndex] = useState(getInitIndex(options, selectedOption));\n  const timeoutIdRef = useRef<NodeJS.Timeout>();\n  /** Only fire events on the top-most view. */\n  const isActive = windowStack[windowStack.length - 1].id === id;\n\n  /** Wait until the user stops scrolling to check for a new preview to display. */\n  const handleCheckForPreview = useCallback(\n    (i: number) => {\n      if (timeoutIdRef.current) {\n        clearTimeout(timeoutIdRef.current);\n      }\n      if (!isActive || !options[i]) return;\n      timeoutIdRef.current = setTimeout(() => {\n        const preview = options[i].preview;\n        if (preview) {\n          setPreview(preview);\n        }\n      }, 750);\n\n      return () => {\n        if (timeoutIdRef.current) {\n          clearTimeout(timeoutIdRef.current);\n        }\n      };\n    },\n    [isActive, options, setPreview]\n  );\n\n  const handleForwardScroll = useCallback(() => {\n    if (index < options.length - 1 && isActive) {\n      setIndex(index + 1);\n      handleCheckForPreview(index + 1);\n    }\n  }, [handleCheckForPreview, index, isActive, options.length]);\n\n  const handleBackwardScroll = useCallback(() => {\n    if (index > 0 && isActive) {\n      setIndex(index - 1);\n      handleCheckForPreview(index - 1);\n    }\n  }, [handleCheckForPreview, index, isActive]);\n\n  const handleShowView = useCallback(\n    (\n      id: string,\n      component: React.ReactNode,\n      windowType?: WINDOW_TYPE.FULL | WINDOW_TYPE.SPLIT | WINDOW_TYPE.COVER_FLOW\n    ) => {\n      showWindow({\n        id,\n        type: windowType ?? (ViewOptions[id]?.type as any) ?? WINDOW_TYPE.FULL,\n        component,\n      });\n    },\n    [showWindow]\n  );\n\n  const handleShowPopup = useCallback(\n    (options: PopupOptionProps) => {\n      showWindow({\n        type: WINDOW_TYPE.POPUP,\n        id: options.popupId,\n        title: options.title,\n        description: options.description,\n        listOptions: options.listOptions,\n      });\n    },\n    [showWindow]\n  );\n\n  const handleShowActionSheet = useCallback(\n    (options: ActionSheetOptionProps) => {\n      showWindow({\n        type: WINDOW_TYPE.ACTION_SHEET,\n        id: options.id,\n        listOptions: options.listOptions,\n      });\n    },\n    [showWindow]\n  );\n\n  /** Parses the selected option for a new view to show or song to play. */\n  const handleCenterClick = useCallback(async () => {\n    const option = options[index];\n    if (!isActive || !option) return;\n\n    if (timeoutIdRef.current) {\n      clearTimeout(timeoutIdRef.current);\n    }\n\n    switch (option.type) {\n      case 'Song':\n        await play(option.queueOptions);\n\n        if (option.showNowPlayingView) {\n          handleShowView(ViewOptions.nowPlaying.id, () => <NowPlayingView />);\n        }\n        break;\n      case 'Link':\n        window.open(option.url, '_blank');\n        break;\n      case 'View':\n        handleShowView(option.viewId, option.component, option.windowType);\n        break;\n      case 'Action':\n        option.onSelect();\n        break;\n      case 'Popup':\n        handleShowPopup(option);\n        break;\n      case 'ActionSheet':\n        handleShowActionSheet(option);\n        break;\n    }\n  }, [\n    handleShowActionSheet,\n    handleShowPopup,\n    handleShowView,\n    index,\n    isActive,\n    options,\n    play,\n  ]);\n\n  const handleCenterLongClick = useCallback(async () => {\n    const option = options[index];\n\n    if (!isActive || !option) return;\n\n    if (option.longPressOptions) {\n      showWindow({\n        type: WINDOW_TYPE.ACTION_SHEET,\n        id: ViewOptions.mediaActionSheet.id,\n        listOptions: option.longPressOptions,\n      });\n    }\n  }, [index, isActive, options, showWindow]);\n\n  /** If the list length changes and the index is larger, reset the index to 0. */\n  useEffect(() => {\n    if (options.length && index > options.length - 1) {\n      setIndex(0);\n    }\n  }, [index, options.length]);\n\n  useEffectOnce(() => {\n    if (!options || !options[0]) return;\n\n    const preview = options[0].preview;\n    if (preview) {\n      setPreview(preview);\n    }\n  });\n\n  useEventListener<IpodEvent>('centerclick', handleCenterClick);\n  useEventListener<IpodEvent>('centerlongclick', handleCenterLongClick);\n  useEventListener<IpodEvent>('forwardscroll', handleForwardScroll);\n  useEventListener<IpodEvent>('backwardscroll', handleBackwardScroll);\n\n  return [index];\n};\n\nexport default useScrollHandler;\n","import { createContext, useState } from 'react';\n\nimport { SelectableListOption } from 'components';\nimport { PREVIEW } from 'components/previews';\nimport ViewOptions, * as Views from 'components/views';\n\ntype SharedOptionProps = {\n  id: string;\n  type: Views.WINDOW_TYPE;\n  /** Fire an event when the window closes. */\n  onClose?: (...args: any[]) => void;\n  /** Any extra styles you want to pass to the window. */\n  styles?: Record<string, any>;\n};\n\ntype ListViewOptionProps<TComponent extends React.ComponentType<any> = any> = {\n  /** These window types allow you to pass in a custom component to render. */\n  type:\n    | Views.WINDOW_TYPE.SPLIT\n    | Views.WINDOW_TYPE.FULL\n    | Views.WINDOW_TYPE.COVER_FLOW;\n  /** The React component that will be rendered in the window. */\n  component: TComponent;\n  /** Props that will be passed to the component. */\n  props?: Omit<React.ComponentProps<TComponent>, 'id'>;\n  /** Fire an event when the window closes. */\n  onClose?: (...args: any[]) => void;\n};\n\ntype ActionSheetViewOptionProps = {\n  type: Views.WINDOW_TYPE.ACTION_SHEET;\n  listOptions: SelectableListOption[];\n};\n\ntype PopupViewOptionProps = {\n  type: Views.WINDOW_TYPE.POPUP;\n  title: string;\n  description?: string;\n  listOptions: SelectableListOption[];\n};\n\nexport type WindowOptions<TComponent extends React.ComponentType<any> = any> =\n  SharedOptionProps &\n    (\n      | ListViewOptionProps<TComponent>\n      | ActionSheetViewOptionProps\n      | PopupViewOptionProps\n    );\n\ninterface WindowState {\n  windowStack: WindowOptions[];\n  headerTitle?: string;\n  preview: PREVIEW;\n}\n\ntype WindowContextType = [\n  WindowState,\n  React.Dispatch<React.SetStateAction<WindowState>>\n];\n\nexport const WindowContext = createContext<WindowContextType>([\n  {\n    windowStack: [],\n    headerTitle: 'iPod.js',\n    preview: PREVIEW.MUSIC,\n  },\n  () => {},\n]);\n\ninterface Props {\n  children: React.ReactChild;\n}\n\nconst WindowProvider = ({ children }: Props) => {\n  const windowStack: WindowOptions[] = [\n    {\n      id: ViewOptions.home.id,\n      type: Views.WINDOW_TYPE.SPLIT,\n      component: Views.HomeView,\n    },\n  ];\n  const [windowState, setWindowState] = useState<WindowState>({\n    windowStack,\n    headerTitle: ViewOptions.home.title,\n    preview: PREVIEW.MUSIC,\n  });\n\n  return (\n    <WindowContext.Provider value={[windowState, setWindowState]}>\n      {children}\n    </WindowContext.Provider>\n  );\n};\n\nexport default WindowProvider;\n","import { useCallback, useContext } from 'react';\n\nimport { PREVIEW } from 'components/previews';\nimport ViewOptions from 'components/views';\nimport { WindowContext, WindowOptions } from 'providers/WindowProvider';\n\nexport interface WindowContextHook {\n  /** Push an instance of WindowOptions to the windowStack. */\n  showWindow: (window: WindowOptions) => void;\n  /** Given an id, remove the window from the stack (otherwise, pop the top window). */\n  hideWindow: (id?: string) => void;\n  /** Removes all windows except the first from the windowStack. */\n  resetWindows: () => void;\n  /** Returns an array of WindowOptions. */\n  windowStack: WindowOptions[];\n  /** Checks if the current window's id matches the given id.\n   * Useful for enabling/disabling scrolling if a window is hidden.\n   */\n  headerTitle?: string;\n  preview: PREVIEW;\n  isWindowActive: (id: string) => boolean;\n  setHeaderTitle: (title?: string) => void;\n  setPreview: (preview: PREVIEW) => void;\n}\n\n/**\n * This hook allows any component to access three parameters:\n *   1. showWindow\n *   2. hideWindow\n *   3. windowStack\n *\n *   Use it whenever you want to open a new window (@type WindowOptions).\n *\n *    @example\n *    `const {showWindow, hideWindow, windowStack} = useWindowContext();`\n */\nexport const useWindowContext = (): WindowContextHook => {\n  const [windowState, setWindowState] = useContext(WindowContext);\n\n  const showWindow = useCallback(\n    (window: WindowOptions) => {\n      setWindowState((prevWindowState) => ({\n        ...prevWindowState,\n        windowStack: [...prevWindowState.windowStack, window],\n        headerTitle: ViewOptions[window.id].title,\n      }));\n    },\n    [setWindowState]\n  );\n\n  const hideWindow = useCallback(\n    (id?: string) => {\n      if (windowState.windowStack.length === 1) return;\n      setWindowState((prevWindowState) => {\n        const newWindowStack = id\n          ? prevWindowState.windowStack.filter(\n              (window: WindowOptions) => window.id !== id\n            )\n          : prevWindowState.windowStack.slice(0, -1);\n\n        return {\n          ...prevWindowState,\n          windowStack: newWindowStack,\n          headerTitle:\n            ViewOptions[newWindowStack[newWindowStack.length - 1].id].title,\n        };\n      });\n    },\n    [setWindowState, windowState.windowStack.length]\n  );\n\n  const resetWindows = useCallback(() => {\n    setWindowState((prevState) => ({\n      ...prevState,\n      windowStack: prevState.windowStack.slice(0, 1),\n    }));\n  }, [setWindowState]);\n\n  const isWindowActive = useCallback(\n    (id: string) => {\n      const { windowStack } = windowState;\n      const curWindow = windowStack[windowStack.length - 1];\n      return curWindow.id === id;\n    },\n    [windowState]\n  );\n\n  const setHeaderTitle = useCallback(\n    (title?: string) => {\n      setWindowState((prevState) => ({\n        ...prevState,\n        headerTitle: title,\n      }));\n    },\n    [setWindowState]\n  );\n\n  const setPreview = useCallback(\n    (preview: PREVIEW) => {\n      setWindowState((prevState) => ({\n        ...prevState,\n        preview,\n      }));\n    },\n    [setWindowState]\n  );\n\n  return {\n    showWindow,\n    hideWindow,\n    resetWindows,\n    isWindowActive,\n    windowStack: windowState.windowStack,\n    headerTitle: windowState.headerTitle,\n    preview: windowState.preview,\n    setHeaderTitle,\n    setPreview,\n  };\n};\n\nexport default useWindowContext;\n","import { API_URL } from 'hooks';\n\nconst ACCESS_TOKEN_KEY = 'spotify_access_token';\nconst REFRESH_TOKEN_KEY = 'spotify_refresh_token';\nconst TOKEN_TIMESTAMP_KEY = 'spotify_token_timestamp';\n\nexport type TokenResponse = {\n  accessToken?: string;\n  refreshToken?: string;\n  /** The user has signed in for the first time. */\n  isNew?: boolean;\n};\n\n/** Determines if an access token has been saved at a prior time,\n * and if so, attempts to refresh the token. If no prior tokens\n * have been set, fetch a brand new one and save it to localStorage.\n */\nexport const getTokens = async (): Promise<TokenResponse> => {\n  const { storedAccessToken, storedRefreshToken } = getExistingTokens();\n\n  if (!storedAccessToken || !storedRefreshToken) {\n    return _getNewTokens();\n  }\n\n  if (_shouldRefreshTokens()) {\n    return _getRefreshedTokens(storedRefreshToken);\n  }\n\n  return {\n    accessToken: storedAccessToken,\n    refreshToken: storedRefreshToken,\n  };\n};\n\nexport const getExistingTokens = () => {\n  const storedAccessToken = localStorage.getItem(ACCESS_TOKEN_KEY) ?? undefined;\n  const storedRefreshToken =\n    localStorage.getItem(REFRESH_TOKEN_KEY) ?? undefined;\n\n  return {\n    storedAccessToken,\n    storedRefreshToken,\n  };\n};\n\nexport const removeExistingTokens = () => {\n  localStorage.removeItem(ACCESS_TOKEN_KEY);\n  localStorage.removeItem(REFRESH_TOKEN_KEY);\n  localStorage.removeItem(TOKEN_TIMESTAMP_KEY);\n};\n\n/** Accepts a refresh token and returns a fresh access token.\n * Valid for 1 hour, at which point the token will expire.\n */\nconst _getRefreshedTokens = async (\n  storedRefreshToken: string\n): Promise<TokenResponse> => {\n  try {\n    const response = await fetch(\n      `${API_URL}/refresh_token?refresh_token=${storedRefreshToken}`,\n      {\n        credentials: 'same-origin',\n        mode: 'cors',\n      }\n    );\n\n    const { access_token: accessToken } = await response.json();\n\n    console.log('Got refreshed tokens:', { accessToken, storedRefreshToken });\n\n    _saveTokens(accessToken, storedRefreshToken);\n\n    return { accessToken, refreshToken: storedRefreshToken };\n  } catch (error) {\n    console.error('Error fetchinng refresh token:', { error });\n  }\n\n  return {\n    accessToken: undefined,\n    refreshToken: undefined,\n  };\n};\n\n/** Accepts a `code` and `state` generated from spotify user authorization,\n * and attempts to fetch a new access and refresh token.\n * Valid for 1 hour, at which point the access token will expire.\n */\nconst _getNewTokens = async (): Promise<TokenResponse> => {\n  const url = new URL(window.document.URL);\n  const urlParams = url.searchParams;\n  const code = urlParams.get('code') ?? undefined;\n  const state = urlParams.get('state') ?? undefined;\n\n  if (!code || !state) {\n    return {};\n  }\n\n  try {\n    const response = await fetch(\n      `${API_URL}/callback?state=${state}&code=${code}`,\n      {\n        credentials: 'same-origin',\n        mode: 'cors',\n      }\n    );\n\n    const { accessToken, refreshToken } = await response.json();\n\n    _saveTokens(accessToken, refreshToken);\n\n    urlParams.delete('code');\n    urlParams.delete('state');\n\n    window.history.replaceState({}, '', url.toString());\n\n    return {\n      accessToken,\n      refreshToken,\n      // The user signed in for the first time. We will set the current streaming service to Spotify\n      isNew: true,\n    };\n  } catch (error) {\n    console.error('error fetching token:', { error });\n  }\n\n  return {\n    accessToken: undefined,\n    refreshToken: undefined,\n  };\n};\n\n/** Checks the last time an access token was requested.\n * If a token has never been requested, return true.\n * If the last refresh was > 30 minutes ago, return true.\n */\nconst _shouldRefreshTokens = () => {\n  const lastRefreshTimestamp = parseInt(\n    localStorage.getItem(TOKEN_TIMESTAMP_KEY) ?? ''\n  );\n  const now = Date.now();\n\n  if (!lastRefreshTimestamp) {\n    return true;\n  }\n\n  //Gets the time difference in minutes.\n  const minuteDiff = Math.round((now - lastRefreshTimestamp) / 1000 / 60);\n  console.log(`Last token refresh: ${minuteDiff} minutes ago`);\n\n  return minuteDiff > 30;\n};\n\nconst _saveTokens = (accessToken?: string, refreshToken?: string) => {\n  if (!accessToken || !refreshToken) {\n    console.error('Error: Attempting to save undefined tokens:', {\n      accessToken,\n      refreshToken,\n    });\n\n    return;\n  }\n\n  localStorage.setItem(ACCESS_TOKEN_KEY, accessToken);\n  localStorage.setItem(REFRESH_TOKEN_KEY, refreshToken);\n  localStorage.setItem(TOKEN_TIMESTAMP_KEY, `${Date.now()}`);\n};\n","import {\n  createContext,\n  memo,\n  useCallback,\n  useContext,\n  useRef,\n  useState,\n} from 'react';\n\nimport ViewOptions, { WINDOW_TYPE } from 'components/views';\nimport { useWindowContext } from 'hooks';\nimport * as Utils from 'utils';\nimport * as SpotifyUtils from 'utils/spotify';\n\nimport { useEffectOnce, useSettings } from '../';\n\nexport const API_URL = 'https://b7d1fdb16506.ngrok.io';\n\nexport interface SpotifySDKState {\n  isMounted: boolean;\n  spotifyPlayer: Spotify.Player;\n  accessToken?: string;\n  deviceId?: string;\n}\n\nexport const SpotifySDKContext = createContext<SpotifySDKState>({} as any);\n\nexport type SpotifySDKHook = SpotifySDKState & {\n  signIn: () => void;\n  signOut: () => void;\n};\n\nexport const useSpotifySDK = (): SpotifySDKHook => {\n  const {\n    isSpotifyAuthorized,\n    setIsSpotifyAuthorized,\n    isAppleAuthorized,\n    setService,\n  } = useSettings();\n  const { showWindow } = useWindowContext();\n  const state = useContext(SpotifySDKContext);\n\n  /**\n   * Open the Spotify OAuth login page. Once authenticated, the user will be\n   * redirected back to the app.\n   */\n  const signIn = useCallback(() => {\n    if (!state.isMounted) {\n      showWindow({\n        type: WINDOW_TYPE.POPUP,\n        id: ViewOptions.spotifyNotSupportedPopup.id,\n        title: ViewOptions.spotifyNotSupportedPopup.title,\n        description:\n          'Spotify sadly only supports web playback on Chrome (desktop)',\n        listOptions: [\n          {\n            type: 'Action',\n            label: 'Okay 😞',\n            onSelect: () => {},\n          },\n        ],\n      });\n      return;\n    }\n\n    if (!isSpotifyAuthorized) {\n      window.open(\n        `${API_URL}/${Utils.isDev() ? 'login_dev' : 'login'}`,\n        '_self'\n      );\n    } else {\n      setService('spotify');\n    }\n  }, [isSpotifyAuthorized, setService, showWindow, state.isMounted]);\n\n  const signOut = useCallback(() => {\n    state.spotifyPlayer.disconnect();\n    setIsSpotifyAuthorized(false);\n\n    SpotifyUtils.removeExistingTokens();\n\n    // Change to apple music if available.\n    if (isAppleAuthorized) {\n      setService('apple');\n    } else {\n      setService(undefined);\n    }\n  }, [\n    isAppleAuthorized,\n    setIsSpotifyAuthorized,\n    setService,\n    state.spotifyPlayer,\n  ]);\n\n  return {\n    ...state,\n    signIn,\n    signOut,\n  };\n};\n\ninterface Props {\n  children: React.ReactNode;\n}\n\nexport const SpotifySDKProvider = ({ children }: Props) => {\n  const { setIsSpotifyAuthorized, setService } = useSettings();\n  const [token, setToken] = useState<string>();\n  const [deviceId, setDeviceId] = useState<string>();\n  const spotifyPlayerRef = useRef<Spotify.Player | undefined>();\n  const [isMounted, setIsMounted] = useState(false);\n\n  /** Fetch access tokens and, if successful, then set up the playback sdk. */\n  const handleMount = useCallback(async () => {\n    const { accessToken, refreshToken, isNew } = await SpotifyUtils.getTokens();\n    setIsMounted(true);\n\n    if (accessToken && refreshToken) {\n      setToken(accessToken);\n\n      const player = new window.Spotify.Player({\n        name: 'iPod Classic',\n        getOAuthToken: async (cb: (token: string) => void) => {\n          const { storedAccessToken } = SpotifyUtils.getExistingTokens();\n\n          if (!storedAccessToken) {\n            console.error(\"ERROR: Didn't find stored access token\");\n            return;\n          }\n\n          cb(storedAccessToken);\n        },\n      });\n\n      player.addListener('ready', ({ device_id }: any) => {\n        console.log({ device_id });\n        setDeviceId(device_id);\n        setIsSpotifyAuthorized(true);\n      });\n\n      player.addListener('authentication_error', ({ message }) => {\n        console.error(`Spotify authentication error: ${message}`);\n        setIsSpotifyAuthorized(false);\n      });\n\n      player.addListener('playback_error', ({ message }) => {\n        console.error(message);\n      });\n\n      player.connect();\n\n      spotifyPlayerRef.current = player;\n\n      /** The user has just signed in; configure the app to use Spotify. */\n      if (isNew) {\n        setService('spotify');\n      }\n    }\n  }, [setIsSpotifyAuthorized, setService]);\n\n  useEffectOnce(() => {\n    window.onSpotifyWebPlaybackSDKReady = handleMount;\n  });\n\n  return (\n    <SpotifySDKContext.Provider\n      value={{\n        spotifyPlayer: spotifyPlayerRef.current ?? ({} as Spotify.Player),\n        accessToken: token,\n        deviceId,\n        isMounted,\n      }}\n    >\n      {children}\n    </SpotifySDKContext.Provider>\n  );\n};\n\nexport default memo(SpotifySDKProvider);\n","import { useCallback } from 'react';\n\nimport { useSpotifySDK } from 'hooks';\nimport * as ConversionUtils from 'utils/conversion';\n\ntype FetchSpotifyApiArgs = {\n  endpoint: string;\n  accessToken?: string;\n  onError: (error: any) => void;\n};\n\nconst fetchSpotifyApi = async <TSpotifyApiType extends object>({\n  endpoint,\n  accessToken,\n  onError,\n}: FetchSpotifyApiArgs) => {\n  try {\n    if (!accessToken) {\n      throw new Error('Provide a Spotify API Access token');\n    }\n\n    const res = await fetch(`https://api.spotify.com/v1/${endpoint}`, {\n      headers: { Authorization: `Bearer ${accessToken}` },\n    });\n    return (await res.json()) as TSpotifyApiType;\n  } catch (error) {\n    onError(error);\n  }\n};\n\nconst useSpotifyDataFetcher = () => {\n  const { accessToken } = useSpotifySDK();\n\n  const fetchAlbums = useCallback(async () => {\n    const response = await fetchSpotifyApi<SpotifyApi.UsersSavedAlbumsResponse>(\n      {\n        endpoint: `me/albums?limit=50`,\n        accessToken,\n        onError: (error) => {\n          throw new Error(error);\n        },\n      }\n    );\n\n    if (response) {\n      return response.items.map((item) =>\n        ConversionUtils.convertSpotifyAlbumFull(item.album)\n      );\n    }\n  }, [accessToken]);\n\n  const fetchAlbum = useCallback(\n    async (userId = '', id: string) => {\n      const response = await fetchSpotifyApi<SpotifyApi.SingleAlbumResponse>({\n        endpoint: `albums/${id}`,\n        accessToken,\n        onError: (error) => {\n          throw new Error(error);\n        },\n      });\n\n      if (response) {\n        return ConversionUtils.convertSpotifyAlbumFull(response);\n      }\n    },\n    [accessToken]\n  );\n\n  const fetchArtists = useCallback(async () => {\n    const response =\n      await fetchSpotifyApi<SpotifyApi.UsersFollowedArtistsResponse>({\n        endpoint: `me/following?type=artist&limit=50`,\n        accessToken,\n        onError: (error) => {\n          throw new Error(error);\n        },\n      });\n\n    return response?.artists?.items.map(\n      ConversionUtils.convertSpotifyArtistFull\n    );\n  }, [accessToken]);\n\n  const fetchArtist = useCallback(\n    async (userId = '', id: string) => {\n      const response = await fetchSpotifyApi<SpotifyApi.ArtistsAlbumsResponse>({\n        endpoint: `artists/${id}/albums`,\n        accessToken,\n        onError: (error) => {\n          throw new Error(error);\n        },\n      });\n\n      if (response) {\n        return response.items.map(\n          ConversionUtils.convertSpotifyAlbumSimplified\n        );\n      }\n    },\n    [accessToken]\n  );\n\n  const fetchPlaylists = useCallback(async () => {\n    const response =\n      await fetchSpotifyApi<SpotifyApi.ListOfCurrentUsersPlaylistsResponse>({\n        endpoint: 'me/playlists?limit=50',\n        accessToken,\n        onError: (error) => {\n          throw new Error(error);\n        },\n      });\n\n    return response?.items?.map(\n      ConversionUtils.convertSpotifyPlaylistSimplified\n    );\n  }, [accessToken]);\n\n  const fetchPlaylist = useCallback(\n    async (userId = '', id: string) => {\n      const response = await fetchSpotifyApi<SpotifyApi.PlaylistObjectFull>({\n        endpoint: `users/${userId}/playlists/${id}`,\n        accessToken,\n        onError: (error) => {\n          throw new Error(error);\n        },\n      });\n\n      if (response) {\n        return ConversionUtils.convertSpotifyPlaylistFull(response);\n      }\n    },\n    [accessToken]\n  );\n\n  return {\n    fetchAlbums,\n    fetchAlbum,\n    fetchArtists,\n    fetchArtist,\n    fetchPlaylists,\n    fetchPlaylist,\n  };\n};\n\nexport default useSpotifyDataFetcher;\n","import { createContext, memo, useCallback, useContext, useState } from 'react';\nimport {DeviceTheme} from \"../../utils/themes\";\n\ntype StreamingService = 'apple' | 'spotify';\n\nexport const SELECTED_SERVICE_KEY = 'ipodSelectedService';\nexport const DEVICE_COLOR_KEY = 'ipodSelectedDeviceTheme';\nexport const VOLUME_KEY = 'ipodVolume';\n\nexport interface SettingsState {\n  service?: StreamingService;\n  isSpotifyAuthorized: boolean;\n  isAppleAuthorized: boolean;\n  deviceTheme: DeviceTheme;\n}\n\ntype SettingsContextType = [\n  SettingsState,\n  React.Dispatch<React.SetStateAction<SettingsState>>\n];\n\nexport const SettingsContext = createContext<SettingsContextType>([\n  {} as any,\n  () => {},\n]);\n\nexport type SettingsHook = SettingsState & {\n  isAuthorized: boolean;\n  setIsSpotifyAuthorized: (val: boolean) => void;\n  setIsAppleAuthorized: (val: boolean) => void;\n  setService: (service?: StreamingService) => void;\n  setDeviceTheme: (deviceTheme: DeviceTheme) => void;\n};\n\nexport const useSettings = (): SettingsHook => {\n  const [state, setState] = useContext(SettingsContext);\n\n  const setIsSpotifyAuthorized = useCallback(\n    (val: boolean) =>\n      setState((prevState) => ({\n        ...prevState,\n        isSpotifyAuthorized: val,\n      })),\n    [setState]\n  );\n\n  const setIsAppleAuthorized = useCallback(\n    (val: boolean) =>\n      setState((prevState) => ({\n        ...prevState,\n        isAppleAuthorized: val,\n      })),\n    [setState]\n  );\n\n  const setService = useCallback(\n    (service?: StreamingService) => {\n      setState((prevState) => ({\n        ...prevState,\n        service,\n      }));\n\n      if (service) {\n        localStorage.setItem(SELECTED_SERVICE_KEY, service);\n      } else {\n        localStorage.removeItem(SELECTED_SERVICE_KEY);\n      }\n    },\n    [setState]\n  );\n\n  const setDeviceTheme = useCallback(\n    (deviceTheme: DeviceTheme) => {\n      setState((prevState) => ({ ...prevState, deviceTheme }));\n      localStorage.setItem(DEVICE_COLOR_KEY, deviceTheme);\n    },\n    [setState]\n  );\n\n  return {\n    ...state,\n    isAuthorized: state.isAppleAuthorized || state.isSpotifyAuthorized,\n    setIsSpotifyAuthorized,\n    setIsAppleAuthorized,\n    setService,\n    setDeviceTheme,\n  };\n};\n\ninterface Props {\n  children: React.ReactNode;\n}\n\nexport const SettingsProvider = memo(({ children }: Props) => {\n  const [settingsState, setSettingsState] = useState<SettingsState>({\n    isAppleAuthorized: false,\n    isSpotifyAuthorized: false,\n    service:\n      (localStorage.getItem(SELECTED_SERVICE_KEY) as StreamingService) ??\n      undefined,\n    deviceTheme:\n      (localStorage.getItem(DEVICE_COLOR_KEY) as DeviceTheme) ?? 'silver',\n  });\n\n  return (\n    <SettingsContext.Provider value={[settingsState, setSettingsState]}>\n      {children}\n    </SettingsContext.Provider>\n  );\n});\n\nexport default useSettings;\n","import { useCallback, useEffect, useState } from 'react';\n\nimport { useMKDataFetcher, useSettings, useSpotifyDataFetcher } from 'hooks';\n\ninterface UserLibraryProps {\n  inLibrary?: boolean;\n  userId?: string;\n}\n\ninterface CommonFetcherProps {\n  name: string;\n}\n\ninterface PlaylistsFetcherProps {\n  name: 'playlists';\n}\n\ninterface PlaylistFetcherProps extends UserLibraryProps {\n  name: 'playlist';\n  id: string;\n}\n\ninterface AlbumsFetcherProps {\n  name: 'albums';\n  artworkSize?: number;\n}\n\ninterface AlbumFetcherProps extends UserLibraryProps {\n  name: 'album';\n  id: string;\n}\n\ninterface ArtistsFetcherProps {\n  name: 'artists';\n}\n\ninterface ArtistFetcherProps extends UserLibraryProps {\n  name: 'artist';\n  id: string;\n  artworkSize?: number;\n}\n\ntype Props = CommonFetcherProps &\n  (\n    | PlaylistsFetcherProps\n    | PlaylistFetcherProps\n    | AlbumsFetcherProps\n    | AlbumFetcherProps\n    | ArtistsFetcherProps\n    | ArtistFetcherProps\n  );\n\nconst useDataFetcher = <TType extends object>(props: Props) => {\n  const spotifyDataFetcher = useSpotifyDataFetcher();\n  const appleDataFetcher = useMKDataFetcher();\n  const { service, isAppleAuthorized, isSpotifyAuthorized } = useSettings();\n  const [isLoading, setIsLoading] = useState(true);\n  const [hasError, setHasError] = useState(false);\n  const [data, setData] = useState<TType>();\n  const [isMounted, setIsMounted] = useState(false);\n\n  const fetchAlbums = useCallback(async () => {\n    let albums: IpodApi.Album[] | undefined;\n\n    if (service === 'apple') {\n      albums = await appleDataFetcher.fetchAlbums();\n    } else if (service === 'spotify') {\n      albums = await spotifyDataFetcher.fetchAlbums();\n    }\n\n    setData(albums as TType);\n    setIsLoading(false);\n  }, [appleDataFetcher, service, spotifyDataFetcher]);\n\n  const fetchAlbum = useCallback(\n    async (options: AlbumFetcherProps) => {\n      let album: IpodApi.Album | undefined;\n\n      if (service === 'apple') {\n        album = await appleDataFetcher.fetchAlbum(\n          options.id,\n          options.inLibrary\n        );\n      } else if (service === 'spotify') {\n        album = await spotifyDataFetcher.fetchAlbum(options.userId, options.id);\n      }\n\n      setData(album as TType);\n      setIsLoading(false);\n    },\n    [appleDataFetcher, service, spotifyDataFetcher]\n  );\n\n  const fetchArtists = useCallback(async () => {\n    let artists: IpodApi.Artist[] | undefined;\n\n    if (service === 'apple') {\n      artists = await appleDataFetcher.fetchArtists();\n    } else if (service === 'spotify') {\n      artists = await spotifyDataFetcher.fetchArtists();\n    }\n    setData(artists as TType);\n    setIsLoading(false);\n  }, [appleDataFetcher, service, spotifyDataFetcher]);\n\n  const fetchArtistAlbums = useCallback(\n    async (options: ArtistFetcherProps) => {\n      let albums: IpodApi.Album[] | undefined;\n\n      if (service === 'apple') {\n        albums = await appleDataFetcher.fetchArtistAlbums(\n          options.id,\n          options.inLibrary\n        );\n      } else if (service === 'spotify') {\n        albums = await spotifyDataFetcher.fetchArtist(\n          options.userId,\n          options.id\n        );\n      }\n\n      setData(albums as TType);\n      setIsLoading(false);\n    },\n    [appleDataFetcher, service, spotifyDataFetcher]\n  );\n\n  const fetchPlaylists = useCallback(async () => {\n    let playlists: IpodApi.Playlist[] | undefined;\n\n    if (service === 'apple') {\n      playlists = await appleDataFetcher.fetchPlaylists();\n    } else if (service === 'spotify') {\n      playlists = await spotifyDataFetcher.fetchPlaylists();\n    }\n\n    setData(playlists as TType);\n    setIsLoading(false);\n  }, [appleDataFetcher, service, spotifyDataFetcher]);\n\n  const fetchPlaylist = useCallback(\n    async (options: PlaylistFetcherProps) => {\n      let playlist: IpodApi.Playlist | undefined;\n\n      if (service === 'apple') {\n        playlist = await appleDataFetcher.fetchPlaylist(\n          options.id,\n          options.inLibrary\n        );\n      } else if (service === 'spotify') {\n        playlist = await spotifyDataFetcher.fetchPlaylist(\n          options.userId,\n          options.id\n        );\n      }\n      setData(playlist as TType);\n      setIsLoading(false);\n    },\n    [appleDataFetcher, service, spotifyDataFetcher]\n  );\n\n  const handleMount = useCallback(async () => {\n    setHasError(false);\n    setIsLoading(true);\n\n    switch (props.name) {\n      case 'albums':\n        await fetchAlbums();\n        break;\n      case 'album':\n        await fetchAlbum(props);\n        break;\n      case 'artists':\n        await fetchArtists();\n        break;\n      case 'artist':\n        await fetchArtistAlbums(props);\n        break;\n      case 'playlists':\n        await fetchPlaylists();\n        break;\n      case 'playlist':\n        await fetchPlaylist(props);\n        break;\n    }\n\n    setIsMounted(true);\n  }, [\n    fetchAlbum,\n    fetchAlbums,\n    fetchArtistAlbums,\n    fetchArtists,\n    fetchPlaylist,\n    fetchPlaylists,\n    props,\n  ]);\n\n  useEffect(() => {\n    if (\n      !isMounted &&\n      ((service === 'apple' && isAppleAuthorized) ||\n        (service === 'spotify' && isSpotifyAuthorized))\n    ) {\n      handleMount();\n    } else {\n      setIsLoading(false);\n    }\n  }, [handleMount, isAppleAuthorized, isMounted, isSpotifyAuthorized, service]);\n\n  return {\n    isLoading,\n    data,\n    hasError,\n  };\n};\n\nexport default useDataFetcher;\n","import { useEffect } from 'react';\n\n/**\n * Run an effect only once upon component mount/unmount.\n */\nconst useEffectOnce = (effect: React.EffectCallback) =>\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  useEffect(effect, []);\n\nexport default useEffectOnce;\n","import { useEffect, useRef } from 'react';\n\nconst useInterval = (callback: (...args: any) => any, delay: number) => {\n  const savedCallback = useRef<any>();\n\n  // Remember the latest callback.\n  useEffect(() => {\n    savedCallback.current = callback;\n  }, [callback]);\n\n  // Set up the interval.\n  useEffect(() => {\n    const tick = () => {\n      savedCallback.current();\n    };\n    if (delay !== null) {\n      let id = setInterval(tick, delay);\n      return () => clearInterval(id);\n    }\n  }, [delay]);\n};\n\nexport default useInterval;\n","import { useCallback, useEffect, useRef } from 'react';\n\n// React hook for delaying calls with time\n// returns callback to use for cancelling\n\nconst useTimeout = (\n  callback: () => void, // function to call. No args passed.\n  // if you create a new callback each render, then previous callback will be cancelled on render.\n  timeout: number = 0 // delay, ms (default: immediately put into JS Event Queue)\n): (() => void) => {\n  const timeoutIdRef = useRef<any>();\n\n  const cancel = useCallback(() => {\n    const timeoutId = timeoutIdRef.current;\n    if (timeoutId) {\n      timeoutIdRef.current = undefined;\n      clearTimeout(timeoutId);\n    }\n  }, [timeoutIdRef]);\n\n  useEffect(() => {\n    timeoutIdRef.current = setTimeout(callback, timeout);\n    return cancel;\n  }, [callback, timeout, cancel]);\n\n  return cancel;\n};\n\nexport default useTimeout;\n","import styled, { css } from 'styled-components';\nimport { Unit } from 'utils/constants';\n\nimport { SelectableListOption } from './';\n\nconst LabelContainer = styled.div`\n  flex: 1;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: ${Unit.MD};\n`;\n\nconst Label = styled.h3`\n  margin: 0;\n  padding: ${Unit.XXS};\n  font-size: 14px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\n\nconst Sublabel = styled(Label)`\n  padding: 0 ${Unit.XXS} ${Unit.XXS};\n  margin-top: -4px;\n  font-weight: normal;\n  font-size: 12px;\n  color: rgb(100, 100, 100);\n`;\n\nconst Container = styled.div<{ isActive?: boolean }>`\n  display: flex;\n  align-items: center;\n  overflow: auto;\n\n  ${(props) =>\n    props.isActive &&\n    css`\n      ${LabelContainer} {\n        padding-right: 0;\n      }\n\n      ${Label}, ${Sublabel} {\n        color: white;\n      }\n      background: linear-gradient(rgb(60, 184, 255) 0%, rgb(52, 122, 181) 100%);\n    `};\n`;\n\nconst Image = styled.img`\n  height: 3rem;\n  width: 3rem;\n  margin-right: ${Unit.XXS};\n`;\n\nconst Icon = styled.img`\n  margin-left: auto;\n`;\n\ninterface Props {\n  option: SelectableListOption;\n  isActive: boolean;\n}\n\nconst SelectableListItem = ({ option, isActive }: Props) => {\n  return (\n    <Container isActive={isActive}>\n      {option.imageUrl && <Image src={option.imageUrl} />}\n      <LabelContainer>\n        <Label>{option.label}</Label>\n        {option.sublabel && <Sublabel>{option.sublabel}</Sublabel>}\n      </LabelContainer>\n      {isActive && <Icon src=\"arrow_right.svg\" />}\n    </Container>\n  );\n};\n\nexport default SelectableListItem;\n","import { useEffect, useRef, useState } from 'react';\n\nimport { LoadingScreen } from 'components';\nimport ErrorScreen from 'components/ErrorScreen';\nimport { PREVIEW } from 'components/previews';\nimport { WINDOW_TYPE } from 'components/views';\nimport { AnimatePresence } from 'framer-motion';\nimport { useTimeout } from 'hooks';\nimport styled from 'styled-components';\n\nimport SelectableListItem from './SelectableListItem';\n\nexport const getConditionalOption = (\n  condition?: boolean,\n  option?: SelectableListOption\n) => (option && condition ? [option] : []);\n\nexport type SelectableListOptionType =\n  | 'View'\n  | 'Link'\n  | 'Song'\n  | 'Action'\n  | 'ActionSheet'\n  | 'Popup';\n\ntype SharedOptionProps = {\n  type?: SelectableListOptionType;\n  label: string;\n  isSelected?: boolean;\n  sublabel?: string;\n  preview?: PREVIEW;\n  imageUrl?: string;\n  longPressOptions?: SelectableListOption[];\n};\n\ntype ViewOptionProps = {\n  type: 'View';\n  /** A unique identifier for the next screen. */\n  viewId: string;\n  /** The component that will be displayed in the next view. */\n  component: React.ReactNode;\n  /** Whether to display the default full size view, split view, or in some cases Cover Flow View. */\n  windowType?: WINDOW_TYPE.SPLIT | WINDOW_TYPE.FULL | WINDOW_TYPE.COVER_FLOW;\n};\n\ntype LinkOptionProps = {\n  type: 'Link';\n  url: string;\n};\n\ntype SongOptionProps = {\n  type: 'Song';\n  /** Options that will be used to fetch and play a song. */\n  queueOptions: IpodApi.QueueOptions;\n  /**\n   * Show the Now Playing view after starting the song.\n   * @default false\n   */\n  showNowPlayingView?: boolean;\n};\n\ntype ActionOptionProps = {\n  type: 'Action';\n  onSelect: () => void;\n};\n\nexport type PopupOptionProps = {\n  type: 'Popup';\n  /** A unique identifier for the popup. */\n  popupId: string;\n  listOptions: SelectableListOption[];\n  title: string;\n  description?: string;\n};\n\nexport type ActionSheetOptionProps = {\n  type: 'ActionSheet';\n  /** A unique identifier for the action sheet. */\n  id: string;\n  listOptions: SelectableListOption[];\n};\n\n/** Depending on the option type, certain properties will be available. */\nexport type SelectableListOption = SharedOptionProps &\n  (\n    | ViewOptionProps\n    | LinkOptionProps\n    | SongOptionProps\n    | ActionOptionProps\n    | ActionSheetOptionProps\n    | PopupOptionProps\n  );\n\nconst Container = styled.div`\n  width: 100%;\n  overflow: auto;\n  -webkit-overflow-scrolling: touch;\n`;\n\ninterface Props {\n  options: SelectableListOption[];\n  activeIndex: number;\n  loading?: boolean;\n  emptyMessage?: string;\n}\n\nconst SelectableList = ({\n  options,\n  activeIndex,\n  loading,\n  emptyMessage = 'Nothing to see here',\n}: Props) => {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [isMounted, setIsMounted] = useState(false);\n\n  useTimeout(() => setIsMounted(true), 350);\n\n  /** Always make sure the selected item is within the screen's view. */\n  useEffect(() => {\n    // Delay \"isMounted\" so that the enter animation doesn't get interrupted.\n    // I was stuck on this for like 12 hours and was wondering why\n    // the animation wasn't finishing...\n    if (isMounted && containerRef.current && options.length) {\n      const { children } = containerRef.current;\n      children[activeIndex]?.scrollIntoView({\n        block: 'nearest',\n      });\n    }\n  }, [activeIndex, isMounted, options.length]);\n\n  return (\n    <AnimatePresence>\n      {loading ? (\n        <LoadingScreen backgroundColor=\"white\" />\n      ) : options.length > 0 ? (\n        <Container ref={containerRef}>\n          {options.map((option, index) => (\n            <SelectableListItem\n              key={`option-${option.label}-${index}`}\n              option={option}\n              isActive={index === activeIndex}\n            />\n          ))}\n        </Container>\n      ) : (\n        <ErrorScreen showImage={false} message={emptyMessage} />\n      )}\n    </AnimatePresence>\n  );\n};\n\nexport default SelectableList;\n","import { useState } from 'react';\n\nimport { useInterval } from 'hooks';\nimport styled, { css } from 'styled-components';\nimport { Unit } from 'utils/constants';\n\nconst RootContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  text-align: center;\n  height: 100%;\n  background: white;\n`;\n\nconst StyledImg = styled.img<{ isHidden: boolean }>`\n  height: 60px;\n  width: 60px;\n  transition: all 0.5s ease-in-out;\n\n  ${({ isHidden }) =>\n    isHidden &&\n    css`\n      opacity: 0;\n    `};\n\n  :last-of-type {\n    margin-top: -60px;\n  }\n`;\n\nconst Title = styled.h3`\n  margin: ${Unit.XS} 0 ${Unit.XXS};\n  font-weight: bold;\n  font-size: 18px;\n`;\n\nconst Text = styled.p`\n  font-size: 14px;\n  margin: 0;\n  max-width: 120px;\n  color: rgb(100, 100, 100);\n`;\n\nconst strings = {\n  title: {\n    apple: 'Apple Music',\n    spotify: 'Spotify',\n  },\n  defaultMessage: 'Sign into view this content',\n};\n\ninterface Props {\n  message?: string;\n}\n\nconst AuthPrompt = ({ message }: Props) => {\n  const [icon, setIcon] = useState<'apple' | 'spotify'>('apple');\n\n  useInterval(\n    () => setIcon((prevState) => (prevState === 'apple' ? 'spotify' : 'apple')),\n    4000\n  );\n\n  return (\n    <RootContainer>\n      <StyledImg\n        isHidden={icon === 'spotify'}\n        alt=\"app_icon\"\n        src=\"apple_music_icon.svg\"\n      />\n      <StyledImg\n        isHidden={icon === 'apple'}\n        alt=\"app_icon\"\n        src=\"spotify_icon.svg\"\n      />\n      <Title>{strings.title[icon]}</Title>\n      <Text>{message ?? strings.defaultMessage}</Text>\n    </RootContainer>\n  );\n};\n\nexport default AuthPrompt;\n","import { useEffect, useState } from 'react';\n\ndeclare global {\n  interface BatteryManager extends EventTarget {\n    charging: boolean;\n    chargingTime: number;\n    dischargingTime: number;\n    level: number;\n  }\n\n  interface Navigator {\n    getBattery?: () => Promise<BatteryManager>;\n  }\n}\n\nconst noop = () => {};\n\n/**\n * Interfaces with the Battery Management API (if available; at present only in Chromium-based browsers)\n * to return the current battery charge level and charging status.\n */\nconst useBattery = () => {\n  const [chargePercent, setChargePercent] = useState<number>(100);\n  const [isCharging, setIsCharging] = useState<boolean>(false);\n\n  useEffect(() => {\n    let detachListeners: () => void = noop;\n\n    const attachListeners = async () => {\n      if (!navigator.getBattery) {\n        return;\n      }\n\n      try {\n        const batteryManager = await navigator.getBattery();\n\n        const onLevelChange = () => {\n          setChargePercent(Math.round(batteryManager.level * 100));\n        };\n\n        const onChargingChange = () => {\n          setIsCharging(batteryManager.charging);\n        };\n\n        batteryManager.addEventListener('levelchange', onLevelChange);\n        batteryManager.addEventListener('chargingchange', onChargingChange);\n\n        onLevelChange();\n        onChargingChange();\n\n        detachListeners = () => {\n          batteryManager.removeEventListener('levelchange', onLevelChange);\n          batteryManager.removeEventListener(\n            'chargingchange',\n            onChargingChange\n          );\n        };\n      } catch (e) {\n        // failed to attach handlers; most likely the request was denied\n      }\n    };\n\n    attachListeners();\n\n    return () => detachListeners();\n  }, [setChargePercent, setIsCharging]);\n\n  return {\n    chargePercent,\n    isCharging,\n  };\n};\n\nexport default useBattery;\n","import { useBattery } from 'hooks/battery';\nimport styled, { css } from 'styled-components';\n\nconst batteryHealthyColor = '#A5E07F';\nconst batteryWarningColor = '#D17F6B';\n\nconst Container = styled.div`\n  width: fit-content;\n  height: 12px;\n  display: flex;\n  align-items: center;\n`;\n\nconst ChargeLevelContainer = styled.div`\n  height: 100%;\n  width: 24px;\n  position: relative;\n  display: flex;\n  border: 1px solid #626262ff;\n  background: #54585b\n    linear-gradient(180deg, transparent 25%, 65%, rgba(255, 255, 255, 0.5));\n`;\n\nconst ChargeLevel = styled.div<{\n  isCharging?: boolean;\n  percent?: number;\n}>`\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n\n  ${({ percent = 100, isCharging = false }) => css`\n    width: ${percent}%;\n    background: ${percent > 20 || isCharging\n        ? batteryHealthyColor\n        : batteryWarningColor}\n      linear-gradient(\n        180deg,\n        transparent 10%,\n        rgba(255, 255, 255, 0.5) 20%,\n        35%,\n        transparent 40%,\n        rgba(0, 0, 0, 0.2) 55%,\n        rgba(0, 0, 0, 0.3) 65%,\n        rgba(0, 0, 0, 0.4) 80%\n      );\n  `};\n`;\n\nconst BatteryCap = styled.div`\n  width: 2px;\n  height: 4px;\n\n  border: 1px solid #626262;\n  border-left: 0;\n  border-radius: 0 1.5px 1.5px 0;\n\n  background: #c4c4c4;\n`;\n\nconst IconContainer = styled.div`\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  /* bump the icons above the charge level */\n  z-index: 1;\n`;\n\nconst StatusIcon = styled.img`\n  opacity: 0.8;\n`;\n\nconst BoltIcon = styled(StatusIcon)`\n  height: 8px;\n`;\n\nconst PlugIcon = styled(StatusIcon)`\n  height: 6px;\n`;\n\ninterface Props {\n  className?: string;\n}\n\nconst BatteryIndicator = ({ className }: Props) => {\n  const { chargePercent, isCharging } = useBattery();\n\n  const clampedChargePercent = chargePercent <= 15 ? 15 : chargePercent;\n\n  const shouldShowPlugIcon = isCharging && chargePercent === 100;\n  const shouldShowBoltIcon = isCharging && chargePercent < 100;\n\n  return (\n    <Container className={className}>\n      <ChargeLevelContainer>\n        <IconContainer>\n          {shouldShowPlugIcon && <PlugIcon src=\"plug.svg\" />}\n          {shouldShowBoltIcon && <BoltIcon src=\"bolt.svg\" />}\n        </IconContainer>\n        <ChargeLevel percent={clampedChargePercent} isCharging={isCharging} />\n      </ChargeLevelContainer>\n\n      {/* decorative cap for an authentic battery experience */}\n      <BatteryCap />\n    </Container>\n  );\n};\n\nexport default BatteryIndicator;\n","import styled from 'styled-components';\n\nconst Container = styled.div`\n  position: relative;\n  display: flex;\n  flex: 1;\n  height: 1em;\n  -webkit-box-reflect: below 0px -webkit-gradient(linear, left top, left bottom, from(transparent), color-stop(60%, transparent), to(rgba(250, 250, 250, 0.1)));\n`;\n\nconst ProgressContainer = styled.div`\n  position: relative;\n  flex: 1;\n  margin: 0 8px;\n`;\n\nconst Gloss = styled.div`\n  position: absolute;\n  width: 100%;\n  background: url('gloss-overlay.svg') repeat-x;\n  background-size: contain;\n  height: 100%;\n`;\n\ninterface ProgressProps {\n  percent: number;\n  transparent?: boolean;\n}\n\nconst Progress = styled.div.attrs((props: ProgressProps) => ({\n  // This is the recommended syntax for when things change often.\n  style: {\n    width: `${props.percent}%`,\n  },\n}))<ProgressProps>`\n  position: relative;\n  height: 100%;\n  background: ${(props) =>\n    !props.transparent && 'url(\"gloss-blue.svg\") repeat-x'};\n  transition: width 0.1s;\n`;\n\n/** The icon that is displayed when scrubbing. */\nconst Diamond = styled.img`\n  position: absolute;\n  height: 100%;\n  right: -8px;\n  filter: brightness(0.85);\n`;\n\ninterface Props {\n  percent: number;\n  isScrubber?: boolean;\n}\n\nconst ProgressBar = ({ percent, isScrubber }: Props) => {\n  return (\n    <Container>\n      <ProgressContainer>\n        <Gloss />\n        <Progress percent={percent} transparent={isScrubber}>\n          {isScrubber && <Diamond src=\"scrubber.svg\" />}\n        </Progress>\n      </ProgressContainer>\n    </Container>\n  );\n};\n\nexport default ProgressBar;\n","import { useCallback, useMemo, useState } from 'react';\n\nimport { useAudioPlayer, useEventListener, useInterval } from 'hooks';\nimport styled from 'styled-components';\nimport { useDebouncedCallback } from 'use-debounce/lib';\nimport { formatTime } from 'utils';\nimport { Unit } from 'utils/constants';\n\nimport ProgressBar from './ProgressBar';\nimport { IpodEvent } from 'utils/events';\n\nconst Container = styled.div`\n  position: relative;\n  display: flex;\n  flex: 1;\n  height: 1em;\n  padding: 0 ${Unit.SM};\n  -webkit-box-reflect: below 0px -webkit-gradient(linear, left top, left bottom, from(transparent), color-stop(60%, transparent), to(rgba(250, 250, 250, 0.1)));\n`;\n\ninterface LabelProps {\n  textAlign: 'left' | 'right';\n}\n\nconst Label = styled.h3<LabelProps>`\n  font-size: 12px;\n  margin: auto 0;\n  width: 30px;\n  text-align: ${(props) => props.textAlign};\n  white-space: nowrap;\n`;\n\ninterface Props {\n  isScrubbing: boolean;\n}\n\nconst Scrubber = ({ isScrubbing }: Props) => {\n  const { playbackInfo, seekToTime } = useAudioPlayer();\n  const { currentTime, duration, isPlaying } = playbackInfo;\n  const [scrubberTime, setScrubberTime] = useState(currentTime);\n  const scrubberPercent = useMemo(\n    () => Math.round((scrubberTime / duration) * 100),\n    [duration, scrubberTime]\n  );\n  const scrubberTimeRemaining = useMemo(\n    () => duration - scrubberTime,\n    [duration, scrubberTime]\n  );\n\n  /** The user is actively scrubbing. We disable the 1s update interval in this case. */\n  const [isActive, setIsActive] = useState(false);\n\n  /** Wait until the user is finished scrubbing before seeking. */\n  const handleSeek = useDebouncedCallback((newTime: number) => {\n    seekToTime(newTime);\n    setIsActive(false);\n  }, 300);\n\n  const scrubForward = useCallback(() => {\n    if (scrubberTime === duration || !isScrubbing) return;\n    const newTime = scrubberTime + 1;\n\n    if (newTime < duration) {\n      setIsActive(true);\n      handleSeek(newTime);\n      setScrubberTime(newTime);\n    }\n  }, [scrubberTime, duration, isScrubbing, handleSeek]);\n\n  const scrubBackward = useCallback(() => {\n    if (scrubberTime === 0 || !isScrubbing) return;\n    const newTime = scrubberTime - 1;\n\n    if (newTime >= 0) {\n      setIsActive(true);\n      handleSeek(newTime);\n      setScrubberTime(newTime);\n    }\n  }, [scrubberTime, handleSeek, isScrubbing]);\n\n  const refresh = useCallback(\n    (force = false) => {\n      if ((!isActive && isPlaying) || force) {\n        setScrubberTime(currentTime);\n      }\n    },\n    [currentTime, isActive, isPlaying]\n  );\n\n  useEventListener<IpodEvent>('forwardscroll', scrubForward);\n  useEventListener<IpodEvent>('backwardscroll', scrubBackward);\n\n  /** Update the progress bar every second. */\n  useInterval(refresh, 1000);\n\n  return (\n    <Container>\n      <Label textAlign=\"left\">{formatTime(scrubberTime)}</Label>\n      <ProgressBar percent={scrubberPercent} isScrubber />\n      <Label textAlign=\"right\">-{formatTime(scrubberTimeRemaining)}</Label>\n    </Container>\n  );\n};\n\nexport default Scrubber;\n","import styled from 'styled-components';\n\nconst Svg = styled.svg``;\n\ninterface Props {\n  size?: number;\n  className?: string;\n}\n\nconst LoadingIndicator = ({ size = 24, className }: Props) => {\n  return (\n    <Svg\n      className={className}\n      version=\"1.1\"\n      x=\"0px\"\n      y=\"0px\"\n      viewBox=\"0 0 2400 2400\"\n      width={size}\n      height={size}\n    >\n      <g\n        strokeWidth=\"200\"\n        strokeLinecap=\"round\"\n        stroke=\"#000000\"\n        fill=\"none\"\n        id=\"spinner\"\n      >\n        <line x1=\"1200\" y1=\"600\" x2=\"1200\" y2=\"100\" />\n        <line opacity=\"0.5\" x1=\"1200\" y1=\"2300\" x2=\"1200\" y2=\"1800\" />\n        <line opacity=\"0.917\" x1=\"900\" y1=\"680.4\" x2=\"650\" y2=\"247.4\" />\n        <line opacity=\"0.417\" x1=\"1750\" y1=\"2152.6\" x2=\"1500\" y2=\"1719.6\" />\n        <line opacity=\"0.833\" x1=\"680.4\" y1=\"900\" x2=\"247.4\" y2=\"650\" />\n        <line opacity=\"0.333\" x1=\"2152.6\" y1=\"1750\" x2=\"1719.6\" y2=\"1500\" />\n        <line opacity=\"0.75\" x1=\"600\" y1=\"1200\" x2=\"100\" y2=\"1200\" />\n        <line opacity=\"0.25\" x1=\"2300\" y1=\"1200\" x2=\"1800\" y2=\"1200\" />\n        <line opacity=\"0.667\" x1=\"680.4\" y1=\"1500\" x2=\"247.4\" y2=\"1750\" />\n        <line opacity=\"0.167\" x1=\"2152.6\" y1=\"650\" x2=\"1719.6\" y2=\"900\" />\n        <line opacity=\"0.583\" x1=\"900\" y1=\"1719.6\" x2=\"650\" y2=\"2152.6\" />\n        <line opacity=\"0.083\" x1=\"1750\" y1=\"247.4\" x2=\"1500\" y2=\"680.4\" />\n        <animateTransform\n          attributeName=\"transform\"\n          attributeType=\"XML\"\n          type=\"rotate\"\n          keyTimes=\"0;0.08333;0.16667;0.25;0.33333;0.41667;0.5;0.58333;0.66667;0.75;0.83333;0.91667\"\n          values=\"0 1199 1199;30 1199 1199;60 1199 1199;90 1199 1199;120 1199 1199;150 1199 1199;180 1199 1199;210 1199 1199;240 1199 1199;270 1199 1199;300 1199 1199;330 1199 1199\"\n          dur=\"0.83333s\"\n          begin=\"0s\"\n          repeatCount=\"indefinite\"\n          calcMode=\"discrete\"\n        />\n      </g>\n    </Svg>\n  );\n};\n\nexport default LoadingIndicator;\n","import LoadingIndicator from 'components/LoadingIndicator';\nimport { useAudioPlayer, useInterval } from 'hooks';\nimport styled from 'styled-components';\nimport * as Utils from 'utils';\nimport { Unit } from 'utils/constants';\n\nimport ProgressBar from './ProgressBar';\n\nconst Container = styled.div`\n  position: relative;\n  display: flex;\n  flex: 1;\n  height: 1em;\n  padding: 0 ${Unit.SM};\n  -webkit-box-reflect: below 0px -webkit-gradient(linear, left top, left bottom, from(transparent), color-stop(60%, transparent), to(rgba(250, 250, 250, 0.1)));\n`;\n\ninterface LabelProps {\n  textAlign: 'left' | 'right';\n}\n\nconst Label = styled.h3<LabelProps>`\n  font-size: 12px;\n  margin: auto 0;\n  width: 30px;\n  text-align: ${(props) => props.textAlign};\n`;\n\nconst TrackProgress = () => {\n  const { playbackInfo, updatePlaybackInfo } = useAudioPlayer();\n\n  const {\n    isLoading,\n    isPlaying,\n    isPaused,\n    currentTime,\n    percent,\n    timeRemaining,\n  } = playbackInfo;\n\n  /** Update the progress bar every second. */\n  useInterval(() => {\n    if (isPlaying && !isPaused) {\n      updatePlaybackInfo();\n    }\n  }, 1000);\n\n  return (\n    <Container>\n      {isLoading ? (\n        <LoadingIndicator size={14} />\n      ) : (\n        <Label textAlign=\"left\">{Utils.formatTime(currentTime)}</Label>\n      )}\n      <ProgressBar percent={percent} />\n      <Label textAlign=\"right\">-{Utils.formatTime(timeRemaining)}</Label>\n    </Container>\n  );\n};\n\nexport default TrackProgress;\n","import styled from 'styled-components';\nimport { Unit } from 'utils/constants';\n\nimport ProgressBar from './ProgressBar';\n\nconst Container = styled.div`\n  position: relative;\n  display: flex;\n  flex: 1;\n  height: 1em;\n  padding: 0 ${Unit.SM};\n  -webkit-box-reflect: below 0px -webkit-gradient(linear, left top, left bottom, from(transparent), color-stop(60%, transparent), to(rgba(250, 250, 250, 0.1)));\n`;\n\nconst Icon = styled.img`\n  font-size: 12px;\n  margin: auto 0;\n  width: 30px;\n  height: 16px;\n`;\n\ninterface Props {\n  percent: number;\n}\n\nconst VolumeBar = ({ percent }: Props) => {\n  return (\n    <Container>\n      <Icon src=\"volume_mute.svg\" />\n      <ProgressBar percent={percent} />\n      <Icon src=\"volume_full.svg\" />\n    </Container>\n  );\n};\n\nexport default VolumeBar;\n","import { useCallback, useState } from 'react';\n\nimport { useEventListener, useVolumeHandler } from 'hooks';\nimport styled from 'styled-components';\nimport { Unit } from 'utils/constants';\n\nimport Scrubber from './Scrubber';\nimport TrackProgress from './TrackProgress';\nimport VolumeBar from './VolumeBar';\nimport { IpodEvent } from 'utils/events';\n\nconst Container = styled.div`\n  position: relative;\n  width: 100%;\n  padding: 0 ${Unit.MD} ${Unit.MD};\n`;\n\ninterface ContainerProps {\n  isHidden: boolean;\n}\n\nconst MainContainer = styled.div<ContainerProps>`\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: ${Unit.XS};\n  right: ${Unit.XS};\n  transition: transform 0.3s;\n\n  transform: ${(props) => props.isHidden && 'translateX(-110%)'};\n`;\n\nconst ScrubberContainer = styled.div<ContainerProps>`\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: ${Unit.XS};\n  right: ${Unit.XS};\n  transition: transform 0.3s;\n\n  transform: ${(props) => props.isHidden && 'translateX(110%)'};\n`;\n\nconst Controls = () => {\n  const { volume, active, setEnabled } = useVolumeHandler();\n  const [isScrubbing, setIsScrubbing] = useState(false);\n\n  const handleCenterClick = useCallback(() => {\n    if (isScrubbing) {\n      // Enable the volume controls.\n      setEnabled(true);\n      setIsScrubbing(false);\n    } else {\n      // Disable the volume controls.\n      setEnabled(false);\n      setIsScrubbing(true);\n    }\n  }, [isScrubbing, setEnabled]);\n\n  useEventListener<IpodEvent>('centerclick', handleCenterClick);\n\n  return (\n    <Container>\n      <MainContainer isHidden={isScrubbing}>\n        {active && !isScrubbing && <VolumeBar percent={volume * 100} />}\n      </MainContainer>\n      <MainContainer hidden={active && !isScrubbing} isHidden={isScrubbing}>\n        <TrackProgress />\n      </MainContainer>\n      <ScrubberContainer isHidden={!isScrubbing}>\n        <Scrubber isScrubbing={isScrubbing} />\n      </ScrubberContainer>\n    </Container>\n  );\n};\n\nexport default Controls;\n","import BatteryIndicator from 'components/BatteryIndicator';\nimport LoadingIndicator from 'components/LoadingIndicator';\nimport { useAudioPlayer, useWindowContext } from 'hooks';\nimport styled from 'styled-components';\n\nconst Container = styled.div`\n  width: 100%;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0 6px;\n  height: 20px;\n  background: linear-gradient(180deg, #feffff 0%, #b1b6b9 100%);\n  border-bottom: 1px solid #7995a3;\n  box-sizing: border-box;\n`;\n\nconst Text = styled.h3`\n  margin: 0;\n  font-size: 13px;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n`;\n\nconst IconContainer = styled.div`\n  display: flex;\n`;\n\nconst Icon = styled.img`\n  max-height: 12px;\n  margin-left: 8px;\n`;\n\nconst StyledBatteryIndicator = styled(BatteryIndicator)`\n  margin-left: 8px;\n`;\n\nconst Header = () => {\n  const { headerTitle } = useWindowContext();\n  const { playbackInfo } = useAudioPlayer();\n\n  const { isPlaying, isPaused, isLoading } = playbackInfo;\n\n  return headerTitle ? (\n    <Container>\n      <Text>{headerTitle}</Text>\n      <IconContainer>\n        {isLoading && (\n          <IconContainer>\n            <LoadingIndicator size={10} />\n          </IconContainer>\n        )}\n        {isPlaying && !isPaused && <Icon src=\"play.svg\" />}\n        {isPaused && <Icon src=\"pause.svg\" />}\n        <StyledBatteryIndicator />\n      </IconContainer>\n    </Container>\n  ) : null;\n};\n\nexport default Header;\n","import { useCallback, useEffect, useRef, useState } from 'react';\n\nimport { useInterval } from 'hooks';\nimport styled from 'styled-components';\n\nconst Container = styled.div``;\n\ninterface ImageProps {\n  zIndex: number;\n  startedAnimation: boolean;\n  isHidden: boolean;\n}\n\nconst Image = styled.img<ImageProps>`\n  z-index: ${(props) => props.zIndex};\n  position: absolute;\n  height: 100%;\n  right: 0;\n  animation: ${(props) => props.startedAnimation && 'kenBurns'} 20s;\n  opacity: ${(props) => props.isHidden && 0};\n  transition: opacity 2s;\n\n  @keyframes kenBurns {\n    0% {\n      transform: translateX(0%);\n    }\n\n    100% {\n      transform: translateX(10%);\n    }\n  }\n`;\n\ninterface Props {\n  urls: string[];\n}\n\nconst KenBurns = ({ urls }: Props) => {\n  const [stack, setStack] = useState<string[]>([]);\n  const [transitioning, setTransitioning] = useState(false);\n  const timeoutIdRef = useRef<any>();\n\n  useEffect(() => {\n    setStack(urls);\n  }, [urls]);\n\n  /** Move the currently displayed image to the bottom of the stack. */\n  const cycleImage = useCallback(() => {\n    setTransitioning(true);\n\n    timeoutIdRef.current = setTimeout(() => {\n      const newStack = stack.slice(1);\n\n      setStack([...newStack, stack[0]]);\n      setTransitioning(false);\n    }, 2000);\n\n    return () => {\n      if (timeoutIdRef.current) {\n        clearTimeout(timeoutIdRef.current);\n      }\n    };\n  }, [stack]);\n\n  /** Cycle through an image every 5 seconds. */\n  useInterval(cycleImage, 5000);\n\n  return (\n    <Container>\n      {stack.slice(0, 2).map((path, index) => (\n        <Image\n          key={`ken-burns-${path}`}\n          zIndex={3 - index}\n          src={path}\n          startedAnimation={index === 0 || transitioning}\n          isHidden={transitioning && index === 0}\n        />\n      ))}\n    </Container>\n  );\n};\n\nexport default KenBurns;\n","import { fade } from 'animation';\nimport { motion } from 'framer-motion';\nimport styled from 'styled-components';\n\ninterface ContainerProps {\n  backgroundColor?: string;\n}\n\nconst Container = styled(motion.div)<ContainerProps>`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  margin: auto;\n  background: ${(props) => props.backgroundColor};\n`;\n\ninterface Props {\n  size?: number;\n  backgroundColor?: string;\n}\n\nconst LoadingScreen = ({ size, backgroundColor }: Props) => {\n  return (\n    <Container {...fade} backgroundColor={backgroundColor}>\n      <svg\n        version=\"1.1\"\n        x=\"0px\"\n        y=\"0px\"\n        viewBox=\"0 0 2400 2400\"\n        width={size || 24}\n        height={size || 24}\n      >\n        <g\n          strokeWidth=\"200\"\n          strokeLinecap=\"round\"\n          stroke=\"#000000\"\n          fill=\"none\"\n          id=\"spinner\"\n        >\n          <line x1=\"1200\" y1=\"600\" x2=\"1200\" y2=\"100\" />\n          <line opacity=\"0.5\" x1=\"1200\" y1=\"2300\" x2=\"1200\" y2=\"1800\" />\n          <line opacity=\"0.917\" x1=\"900\" y1=\"680.4\" x2=\"650\" y2=\"247.4\" />\n          <line opacity=\"0.417\" x1=\"1750\" y1=\"2152.6\" x2=\"1500\" y2=\"1719.6\" />\n          <line opacity=\"0.833\" x1=\"680.4\" y1=\"900\" x2=\"247.4\" y2=\"650\" />\n          <line opacity=\"0.333\" x1=\"2152.6\" y1=\"1750\" x2=\"1719.6\" y2=\"1500\" />\n          <line opacity=\"0.75\" x1=\"600\" y1=\"1200\" x2=\"100\" y2=\"1200\" />\n          <line opacity=\"0.25\" x1=\"2300\" y1=\"1200\" x2=\"1800\" y2=\"1200\" />\n          <line opacity=\"0.667\" x1=\"680.4\" y1=\"1500\" x2=\"247.4\" y2=\"1750\" />\n          <line opacity=\"0.167\" x1=\"2152.6\" y1=\"650\" x2=\"1719.6\" y2=\"900\" />\n          <line opacity=\"0.583\" x1=\"900\" y1=\"1719.6\" x2=\"650\" y2=\"2152.6\" />\n          <line opacity=\"0.083\" x1=\"1750\" y1=\"247.4\" x2=\"1500\" y2=\"680.4\" />\n          <animateTransform\n            attributeName=\"transform\"\n            attributeType=\"XML\"\n            type=\"rotate\"\n            keyTimes=\"0;0.08333;0.16667;0.25;0.33333;0.41667;0.5;0.58333;0.66667;0.75;0.83333;0.91667\"\n            values=\"0 1199 1199;30 1199 1199;60 1199 1199;90 1199 1199;120 1199 1199;150 1199 1199;180 1199 1199;210 1199 1199;240 1199 1199;270 1199 1199;300 1199 1199;330 1199 1199\"\n            dur=\"0.83333s\"\n            begin=\"0s\"\n            repeatCount=\"indefinite\"\n            calcMode=\"discrete\"\n          />\n        </g>\n      </svg>\n    </Container>\n  );\n};\n\nexport default LoadingScreen;\n","import { useCallback } from 'react';\n\nimport { Controls } from 'components';\nimport { useAudioPlayer, useEffectOnce, useMKEventListener } from 'hooks';\nimport styled from 'styled-components';\nimport { Unit } from 'utils/constants';\n\nconst Container = styled.div`\n  height: 100%;\n  overflow: hidden;\n`;\n\nconst MetadataContainer = styled.div`\n  display: flex;\n  height: 70%;\n  padding: 0 ${Unit.XS};\n`;\n\ninterface ArtworkContainerProps {\n  isHidden?: boolean;\n}\n\nconst ArtworkContainer = styled.div<ArtworkContainerProps>`\n  height: 8em;\n  width: 8em;\n  margin: auto ${Unit.SM};\n  -webkit-box-reflect: below 0px -webkit-gradient(linear, left top, left bottom, from(transparent), color-stop(70%, transparent), to(rgba(250, 250, 250, 0.1)));\n  transform-style: preserve-3d;\n  perspective: 500px;\n  opacity: ${(props) => props.isHidden && 0};\n`;\n\nconst Artwork = styled.img`\n  height: 100%;\n  width: 100%;\n  transform: rotateY(18deg);\n  border: 1px solid #f3f3f3;\n`;\n\nconst InfoContainer = styled.div`\n  flex: 1;\n  margin: auto 0 auto ${Unit.XS};\n`;\n\nconst Text = styled.h3`\n  margin: 0;\n  font-size: 0.92rem;\n`;\n\nconst Subtext = styled(Text)`\n  color: rgb(99, 101, 103);\n  font-size: 0.75rem;\n`;\n\nconst ControlsContainer = styled.div`\n  display: flex;\n  align-items: center;\n  height: 30%;\n`;\n\ninterface Props {\n  hideArtwork?: boolean;\n  onHide: () => void;\n}\n\nconst NowPlaying = ({ hideArtwork, onHide }: Props) => {\n  const { nowPlayingItem, updateNowPlayingItem, updatePlaybackInfo } =\n    useAudioPlayer();\n\n  const handlePlaybackChange = useCallback(\n    ({ state }: { state: MusicKit.PlaybackStates }) => {\n      /** Hide the now playing view if the playback state is \"Completed\" */\n      if (state === MusicKit.PlaybackStates.completed) {\n        onHide();\n      }\n    },\n    [onHide]\n  );\n\n  useEffectOnce(() => {\n    updateNowPlayingItem();\n    updatePlaybackInfo();\n  });\n\n  useMKEventListener('playbackStateDidChange', handlePlaybackChange);\n\n  return (\n    <Container>\n      <MetadataContainer>\n        <ArtworkContainer isHidden={hideArtwork}>\n          <Artwork src={nowPlayingItem?.artwork?.url} />\n        </ArtworkContainer>\n        <InfoContainer>\n          <Text>{nowPlayingItem?.name}</Text>\n          <Subtext>{nowPlayingItem?.artistName}</Subtext>\n          <Subtext>{nowPlayingItem?.albumName}</Subtext>\n        </InfoContainer>\n      </MetadataContainer>\n      <ControlsContainer>\n        <Controls />\n      </ControlsContainer>\n    </Container>\n  );\n};\n\nexport default NowPlaying;\n","import styled from 'styled-components';\nimport * as Types from './types';\nexport * from './types';\n\nexport const WheelButton = styled.svg<Types.WheelButtonProps>`\n  position: absolute;\n  margin: ${(props) => props.margin};\n  top: ${(props) => props.top};\n  bottom: ${(props) => props.bottom};\n  left: ${(props) => props.left};\n  right: ${(props) => props.right};\n  user-select: none;\n  pointer-events: none;\n  max-height: 13px;\n`;\n","import { WheelButton, WheelButtonProps } from '../Styled';\n\ninterface Props extends WheelButtonProps {\n  color?: string;\n}\n\nconst MenuIcon = (props: Props) => (\n  <WheelButton\n    width=\"61\"\n    height=\"17\"\n    viewBox=\"0 0 61 17\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    {...props}\n  >\n    <path\n      d=\"M10.6177 0.885742H15.1602V16H12.2173V5.77686C12.2173 5.48291 12.2207 5.07275 12.2275 4.54639C12.2344 4.01318 12.2378 3.60303 12.2378 3.31592L9.37695 16H6.31104L3.4707 3.31592C3.4707 3.60303 3.47412 4.01318 3.48096 4.54639C3.48779 5.07275 3.49121 5.48291 3.49121 5.77686V16H0.54834V0.885742H5.14209L7.89014 12.77L10.6177 0.885742ZM29.6895 3.56201H21.6915V6.77148H29.0333V9.39648H21.6915V13.2827H30.0587V16H18.6051V0.885742H29.6895V3.56201ZM32.8883 0.885742H36.2004L42.2194 11.437V0.885742H45.1623V16H42.0041L35.8312 5.26416V16H32.8883V0.885742ZM48.5354 0.885742H51.7449V10.1758C51.7449 11.2148 51.8679 11.9736 52.114 12.4521C52.4968 13.2998 53.3308 13.7236 54.616 13.7236C55.8943 13.7236 56.7248 13.2998 57.1077 12.4521C57.3537 11.9736 57.4768 11.2148 57.4768 10.1758V0.885742H60.6863V10.1758C60.6863 11.7822 60.4368 13.0332 59.9377 13.9287C59.008 15.5693 57.2341 16.3896 54.616 16.3896C51.9978 16.3896 50.2204 15.5693 49.2839 13.9287C48.7849 13.0332 48.5354 11.7822 48.5354 10.1758V0.885742Z\"\n      fill={props.color}\n    />\n  </WheelButton>\n);\n\nexport default MenuIcon;\n","import { WheelButton, WheelButtonProps } from '../Styled';\n\ninterface Props extends WheelButtonProps {\n  color?: string;\n}\n\nconst RewindIcon = (props: Props) => (\n  <WheelButton\n    width=\"33\"\n    height=\"16\"\n    viewBox=\"0 0 33 16\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    {...props}\n  >\n    <path d=\"M17 8L29 1.0718V14.9282L17 8Z\" fill={props.color} />\n    <path d=\"M4 8L16 1.0718V14.9282L4 8Z\" fill={props.color} />\n    <rect\n      x=\"4\"\n      y=\"16\"\n      width=\"4\"\n      height=\"15\"\n      transform=\"rotate(-180 4 16)\"\n      fill={props.color}\n    />\n  </WheelButton>\n);\n\nexport default RewindIcon;\n","import { WheelButton, WheelButtonProps } from '../Styled';\n\ninterface Props extends WheelButtonProps {\n  color?: string;\n}\n\nconst PlayPauseIcon = (props: Props) => (\n  <WheelButton\n    width=\"39\"\n    height=\"18\"\n    viewBox=\"0 0 39 18\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    {...props}\n  >\n    <path d=\"M18 9L4.5 16.7942L4.5 1.20577L18 9Z\" fill={props.color} />\n    <rect x=\"26\" y=\"1\" width=\"4\" height=\"16\" fill={props.color} />\n    <rect x=\"35\" y=\"1\" width=\"4\" height=\"16\" fill={props.color} />\n  </WheelButton>\n);\n\nexport default PlayPauseIcon;\n","import { WheelButton, WheelButtonProps } from '../Styled';\n\ninterface Props extends WheelButtonProps {\n  color?: string;\n}\n\nconst FastForwardIcon = (props: Props) => (\n  <WheelButton\n    width=\"33\"\n    height=\"16\"\n    viewBox=\"0 0 33 16\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    {...props}\n  >\n    <path d=\"M16 8L4 14.9282L4 1.0718L16 8Z\" fill={props.color} />\n    <path d=\"M29 8L17 14.9282V1.0718L29 8Z\" fill={props.color} />\n    <rect x=\"29\" width=\"4\" height=\"15\" fill={props.color} />\n  </WheelButton>\n);\n\nexport default FastForwardIcon;\n","const Silver = {\n  body: {\n    background: 'linear-gradient(180deg, #e3e3e3 0%, #d6d6d6 100%)',\n  },\n  knob: {\n    background: '#FFFFFF',\n    outline: '#b9b9b9',\n    button: '#AFAFAF',\n    centerButton: {\n      background: '#ffffff',\n      boxShadow: 'rgb(191, 191, 191)',\n      outline: '#b9b9b9',\n    },\n  },\n};\n\nconst Black = {\n  body: {\n    background: 'linear-gradient(180deg, #7d7c7d 0%, #1e1e1e 100%)',\n  },\n  knob: {\n    background: '#2a2a2a',\n    outline: '#1a1a1a',\n    button: '#FFFFFF',\n    centerButton: {\n      background: '#7d7c7d',\n      boxShadow: 'rgb(50, 50, 50)',\n      outline: '#1a1a1a',\n    },\n  },\n};\n\nconst U2 = {\n  body: {\n    background: 'linear-gradient(180deg, #7d7c7d 0%, #1e1e1e 100%)',\n  },\n  knob: {\n    background: '#de2029',\n    outline: '#1a1a1a',\n    button: '#ffffff',\n    centerButton: {\n      background: '#5d5c5d',\n      boxShadow: 'rgb(50, 50, 50)',\n      outline: '#1a1a1a',\n    },\n  },\n};\n\nexport { Silver, Black, U2 };\n","import * as Theme from './constants/Theme';\nexport type DeviceTheme = 'silver' | 'black' | 'u2';\n\nexport const getTheme = (deviceTheme: DeviceTheme) => {\n  if (deviceTheme === 'silver') {\n    return Theme.Silver;\n  } else if (deviceTheme === 'black') {\n    return Theme.Black;\n  } else {\n    return Theme.U2;\n  }\n};\n","import React, { SyntheticEvent } from 'react';\nimport styled from 'styled-components';\nimport { useRef } from 'react';\nimport { useEffectOnce, useSettings } from 'hooks';\nimport { useEffect } from 'react';\nimport MenuIcon from './icons/MenuIcon';\nimport RewindIcon from './icons/RewindIcon';\nimport PlayPauseIcon from './icons/PlayPauseIcon';\nimport FastForwardIcon from './icons/FastForwardIcon';\nimport { DeviceTheme, getTheme } from '../../utils/themes';\n\nconst Container = styled.div`\n  user-select: none;\n  position: relative;\n  display: flex;\n  justify-content: center;\n  margin: auto 0;\n  touch-action: none;\n  transform: translate3d(0, 0, 0);\n`;\n\nconst CanvasContainer = styled.div<{ width: number; height: number }>`\n  position: relative;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: ${(props) => props.width}px;\n  height: ${(props) => props.height}px;\n`;\n\nconst Canvas = styled.canvas<{ deviceTheme: DeviceTheme }>`\n  border-radius: 50%;\n  border: 1px solid ${({ deviceTheme }) => getTheme(deviceTheme).knob.outline};\n  background: ${({ deviceTheme }) => getTheme(deviceTheme).knob.background};\n`;\n\nconst CenterButton = styled.div<{ size: number; deviceTheme: DeviceTheme }>`\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  margin: auto;\n  width: ${(props) => props.size / 2.5}px;\n  height: ${(props) => props.size / 2.5}px;\n  border-radius: 50%;\n  box-shadow: ${({ deviceTheme }) =>\n    getTheme(deviceTheme).knob.centerButton.boxShadow}\n    0px 1em 3em inset;\n  background: ${({ deviceTheme }) =>\n    getTheme(deviceTheme).knob.centerButton.background};\n  border: 1px solid\n    ${({ deviceTheme }) => getTheme(deviceTheme).knob.centerButton.outline}};\n\n  :active {\n    filter: brightness(0.9);\n  }\n`;\n\n/** Custom Event from https://github.com/john-doherty/long-press-event  */\ninterface LongPressEvent extends SyntheticEvent {\n  detail: {\n    clientX: number;\n    clientY: number;\n  };\n}\n\nconst ANGLE_ARC = (360 * Math.PI) / 180;\nconst ANGLE_OFFSET = (0 * Math.PI) / 180;\nconst START_ANGLE = 1.5 * Math.PI + ANGLE_OFFSET;\nconst END_ANGLE = 1.5 * Math.PI + ANGLE_OFFSET + ANGLE_ARC;\n\ntype Props = {\n  value: number;\n  onChange: (value: number) => void;\n  onClick?: (e: React.MouseEvent) => void;\n  onLongPress?: (e: Event) => void;\n  onMenuLongPress?: (e: Event) => void;\n  onWheelClick?: (value: number) => void;\n  onChangeEnd?: (value: number) => void;\n  min?: number;\n  max?: number;\n  step?: number;\n  width?: number;\n  height?: number;\n  thickness?: number;\n  bgColor?: string;\n  fgColor?: string;\n  className?: string;\n  canvasClassName?: string;\n};\n\nconst Knob = ({\n  value,\n  onChange,\n  onChangeEnd = () => {},\n  onWheelClick = () => {},\n  onClick = () => {},\n  onLongPress = () => {},\n  onMenuLongPress = () => {},\n  min = 0,\n  max = 100,\n  step = 1,\n  width = 200,\n  height = 200,\n  thickness = 0.35,\n  bgColor = '#EEE',\n  fgColor = '#EA2',\n  className,\n  canvasClassName,\n}: Props) => {\n  const { deviceTheme } = useSettings();\n  const canvasRef = useRef<HTMLCanvasElement | undefined>();\n  const centerButtonRef = useRef<HTMLDivElement | undefined>();\n\n  const handleLongPress = (event: Event) => {\n    event.preventDefault();\n    (event.target as any).setAttribute('longpress', new Date().getTime());\n    onLongPress(event);\n    return false;\n  };\n\n  const handleMenuLongPress = (event: Event) => {\n    onMenuLongPress(event);\n  };\n\n  const handleWheelLongPress = (event: LongPressEvent) => {\n    event.preventDefault();\n    (event.target as any).setAttribute('longpress', new Date().getTime());\n\n    const rect = (event.target as Element).getBoundingClientRect();\n    const x = event.detail.clientX - rect.left;\n    const y = event.detail.clientY - rect.top;\n    console.log({ x, y });\n    const rectWidth = rect.width;\n    const quadrant = findClickQuadrant(rectWidth, x, y);\n\n    if (quadrant === 1) {\n      handleMenuLongPress(event as any);\n    }\n  };\n\n  const getArcToValue = (v: number) => {\n    const angle = ((v - min) * ANGLE_ARC) / (max - min);\n    const startAngle = START_ANGLE - 0.00001;\n    const endAngle = startAngle + angle + 0.00001;\n\n    return {\n      startAngle,\n      endAngle,\n      acw: false,\n    };\n  };\n\n  const getCanvasScale = (ctx: CanvasRenderingContext2D) => {\n    const devicePixelRatio =\n      window.devicePixelRatio ||\n      (window.screen as any).deviceXDPI / (window.screen as any).logicalXDPI || // IE 11\n      1;\n\n    const backingStoreRatio = (ctx as any).webkitBackingStorePixelRatio || 1;\n    return devicePixelRatio / backingStoreRatio;\n  };\n\n  const coerceToStep = (v: number) => {\n    let val = ~~((v < 0 ? -0.5 : 0.5) + v / step) * step;\n    val = Math.max(Math.min(val, max), min);\n    if (isNaN(val)) {\n      val = 0;\n    }\n    return Math.round(val * 1000) / 1000;\n  };\n\n  const eventToValue = (e: any) => {\n    const bounds = canvasRef.current?.getBoundingClientRect();\n    if (!bounds) {\n      return 0;\n    }\n    const x = e.clientX - bounds.left;\n    const y = e.clientY - bounds.top;\n    let a = Math.atan2(x - width / 2, width / 2 - y) - ANGLE_OFFSET;\n    if (ANGLE_ARC !== Math.PI * 2 && a < 0 && a > -0.5) {\n      a = 0;\n    } else if (a < 0) {\n      a += Math.PI * 2;\n    }\n    const val = (a * (max - min)) / ANGLE_ARC + min;\n    return coerceToStep(val);\n  };\n\n  const handleMouseDown = (e: Event) => {\n    onChange(eventToValue(e));\n    document.addEventListener('mousemove', handleMouseMove);\n    document.addEventListener('mouseup', handleMouseUpNoMove);\n  };\n\n  const handleTouchStart = (e: Event) => {\n    onChange(eventToValue(e));\n    document.addEventListener('touchmove', handleTouchMove);\n    document.addEventListener('touchend', handleTouchEndNoMove);\n    document.removeEventListener('mousedown', handleMouseDown);\n  };\n\n  const handleMouseMove = (e: Event) => {\n    e.preventDefault();\n    const val = eventToValue(e);\n\n    if (val !== value) {\n      onChange(eventToValue(e));\n    }\n\n    document.removeEventListener('mouseup', handleMouseUpNoMove);\n    document.addEventListener('mouseup', handleMouseUp);\n  };\n\n  const handleTouchMove = (e: Event) => {\n    e.preventDefault();\n    const touchEvent = e as TouchEvent;\n    const touchIndex = touchEvent.targetTouches.length - 1;\n    const val = eventToValue(touchEvent.targetTouches[touchIndex]);\n\n    if (val !== value) {\n      onChange(val);\n    }\n\n    if (!canvasRef.current) {\n      return;\n    }\n\n    canvasRef.current.removeEventListener(\n      'long-press',\n      handleWheelLongPress as any\n    );\n    document.removeEventListener('touchend', handleTouchEndNoMove);\n    document.addEventListener('touchend', handleTouchEnd);\n  };\n\n  const handleMouseUp = (e: Event) => {\n    onChangeEnd(eventToValue(e));\n    document.removeEventListener('mousemove', handleMouseMove);\n    document.removeEventListener('mouseup', handleMouseUp);\n  };\n\n  const handleTouchEnd = (e: Event) => {\n    const touchEvent = e as TouchEvent;\n    const touchIndex = touchEvent.targetTouches.length - 1;\n    onChangeEnd(touchEvent.targetTouches[touchIndex] as any);\n    document.removeEventListener('touchmove', handleTouchMove);\n    document.removeEventListener('touchend', handleTouchEnd);\n\n    if (!canvasRef.current) {\n      return;\n    }\n\n    canvasRef.current.addEventListener(\n      'long-press',\n      handleWheelLongPress as any\n    );\n  };\n\n  const findClickQuadrant = (rectSize: number, x: number, y: number) => {\n    if (y < rectSize / 4) {\n      return 1;\n    } else if (y > rectSize * 0.75) {\n      return 2;\n    } else if (x < rectSize / 4) {\n      return 3;\n    } else if (x > rectSize * 0.75) {\n      return 4;\n    }\n    return -1;\n  };\n\n  const handleMouseUpNoMove = (e: Event) => {\n    const mouseEvent = e as MouseEvent;\n    const rect = (mouseEvent.target as Element).getBoundingClientRect();\n    const x = mouseEvent.clientX - rect.left;\n    const y = mouseEvent.clientY - rect.top;\n    const rectWidth = rect.width;\n    const quadrant = findClickQuadrant(rectWidth, x, y);\n    if (quadrant > 0 && quadrant <= 4) {\n      onWheelClick(quadrant);\n    }\n\n    document.removeEventListener('mousemove', handleMouseMove);\n    document.removeEventListener('mouseup', handleMouseUp);\n    document.removeEventListener('mouseup', handleMouseUpNoMove);\n  };\n\n  const handleTouchEndNoMove = (e: Event) => {\n    const touchEvent = e as TouchEvent;\n    const rect = (touchEvent.target as Element).getBoundingClientRect();\n    const touch =\n      touchEvent.changedTouches[touchEvent.changedTouches.length - 1];\n    const x = touch.pageX - rect.left;\n    const y = touch.pageY - rect.top;\n    const rectWidth = rect.width;\n    const quadrant = findClickQuadrant(rectWidth, x, y);\n\n    if (quadrant > 0 && quadrant <= 4) {\n      onWheelClick(quadrant);\n    }\n\n    document.removeEventListener('touchmove', handleTouchMove);\n    document.removeEventListener('touchend', handleTouchEnd);\n    document.removeEventListener('touchend', handleTouchEndNoMove);\n  };\n\n  const drawCanvas = () => {\n    if (!canvasRef.current) {\n      return;\n    }\n    const ctx = canvasRef.current.getContext('2d')!;\n    const scale = getCanvasScale(ctx);\n    canvasRef.current.width = width * scale; // clears the canvas\n    canvasRef.current.height = height * scale;\n    ctx.scale(scale, scale);\n    const xy = width / 2; // coordinates of canvas center\n    const lineWidth = xy * thickness;\n    const radius = xy - lineWidth / 2;\n    ctx.lineWidth = lineWidth;\n    ctx.lineCap = 'butt';\n    // background arc\n    ctx.beginPath();\n    ctx.strokeStyle = bgColor;\n    ctx.arc(xy, xy, radius, END_ANGLE - 0.00001, START_ANGLE + 0.00001, true);\n    ctx.stroke();\n    // foreground arc\n    const a = getArcToValue(value);\n    ctx.beginPath();\n    ctx.strokeStyle = fgColor;\n    ctx.arc(xy, xy, radius, a.startAngle, a.endAngle, a.acw);\n    ctx.stroke();\n  };\n\n  // Component Did Mount\n  useEffectOnce(() => {\n    if (!canvasRef.current || !centerButtonRef.current) {\n      console.error(\"Things didn't mount properly!\");\n      return;\n    }\n\n    const isTouchEnabled =\n      'ontouchstart' in window ||\n      navigator.maxTouchPoints > 0 ||\n      navigator.msMaxTouchPoints > 0;\n\n    drawCanvas();\n    if (isTouchEnabled) {\n      canvasRef.current.addEventListener('touchstart', handleTouchStart);\n    } else {\n      canvasRef.current.addEventListener('mousedown', handleMouseDown);\n    }\n    centerButtonRef.current.addEventListener('long-press', handleLongPress);\n\n    canvasRef.current.addEventListener(\n      'long-press',\n      handleWheelLongPress as any\n    );\n\n    // Component Will Unmount\n    return () => {\n      if (!canvasRef.current || !centerButtonRef.current) {\n        console.error(\"Things didn't mount properly!\");\n        return;\n      }\n\n      if (isTouchEnabled) {\n        canvasRef.current.removeEventListener('touchstart', handleTouchStart);\n      } else {\n        canvasRef.current.removeEventListener('mousedown', handleMouseDown);\n      }\n      centerButtonRef.current.removeEventListener(\n        'long-press',\n        handleLongPress\n      );\n      canvasRef.current.removeEventListener(\n        'long-press',\n        handleWheelLongPress as any\n      );\n    };\n  });\n\n  // Component Did Update\n  useEffect(() => {\n    drawCanvas();\n  });\n\n  const buttonColor = getTheme(deviceTheme).knob.button;\n\n  return (\n    <Container className={className}>\n      <CanvasContainer width={width} height={height}>\n        <Canvas\n          ref={(ref) => {\n            canvasRef.current = ref ?? undefined;\n          }}\n          className={canvasClassName}\n          style={{ width: '100%', height: '100%' }}\n          deviceTheme={deviceTheme}\n        />\n\n        <CenterButton\n          ref={(ref) => {\n            centerButtonRef.current = ref ?? undefined;\n          }}\n          onClick={onClick}\n          size={width}\n          deviceTheme={deviceTheme}\n        />\n        <MenuIcon top={'8%'} margin={'0 auto'} color={buttonColor} />\n        <PlayPauseIcon bottom={'8%'} margin={'0 auto'} color={buttonColor} />\n        <RewindIcon left={'8%'} margin={'auto 0'} color={buttonColor} />\n        <FastForwardIcon right={'8%'} margin={'auto 0'} color={buttonColor} />\n      </CanvasContainer>\n    </Container>\n  );\n};\n\nexport default Knob;\n","/** The click-wheel control associated with the particular event */\ntype BaseEventContext =\n  | 'wheel'\n  | 'center'\n  | 'forward'\n  | 'backward'\n  | 'menu'\n  | 'playpause';\n\n/** The action that is taken on a click-wheel control */\ntype BaseEventAction = 'click' | 'longclick' | 'scroll' | 'longpress';\n\n/** The custom events that are supported for the iPod */\nexport type IpodEvent = `${BaseEventContext}${BaseEventAction}` | `idle`;\n\n/** Create a type-safe custom event for the iPod */\nexport const createIpodEvent = (eventName: IpodEvent) => new Event(eventName);\n","import { useMemo } from 'react';\n\nimport { slideUpAnimation } from 'animation';\nimport { SelectableListOption } from 'components';\nimport { WINDOW_TYPE } from 'components/views';\nimport { motion } from 'framer-motion';\nimport {\n  useEventListener,\n  useMenuHideWindow,\n  useScrollHandler,\n  useWindowContext,\n} from 'hooks';\nimport { WindowOptions } from 'providers/WindowProvider';\nimport styled, { css } from 'styled-components';\nimport { Unit } from 'utils/constants';\nimport { IpodEvent } from 'utils/events';\n\ninterface RootContainerProps {\n  index: number;\n}\n\n/** Responsible for putting the window at the proper z-index. */\nexport const RootContainer = styled(motion.div)<RootContainerProps>`\n  z-index: ${(props) => props.index};\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n`;\n\ninterface ContentTransitionContainerProps {\n  isHidden: boolean;\n}\n\n/** Slides the view in from the bottom if it is at the top of the stack. */\nconst ContentTransitionContainer = styled.div<ContentTransitionContainerProps>`\n  position: relative;\n  width: 100%;\n  padding: ${Unit.XS} 0;\n  background: linear-gradient(180deg, #bbbcbf 0%, #626770 11.69%, #626770 100%);\n  box-shadow: 0 0px 4px black;\n`;\n\nconst OptionText = styled.h3`\n  margin: 0;\n  padding: ${Unit.XS} ${Unit.XXS};\n  font-size: 16px;\n  background: linear-gradient(180deg, #ffffff 0%, #cbccce 48.44%, #dfdfdf 100%);\n  border: 3px solid #3e4249;\n  border-radius: 12px;\n  text-shadow: 0px 0px 1px #505050;\n`;\n\nconst OptionContainer = styled.div<{ highlighted: boolean }>`\n  padding: ${Unit.XXS} ${Unit.MD};\n  text-align: center;\n  border: 3px solid transparent;\n\n  ${({ highlighted }) =>\n    highlighted &&\n    css`\n      ${OptionText} {\n        background: linear-gradient(\n          rgb(60, 184, 255) 0%,\n          rgb(52, 122, 181) 100%\n        ) !important;\n        color: white !important;\n        border: 3px solid #ececec;\n      }\n    `};\n\n  :last-of-type {\n    margin-top: ${Unit.XXS};\n\n    ${OptionText} {\n      background: linear-gradient(\n        180deg,\n        #707379 0%,\n        #3b3f46 48.44%,\n        #363c44 100%\n      );\n      color: white;\n    }\n  }\n`;\n\ninterface Props {\n  windowStack: WindowOptions[];\n  index: number;\n  isHidden: boolean;\n}\n\nconst ActionSheet = ({ windowStack, index, isHidden }: Props) => {\n  const { hideWindow } = useWindowContext();\n  const windowOptions = windowStack[index];\n  useMenuHideWindow(windowOptions.id);\n\n  const options: SelectableListOption[] = useMemo(() => {\n    const listOptions =\n      windowOptions.type === WINDOW_TYPE.ACTION_SHEET\n        ? windowOptions.listOptions\n        : [];\n\n    return [\n      ...listOptions,\n      {\n        type: 'Action',\n        label: 'Cancel',\n        onSelect: () => {},\n      },\n    ];\n  }, [windowOptions]);\n\n  const selectedOption: SelectableListOption | undefined = useMemo(\n    () => options.find((option) => option.isSelected === true),\n    [options]\n  );\n\n  useEventListener<IpodEvent>('centerclick', () => {\n    hideWindow();\n  });\n\n  const [scrollIndex] = useScrollHandler(\n    windowOptions.id,\n    options,\n    selectedOption\n  );\n\n  return (\n    <RootContainer\n      data-window-id={windowOptions.id}\n      index={index}\n      {...slideUpAnimation}\n    >\n      <ContentTransitionContainer isHidden={isHidden}>\n        {options.map((option, i) => (\n          <OptionContainer\n            key={`popup-option-${option.label}`}\n            highlighted={scrollIndex === i}\n          >\n            <OptionText>{option.label}</OptionText>\n          </OptionContainer>\n        ))}\n      </ContentTransitionContainer>\n    </RootContainer>\n  );\n};\n\nexport default ActionSheet;\n","import { AnimatePresence } from 'framer-motion';\nimport { WindowOptions } from 'providers/WindowProvider';\nimport styled from 'styled-components';\n\nimport ActionSheet from '../components/ActionSheet';\n\ninterface ContainerProps {\n  isHidden: boolean;\n}\n\nconst RootContainer = styled.div<ContainerProps>`\n  z-index: 4;\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  background: ${({ isHidden }) =>\n    isHidden ? 'transparent' : 'rgba(0, 0, 0, 0.5)'};\n  transition: all 0.25s ease;\n`;\n\ninterface Props {\n  windowStack: WindowOptions[];\n}\n\nconst ActionSheetWindowManager = ({ windowStack }: Props) => {\n  const isHidden = windowStack.length === 0;\n\n  return (\n    <RootContainer data-stack-type=\"action-sheet\" isHidden={isHidden}>\n      <AnimatePresence>\n        {windowStack.map((window, index) => (\n          <ActionSheet\n            key={`window-${window.id}`}\n            windowStack={windowStack}\n            index={index}\n            isHidden={index < windowStack.length - 1}\n          />\n        ))}\n      </AnimatePresence>\n    </RootContainer>\n  );\n};\n\nexport default ActionSheetWindowManager;\n","import { fade } from 'animation';\nimport { Header } from 'components';\nimport { WINDOW_TYPE } from 'components/views';\nimport { AnimatePresence, motion } from 'framer-motion';\nimport { WindowOptions } from 'providers/WindowProvider';\nimport styled from 'styled-components';\n\nconst Container = styled(motion.div)`\n  z-index: 0;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n`;\n\ninterface Props {\n  window?: WindowOptions;\n}\n\nconst CoverFlowWindowManager = ({ window }: Props) => {\n  const WindowComponent =\n    window?.type === WINDOW_TYPE.COVER_FLOW ? window.component : null;\n\n  return (\n    <AnimatePresence>\n      {!!WindowComponent && (\n        <Container {...fade} data-stack-type=\"coverflow\">\n          <Header />\n          <WindowComponent />\n        </Container>\n      )}\n    </AnimatePresence>\n  );\n};\n\nexport default CoverFlowWindowManager;\n","import { useMemo } from 'react';\n\nimport { popInAnimation } from 'animation';\nimport { SelectableListOption } from 'components';\nimport { WINDOW_TYPE } from 'components/views';\nimport { motion } from 'framer-motion';\nimport {\n  useEventListener,\n  useMenuHideWindow,\n  useScrollHandler,\n  useWindowContext,\n} from 'hooks';\nimport { WindowOptions } from 'providers/WindowProvider';\nimport styled, { css } from 'styled-components';\nimport { Unit } from 'utils/constants';\nimport { IpodEvent } from 'utils/events';\n\ninterface RootContainerProps {\n  index: number;\n}\n\n/** Responsible for putting the window at the proper z-index. */\nexport const RootContainer = styled(motion.div)<RootContainerProps>`\n  z-index: ${(props) => props.index};\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\n\ninterface ContentTransitionContainerProps {\n  isHidden: boolean;\n}\n\n/** Slides the view in from the bottom if it is at the top of the stack. */\nconst ContentTransitionContainer = styled.div<ContentTransitionContainerProps>`\n  position: relative;\n  background: linear-gradient(\n    180deg,\n    #a2a8b7 0%,\n    rgba(38, 52, 88, 0.92) 20.6%,\n    #28365a 100%\n  );\n  width: 80%;\n  padding: ${Unit.XXS};\n  box-shadow: 0px 6px 5px rgba(0, 0, 0, 0.39);\n  border: 2.5px solid white;\n  border-radius: 12px;\n  color: white;\n  font-weight: 500;\n  text-align: center;\n`;\n\nconst TitleText = styled.h3`\n  margin: ${Unit.XS} 0 ${Unit.XS};\n  font-size: 16px;\n`;\n\nconst DescriptionText = styled(TitleText)`\n  margin: ${Unit.XS} 0 ${Unit.XS};\n  font-size: 14px;\n  font-weight: 400;\n`;\n\nconst OptionsContainer = styled.div`\n  display: flex;\n`;\n\nconst OptionText = styled.h3`\n  margin: 0;\n  padding: ${Unit.XS} ${Unit.XXS};\n  font-size: 16px;\n  background: linear-gradient(180deg, #8c94a8 0%, #334164 44.97%, #445070 100%);\n  border: 2px solid #242e47;\n  border-radius: 8px;\n\n  text-shadow: 0px 0px 1px #505050;\n`;\n\nconst OptionContainer = styled.div<{ highlighted: boolean }>`\n  flex: 1;\n  text-align: center;\n  border: 2px solid transparent;\n  margin-top: 8px;\n\n  ${({ highlighted }) =>\n    highlighted &&\n    css`\n      ${OptionText} {\n        border: 2px solid #ececec;\n        filter: brightness(120%);\n      }\n    `};\n`;\n\ninterface Props {\n  windowStack: WindowOptions[];\n  index: number;\n  isHidden: boolean;\n}\n\nconst Popup = ({ windowStack, index, isHidden }: Props) => {\n  const windowOptions = windowStack[index];\n  useMenuHideWindow(windowOptions.id);\n  const { hideWindow } = useWindowContext();\n\n  if (windowOptions.type !== WINDOW_TYPE.POPUP) {\n    throw new Error('Popup option not supplied');\n  }\n\n  const listOptions: SelectableListOption[] = useMemo(() => {\n    const listOptions =\n      windowOptions.type === WINDOW_TYPE.POPUP ? windowOptions.listOptions : [];\n\n    return listOptions.length\n      ? listOptions\n      : [\n          {\n            type: 'Action',\n            label: 'Done',\n            onSelect: () => {},\n          },\n        ];\n  }, [windowOptions.listOptions, windowOptions.type]);\n\n  const [scrollIndex] = useScrollHandler(windowOptions.id, listOptions);\n\n  useEventListener<IpodEvent>('centerclick', () => {\n    hideWindow();\n  });\n\n  return (\n    <RootContainer\n      data-window-id={windowOptions.id}\n      index={index}\n      {...popInAnimation}\n    >\n      <ContentTransitionContainer isHidden={isHidden}>\n        <TitleText>{windowOptions.title}</TitleText>\n        <DescriptionText>{windowOptions.description}</DescriptionText>\n        <OptionsContainer>\n          {listOptions.map((option, i) => (\n            <OptionContainer\n              key={`popup-option-${option.label}`}\n              highlighted={scrollIndex === i}\n            >\n              <OptionText>{option.label}</OptionText>\n            </OptionContainer>\n          ))}\n        </OptionsContainer>\n      </ContentTransitionContainer>\n    </RootContainer>\n  );\n};\n\nexport default Popup;\n","import { useMemo } from 'react';\n\nimport { noAnimation, slideRightAnimation } from 'animation';\nimport { WINDOW_TYPE } from 'components/views';\nimport { motion } from 'framer-motion';\nimport { useWindowContext } from 'hooks';\nimport { WindowOptions } from 'providers/WindowProvider';\nimport styled from 'styled-components';\n\ninterface ContainerProps {\n  index: number;\n  showHeader: boolean;\n}\n\n/** Responsible for putting the window at the proper z-index. */\nexport const Container = styled(motion.div)<ContainerProps>`\n  z-index: ${(props) => props.index};\n  position: absolute;\n  top: ${(props) => (props.showHeader ? '20px' : 0)};\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background: white;\n`;\n\ninterface ContentTransitionContainerProps {\n  isHidden: boolean;\n}\n\n/** Slides the view to the left if it isn't at the top of the stack. */\nconst ContentTransitionContainer = styled.div<ContentTransitionContainerProps>`\n  height: 100%;\n  transition: transform 0.3s;\n  transform: ${(props) => props.isHidden && 'translateX(-100%)'};\n  overflow: auto;\n`;\n\ninterface Props {\n  windowStack: WindowOptions[];\n  index: number;\n  isHidden: boolean;\n}\n\nconst Window = ({ windowStack, index, isHidden }: Props) => {\n  const { headerTitle } = useWindowContext();\n  const options = windowStack[index];\n  const firstInStack = index === 0;\n\n  const WindowComponent = useMemo(() => {\n    switch (options.type) {\n      case WINDOW_TYPE.FULL:\n      case WINDOW_TYPE.SPLIT:\n      case WINDOW_TYPE.COVER_FLOW:\n        return options.component;\n      default:\n        return null;\n    }\n  }, [options]);\n\n  return (\n    <Container\n      data-window-id={options.id}\n      index={index}\n      showHeader={!!headerTitle}\n      {...(firstInStack ? noAnimation : slideRightAnimation)}\n    >\n      <ContentTransitionContainer isHidden={isHidden}>\n        <WindowComponent />\n      </ContentTransitionContainer>\n    </Container>\n  );\n};\n\nexport default Window;\n","import { Header } from 'components';\nimport { AnimatePresence } from 'framer-motion';\nimport { WindowOptions } from 'providers/WindowProvider';\nimport styled from 'styled-components';\n\nimport { Window } from '../components';\n\ninterface ContainerProps {\n  isHidden: boolean;\n}\n\nconst Container = styled.div<ContainerProps>`\n  z-index: 3;\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  background: white;\n  transition: all 0.35s;\n  transform: ${(props) => props.isHidden && 'translateX(100%)'};\n`;\n\ninterface Props {\n  windowStack: WindowOptions[];\n}\n\nconst FullScreenWindowManager = ({ windowStack }: Props) => {\n  const isHidden = windowStack.length === 0;\n\n  return (\n    <Container data-stack-type=\"fullscreen\" isHidden={isHidden}>\n      <Header />\n      <AnimatePresence>\n        {windowStack.map((window, index) => (\n          <Window\n            key={`window-${window.id}`}\n            windowStack={windowStack}\n            index={index}\n            isHidden={index < windowStack.length - 1}\n          />\n        ))}\n      </AnimatePresence>\n    </Container>\n  );\n};\n\nexport default FullScreenWindowManager;\n","import { AnimatePresence } from 'framer-motion';\nimport { WindowOptions } from 'providers/WindowProvider';\nimport styled from 'styled-components';\n\nimport Popup from '../components/Popup';\n\ninterface ContainerProps {\n  isHidden: boolean;\n}\n\nconst RootContainer = styled.div<ContainerProps>`\n  z-index: 4;\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  background: ${({ isHidden }) =>\n    isHidden ? 'transparent' : 'rgba(0, 0, 0, 0.3)'};\n  transition: all 0.25s ease;\n`;\n\ninterface Props {\n  windowStack: WindowOptions[];\n}\n\nconst PopupWindowManager = ({ windowStack }: Props) => {\n  const isHidden = windowStack.length === 0;\n\n  return (\n    <RootContainer data-stack-type=\"popup\" isHidden={isHidden}>\n      <AnimatePresence>\n        {windowStack.map((window, index) => (\n          <Popup\n            key={`window-${window.id}`}\n            windowStack={windowStack}\n            index={index}\n            isHidden={index < windowStack.length - 1}\n          />\n        ))}\n      </AnimatePresence>\n    </RootContainer>\n  );\n};\n\nexport default PopupWindowManager;\n","import { PREVIEW, Previews } from 'components/previews';\nimport { AnimatePresence } from 'framer-motion';\nimport { useWindowContext } from 'hooks';\nimport styled, { css } from 'styled-components';\n\ninterface ContainerProps {\n  isHidden: boolean;\n}\n\nconst Container = styled.div<ContainerProps>`\n  z-index: 0;\n  position: relative;\n  flex: 0 0 50%;\n  background: white;\n  transition: all 0.35s;\n\n  ${(props) =>\n    props.isHidden &&\n    css`\n      transform: translateX(100%);\n      opacity: 0;\n      overflow: hidden;\n    `};\n`;\n\ninterface Props {\n  isHidden: boolean;\n}\n\nconst PreviewPanel = ({ isHidden }: Props) => {\n  const { preview } = useWindowContext();\n  const PreviewComponent = Previews[preview];\n\n  return (\n    <Container isHidden={isHidden}>\n      <AnimatePresence>\n        {/* Music preview slides in, whereas the other previews simply appear. */}\n        {preview === PREVIEW.MUSIC && <PreviewComponent />}\n      </AnimatePresence>\n      {preview !== PREVIEW.MUSIC && <PreviewComponent />}\n    </Container>\n  );\n};\n\nexport default PreviewPanel;\n","import { Header } from 'components';\nimport { AnimatePresence } from 'framer-motion';\nimport { WindowOptions } from 'providers/WindowProvider';\nimport styled, { css } from 'styled-components';\n\nimport { Window } from '../components';\nimport PreviewPanel from './PreviewPanel';\n\nconst Container = styled.div`\n  z-index: 2;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  display: flex;\n`;\n\ninterface PanelProps {\n  isHidden: boolean;\n}\n\nconst LeftPanel = styled.div<PanelProps>`\n  z-index: 1;\n  position: relative;\n  flex: 0 0 50%;\n  box-shadow: 0 0 24px black;\n  transition: all 0.35s;\n  overflow: hidden;\n\n  ${(props) =>\n    props.isHidden &&\n    css`\n      transition-delay: 0.05s;\n      transform: translateX(-100%);\n      box-shadow: none;\n    `};\n`;\n\ninterface Props {\n  windowStack: WindowOptions[];\n  menuHidden: boolean;\n  allHidden: boolean;\n}\n\nconst SplitScreenWindowManager = ({\n  windowStack,\n  menuHidden,\n  allHidden,\n}: Props) => {\n  return (\n    <Container data-stack-type=\"splitscreen\">\n      <LeftPanel isHidden={menuHidden || allHidden}>\n        <Header />\n        <AnimatePresence>\n          {windowStack.map((window, index) => (\n            <Window\n              key={`window-${window.id}`}\n              windowStack={windowStack}\n              index={index}\n              isHidden={index < windowStack.length - 1}\n            />\n          ))}\n        </AnimatePresence>\n      </LeftPanel>\n      <PreviewPanel isHidden={allHidden} />\n    </Container>\n  );\n};\n\nexport default SplitScreenWindowManager;\n","import { ErrorScreen } from 'components';\nimport { WINDOW_TYPE } from 'components/views';\nimport { useEventListener, useMusicKit, useWindowContext } from 'hooks';\nimport styled from 'styled-components';\nimport { IpodEvent } from 'utils/events';\n\nimport ActionSheetWindowManager from './ActionSheetWindowManager';\nimport CoverFlowWindowManager from './CoverFlowWindowManager';\nimport FullScreenWindowManager from './FullScreenWindowManager';\nimport PopupWindowManager from './PopupWindowManager';\nimport SplitScreenWindowManager from './SplitScreenWindowManager';\n\n/** Prevents the user from scrolling the display with a mouse. */\nconst Mask = styled.div`\n  z-index: 100;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n`;\n\nconst WindowManager = () => {\n  const { isConfigured, hasDevToken: hasAppleDevToken } = useMusicKit();\n  const { windowStack, resetWindows } = useWindowContext();\n  const splitViewWindows = windowStack.filter(\n    (window) => window.type === WINDOW_TYPE.SPLIT\n  );\n  const fullViewWindows = windowStack.filter(\n    (window) => window.type === WINDOW_TYPE.FULL\n  );\n  const coverFlowWindow = windowStack.find(\n    (window) => window.type === WINDOW_TYPE.COVER_FLOW\n  );\n  const actionSheetWindows = windowStack.filter(\n    (window) => window.type === WINDOW_TYPE.ACTION_SHEET\n  );\n  const popupWindows = windowStack.filter(\n    (window) => window.type === WINDOW_TYPE.POPUP\n  );\n\n  const isReady = isConfigured && hasAppleDevToken;\n\n  useEventListener<IpodEvent>('menulongpress', resetWindows);\n\n  return (\n    <div>\n      {isReady ? (\n        <>\n          <CoverFlowWindowManager window={coverFlowWindow} />\n          <SplitScreenWindowManager\n            windowStack={splitViewWindows}\n            menuHidden={fullViewWindows.length > 0}\n            allHidden={!!coverFlowWindow}\n          />\n          <FullScreenWindowManager windowStack={fullViewWindows} />\n          <ActionSheetWindowManager windowStack={actionSheetWindows} />\n          <PopupWindowManager windowStack={popupWindows} />\n        </>\n      ) : (\n        <ErrorScreen message={'Missing developer token'} />\n      )}\n      <Mask />\n    </div>\n  );\n};\n\nexport default WindowManager;\n","import * as React from 'react';\n\nimport { ScrollWheel } from 'components';\nimport {\n  useSettings,\n  AudioPlayerProvider,\n  MusicKitProvider,\n  SettingsProvider,\n  SpotifySDKProvider,\n} from 'hooks';\nimport WindowProvider from 'providers/WindowProvider';\nimport styled, { createGlobalStyle } from 'styled-components';\nimport { Screen, Unit } from 'utils/constants';\n\nimport { WindowManager } from './components';\nimport { DeviceTheme, getTheme } from './utils/themes';\n\nconst GlobalStyles = createGlobalStyle`\n  * {\n    box-sizing: border-box;\n  }\n\n   body {\n      font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\";\n      font-size: 16px;\n      user-select: none;\n      -webkit-touch-callout: none;\n\n      @media (prefers-color-scheme: dark) {\n        background: black;\n      }\n   }\n`;\n\nconst Container = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  @media screen and (min-width: 750px) {\n    height: 100vh;\n    display: flex;\n  }\n`;\n\nconst Shell = styled.div<{ deviceTheme: DeviceTheme }>`\n  position: relative;\n  height: 100vh;\n  margin: auto;\n  max-height: 36.5em;\n  width: 370px;\n  border-radius: 30px;\n  box-shadow: inset 0 0 2.4em #555;\n  background: ${({ deviceTheme }) => getTheme(deviceTheme).body.background};\n  -webkit-box-reflect: below 0px -webkit-gradient(linear, left top, left bottom, from(transparent), color-stop(50%, transparent), to(rgba(250, 250, 250, 0.3)));\n  animation: descend 1.5s ease;\n\n  @media (prefers-color-scheme: dark) {\n    box-shadow: inset 0 0 2.4em black;\n  }\n\n  @media screen and (max-width: 400px) {\n    animation: none;\n    border-radius: 0;\n    -webkit-box-reflect: unset;\n  }\n\n  @keyframes descend {\n    0% {\n      transform: scale(0.3);\n      opacity: 0;\n    }\n\n    100% {\n      transform: scale(1);\n      opacity: 1;\n    }\n  }\n`;\n\nconst ScreenContainer = styled.div`\n  position: relative;\n  height: 260px;\n  margin: ${Unit.LG} ${Unit.LG} ${Unit.XL};\n  border: 4px solid black;\n  border-radius: ${Unit.XS};\n  overflow: hidden;\n  background: white;\n  animation: fadeFromBlack 0.5s;\n\n  @keyframes fadeFromBlack {\n    0% {\n      filter: brightness(0);\n    }\n  }\n\n  ${Screen.SM} {\n    @media screen and (max-height: 750px) {\n      margin: ${Unit.SM} ${Unit.SM} ${Unit.XL};\n    }\n  }\n`;\n\nconst App: React.FC = () => {\n  return (\n    <Container>\n      <GlobalStyles />\n      <SettingsProvider>\n        <Ipod />\n      </SettingsProvider>\n    </Container>\n  );\n};\n\nconst Ipod = () => {\n  const { deviceTheme } = useSettings();\n  return (\n    <Shell deviceTheme={deviceTheme}>\n      <ScreenContainer>\n        <SpotifySDKProvider>\n          <MusicKitProvider>\n            <AudioPlayerProvider>\n              <WindowProvider>\n                <WindowManager />\n              </WindowProvider>\n            </AudioPlayerProvider>\n          </MusicKitProvider>\n        </SpotifySDKProvider>\n      </ScreenContainer>\n      <ScrollWheel />\n    </Shell>\n  );\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then((registration) => {\n      registration.unregister();\n    });\n  }\n}\n","import ReactDOM from 'react-dom';\n\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}